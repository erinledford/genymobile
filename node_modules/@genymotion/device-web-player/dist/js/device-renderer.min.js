"use strict";!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).genyDeviceWebPlayer=e()}}((function(){return function r(e,t,n){function o(s,a){if(!t[s]){if(!e[s]){var c="function"==typeof require&&require;if(!a&&c)return c(s,!0);if(i)return i(s,!0);var d=new Error("Cannot find module '"+s+"'");throw d.code="MODULE_NOT_FOUND",d}var l=t[s]={exports:{}};e[s][0].call(l.exports,(function(t){return o(e[s][1][t]||t)}),l,l.exports,r,e,t,n)}return t[s].exports}for(var i="function"==typeof require&&require,s=0;s<n.length;s++)o(n[s]);return o}({1:[function(e,t,n){var i=e("./_hashClear"),s=e("./_hashDelete"),a=e("./_hashGet"),c=e("./_hashHas"),d=e("./_hashSet");function Hash(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}Hash.prototype.clear=i,Hash.prototype.delete=s,Hash.prototype.get=a,Hash.prototype.has=c,Hash.prototype.set=d,t.exports=Hash},{"./_hashClear":43,"./_hashDelete":44,"./_hashGet":45,"./_hashHas":46,"./_hashSet":47}],2:[function(e,t,n){var i=e("./_listCacheClear"),s=e("./_listCacheDelete"),a=e("./_listCacheGet"),c=e("./_listCacheHas"),d=e("./_listCacheSet");function ListCache(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}ListCache.prototype.clear=i,ListCache.prototype.delete=s,ListCache.prototype.get=a,ListCache.prototype.has=c,ListCache.prototype.set=d,t.exports=ListCache},{"./_listCacheClear":54,"./_listCacheDelete":55,"./_listCacheGet":56,"./_listCacheHas":57,"./_listCacheSet":58}],3:[function(e,t,n){var i=e("./_getNative")(e("./_root"),"Map");t.exports=i},{"./_getNative":39,"./_root":70}],4:[function(e,t,n){var i=e("./_mapCacheClear"),s=e("./_mapCacheDelete"),a=e("./_mapCacheGet"),c=e("./_mapCacheHas"),d=e("./_mapCacheSet");function MapCache(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}MapCache.prototype.clear=i,MapCache.prototype.delete=s,MapCache.prototype.get=a,MapCache.prototype.has=c,MapCache.prototype.set=d,t.exports=MapCache},{"./_mapCacheClear":59,"./_mapCacheDelete":60,"./_mapCacheGet":61,"./_mapCacheHas":62,"./_mapCacheSet":63}],5:[function(e,t,n){var i=e("./_ListCache"),s=e("./_stackClear"),a=e("./_stackDelete"),c=e("./_stackGet"),d=e("./_stackHas"),l=e("./_stackSet");function Stack(e){var t=this.__data__=new i(e);this.size=t.size}Stack.prototype.clear=s,Stack.prototype.delete=a,Stack.prototype.get=c,Stack.prototype.has=d,Stack.prototype.set=l,t.exports=Stack},{"./_ListCache":2,"./_stackClear":74,"./_stackDelete":75,"./_stackGet":76,"./_stackHas":77,"./_stackSet":78}],6:[function(e,t,n){var i=e("./_root").Symbol;t.exports=i},{"./_root":70}],7:[function(e,t,n){var i=e("./_root").Uint8Array;t.exports=i},{"./_root":70}],8:[function(e,t,n){t.exports=function apply(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}},{}],9:[function(e,t,n){var i=e("./_baseTimes"),s=e("./isArguments"),a=e("./isArray"),c=e("./isBuffer"),d=e("./_isIndex"),l=e("./isTypedArray"),h=Object.prototype.hasOwnProperty;t.exports=function arrayLikeKeys(e,t){var n=a(e),p=!n&&s(e),u=!n&&!p&&c(e),m=!n&&!p&&!u&&l(e),g=n||p||u||m,v=g?i(e.length,String):[],f=v.length;for(var b in e)!t&&!h.call(e,b)||g&&("length"==b||u&&("offset"==b||"parent"==b)||m&&("buffer"==b||"byteLength"==b||"byteOffset"==b)||d(b,f))||v.push(b);return v}},{"./_baseTimes":25,"./_isIndex":49,"./isArguments":84,"./isArray":85,"./isBuffer":88,"./isTypedArray":94}],10:[function(e,t,n){var i=e("./_baseAssignValue"),s=e("./eq");t.exports=function assignMergeValue(e,t,n){(void 0!==n&&!s(e[t],n)||void 0===n&&!(t in e))&&i(e,t,n)}},{"./_baseAssignValue":13,"./eq":82}],11:[function(e,t,n){var i=e("./_baseAssignValue"),s=e("./eq"),a=Object.prototype.hasOwnProperty;t.exports=function assignValue(e,t,n){var c=e[t];a.call(e,t)&&s(c,n)&&(void 0!==n||t in e)||i(e,t,n)}},{"./_baseAssignValue":13,"./eq":82}],12:[function(e,t,n){var i=e("./eq");t.exports=function assocIndexOf(e,t){for(var n=e.length;n--;)if(i(e[n][0],t))return n;return-1}},{"./eq":82}],13:[function(e,t,n){var i=e("./_defineProperty");t.exports=function baseAssignValue(e,t,n){"__proto__"==t&&i?i(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}},{"./_defineProperty":36}],14:[function(e,t,n){var i=e("./isObject"),s=Object.create,a=function(){function object(){}return function(e){if(!i(e))return{};if(s)return s(e);object.prototype=e;var t=new object;return object.prototype=void 0,t}}();t.exports=a},{"./isObject":91}],15:[function(e,t,n){var i=e("./_createBaseFor")();t.exports=i},{"./_createBaseFor":34}],16:[function(e,t,n){var i=e("./_Symbol"),s=e("./_getRawTag"),a=e("./_objectToString"),c=i?i.toStringTag:void 0;t.exports=function baseGetTag(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":c&&c in Object(e)?s(e):a(e)}},{"./_Symbol":6,"./_getRawTag":41,"./_objectToString":67}],17:[function(e,t,n){var i=e("./_baseGetTag"),s=e("./isObjectLike");t.exports=function baseIsArguments(e){return s(e)&&"[object Arguments]"==i(e)}},{"./_baseGetTag":16,"./isObjectLike":92}],18:[function(e,t,n){var i=e("./isFunction"),s=e("./_isMasked"),a=e("./isObject"),c=e("./_toSource"),d=/^\[object .+?Constructor\]$/,l=Function.prototype,h=Object.prototype,p=l.toString,u=h.hasOwnProperty,m=RegExp("^"+p.call(u).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function baseIsNative(e){return!(!a(e)||s(e))&&(i(e)?m:d).test(c(e))}},{"./_isMasked":52,"./_toSource":79,"./isFunction":89,"./isObject":91}],19:[function(e,t,n){var i=e("./_baseGetTag"),s=e("./isLength"),a=e("./isObjectLike"),c={};c["[object Float32Array]"]=c["[object Float64Array]"]=c["[object Int8Array]"]=c["[object Int16Array]"]=c["[object Int32Array]"]=c["[object Uint8Array]"]=c["[object Uint8ClampedArray]"]=c["[object Uint16Array]"]=c["[object Uint32Array]"]=!0,c["[object Arguments]"]=c["[object Array]"]=c["[object ArrayBuffer]"]=c["[object Boolean]"]=c["[object DataView]"]=c["[object Date]"]=c["[object Error]"]=c["[object Function]"]=c["[object Map]"]=c["[object Number]"]=c["[object Object]"]=c["[object RegExp]"]=c["[object Set]"]=c["[object String]"]=c["[object WeakMap]"]=!1,t.exports=function baseIsTypedArray(e){return a(e)&&s(e.length)&&!!c[i(e)]}},{"./_baseGetTag":16,"./isLength":90,"./isObjectLike":92}],20:[function(e,t,n){var i=e("./isObject"),s=e("./_isPrototype"),a=e("./_nativeKeysIn"),c=Object.prototype.hasOwnProperty;t.exports=function baseKeysIn(e){if(!i(e))return a(e);var t=s(e),n=[];for(var d in e)("constructor"!=d||!t&&c.call(e,d))&&n.push(d);return n}},{"./_isPrototype":53,"./_nativeKeysIn":65,"./isObject":91}],21:[function(e,t,n){var i=e("./_Stack"),s=e("./_assignMergeValue"),a=e("./_baseFor"),c=e("./_baseMergeDeep"),d=e("./isObject"),l=e("./keysIn"),h=e("./_safeGet");t.exports=function baseMerge(e,t,n,p,u){e!==t&&a(t,(function(a,l){if(u||(u=new i),d(a))c(e,t,l,n,baseMerge,p,u);else{var m=p?p(h(e,l),a,l+"",e,t,u):void 0;void 0===m&&(m=a),s(e,l,m)}}),l)}},{"./_Stack":5,"./_assignMergeValue":10,"./_baseFor":15,"./_baseMergeDeep":22,"./_safeGet":71,"./isObject":91,"./keysIn":95}],22:[function(e,t,n){var i=e("./_assignMergeValue"),s=e("./_cloneBuffer"),a=e("./_cloneTypedArray"),c=e("./_copyArray"),d=e("./_initCloneObject"),l=e("./isArguments"),h=e("./isArray"),p=e("./isArrayLikeObject"),u=e("./isBuffer"),m=e("./isFunction"),g=e("./isObject"),v=e("./isPlainObject"),f=e("./isTypedArray"),b=e("./_safeGet"),y=e("./toPlainObject");t.exports=function baseMergeDeep(e,t,n,C,S,E,T){var I=b(e,n),k=b(t,n),w=T.get(k);if(w)i(e,n,w);else{var R=E?E(I,k,n+"",e,t,T):void 0,P=void 0===R;if(P){var _=h(k),x=!_&&u(k),M=!_&&!x&&f(k);R=k,_||x||M?h(I)?R=I:p(I)?R=c(I):x?(P=!1,R=s(k,!0)):M?(P=!1,R=a(k,!0)):R=[]:v(k)||l(k)?(R=I,l(I)?R=y(I):g(I)&&!m(I)||(R=d(k))):P=!1}P&&(T.set(k,R),S(R,k,C,E,T),T.delete(k)),i(e,n,R)}}},{"./_assignMergeValue":10,"./_cloneBuffer":28,"./_cloneTypedArray":29,"./_copyArray":30,"./_initCloneObject":48,"./_safeGet":71,"./isArguments":84,"./isArray":85,"./isArrayLikeObject":87,"./isBuffer":88,"./isFunction":89,"./isObject":91,"./isPlainObject":93,"./isTypedArray":94,"./toPlainObject":98}],23:[function(e,t,n){var i=e("./identity"),s=e("./_overRest"),a=e("./_setToString");t.exports=function baseRest(e,t){return a(s(e,t,i),e+"")}},{"./_overRest":69,"./_setToString":72,"./identity":83}],24:[function(e,t,n){var i=e("./constant"),s=e("./_defineProperty"),a=e("./identity"),c=s?function(e,t){return s(e,"toString",{configurable:!0,enumerable:!1,value:i(t),writable:!0})}:a;t.exports=c},{"./_defineProperty":36,"./constant":80,"./identity":83}],25:[function(e,t,n){t.exports=function baseTimes(e,t){for(var n=-1,i=Array(e);++n<e;)i[n]=t(n);return i}},{}],26:[function(e,t,n){t.exports=function baseUnary(e){return function(t){return e(t)}}},{}],27:[function(e,t,n){var i=e("./_Uint8Array");t.exports=function cloneArrayBuffer(e){var t=new e.constructor(e.byteLength);return new i(t).set(new i(e)),t}},{"./_Uint8Array":7}],28:[function(e,t,n){var i=e("./_root"),s="object"==typeof n&&n&&!n.nodeType&&n,a=s&&"object"==typeof t&&t&&!t.nodeType&&t,c=a&&a.exports===s?i.Buffer:void 0,d=c?c.allocUnsafe:void 0;t.exports=function cloneBuffer(e,t){if(t)return e.slice();var n=e.length,i=d?d(n):new e.constructor(n);return e.copy(i),i}},{"./_root":70}],29:[function(e,t,n){var i=e("./_cloneArrayBuffer");t.exports=function cloneTypedArray(e,t){var n=t?i(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}},{"./_cloneArrayBuffer":27}],30:[function(e,t,n){t.exports=function copyArray(e,t){var n=-1,i=e.length;for(t||(t=Array(i));++n<i;)t[n]=e[n];return t}},{}],31:[function(e,t,n){var i=e("./_assignValue"),s=e("./_baseAssignValue");t.exports=function copyObject(e,t,n,a){var c=!n;n||(n={});for(var d=-1,l=t.length;++d<l;){var h=t[d],p=a?a(n[h],e[h],h,n,e):void 0;void 0===p&&(p=e[h]),c?s(n,h,p):i(n,h,p)}return n}},{"./_assignValue":11,"./_baseAssignValue":13}],32:[function(e,t,n){var i=e("./_root")["__core-js_shared__"];t.exports=i},{"./_root":70}],33:[function(e,t,n){var i=e("./_baseRest"),s=e("./_isIterateeCall");t.exports=function createAssigner(e){return i((function(t,n){var i=-1,a=n.length,c=a>1?n[a-1]:void 0,d=a>2?n[2]:void 0;for(c=e.length>3&&"function"==typeof c?(a--,c):void 0,d&&s(n[0],n[1],d)&&(c=a<3?void 0:c,a=1),t=Object(t);++i<a;){var l=n[i];l&&e(t,l,i,c)}return t}))}},{"./_baseRest":23,"./_isIterateeCall":50}],34:[function(e,t,n){t.exports=function createBaseFor(e){return function(t,n,i){for(var s=-1,a=Object(t),c=i(t),d=c.length;d--;){var l=c[e?d:++s];if(!1===n(a[l],l,a))break}return t}}},{}],35:[function(e,t,n){var i=e("./_baseMerge"),s=e("./isObject");t.exports=function customDefaultsMerge(e,t,n,a,c,d){return s(e)&&s(t)&&(d.set(t,e),i(e,t,void 0,customDefaultsMerge,d),d.delete(t)),e}},{"./_baseMerge":21,"./isObject":91}],36:[function(e,t,n){var i=e("./_getNative"),s=function(){try{var e=i(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();t.exports=s},{"./_getNative":39}],37:[function(e,t,n){(function(e){(function(){var n="object"==typeof e&&e&&e.Object===Object&&e;t.exports=n}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],38:[function(e,t,n){var i=e("./_isKeyable");t.exports=function getMapData(e,t){var n=e.__data__;return i(t)?n["string"==typeof t?"string":"hash"]:n.map}},{"./_isKeyable":51}],39:[function(e,t,n){var i=e("./_baseIsNative"),s=e("./_getValue");t.exports=function getNative(e,t){var n=s(e,t);return i(n)?n:void 0}},{"./_baseIsNative":18,"./_getValue":42}],40:[function(e,t,n){var i=e("./_overArg")(Object.getPrototypeOf,Object);t.exports=i},{"./_overArg":68}],41:[function(e,t,n){var i=e("./_Symbol"),s=Object.prototype,a=s.hasOwnProperty,c=s.toString,d=i?i.toStringTag:void 0;t.exports=function getRawTag(e){var t=a.call(e,d),n=e[d];try{e[d]=void 0;var i=!0}catch(e){}var s=c.call(e);return i&&(t?e[d]=n:delete e[d]),s}},{"./_Symbol":6}],42:[function(e,t,n){t.exports=function getValue(e,t){return null==e?void 0:e[t]}},{}],43:[function(e,t,n){var i=e("./_nativeCreate");t.exports=function hashClear(){this.__data__=i?i(null):{},this.size=0}},{"./_nativeCreate":64}],44:[function(e,t,n){t.exports=function hashDelete(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},{}],45:[function(e,t,n){var i=e("./_nativeCreate"),s=Object.prototype.hasOwnProperty;t.exports=function hashGet(e){var t=this.__data__;if(i){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return s.call(t,e)?t[e]:void 0}},{"./_nativeCreate":64}],46:[function(e,t,n){var i=e("./_nativeCreate"),s=Object.prototype.hasOwnProperty;t.exports=function hashHas(e){var t=this.__data__;return i?void 0!==t[e]:s.call(t,e)}},{"./_nativeCreate":64}],47:[function(e,t,n){var i=e("./_nativeCreate");t.exports=function hashSet(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=i&&void 0===t?"__lodash_hash_undefined__":t,this}},{"./_nativeCreate":64}],48:[function(e,t,n){var i=e("./_baseCreate"),s=e("./_getPrototype"),a=e("./_isPrototype");t.exports=function initCloneObject(e){return"function"!=typeof e.constructor||a(e)?{}:i(s(e))}},{"./_baseCreate":14,"./_getPrototype":40,"./_isPrototype":53}],49:[function(e,t,n){var i=/^(?:0|[1-9]\d*)$/;t.exports=function isIndex(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&i.test(e))&&e>-1&&e%1==0&&e<t}},{}],50:[function(e,t,n){var i=e("./eq"),s=e("./isArrayLike"),a=e("./_isIndex"),c=e("./isObject");t.exports=function isIterateeCall(e,t,n){if(!c(n))return!1;var d=typeof t;return!!("number"==d?s(n)&&a(t,n.length):"string"==d&&t in n)&&i(n[t],e)}},{"./_isIndex":49,"./eq":82,"./isArrayLike":86,"./isObject":91}],51:[function(e,t,n){t.exports=function isKeyable(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},{}],52:[function(e,t,n){var i,s=e("./_coreJsData"),a=(i=/[^.]+$/.exec(s&&s.keys&&s.keys.IE_PROTO||""))?"Symbol(src)_1."+i:"";t.exports=function isMasked(e){return!!a&&a in e}},{"./_coreJsData":32}],53:[function(e,t,n){var i=Object.prototype;t.exports=function isPrototype(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||i)}},{}],54:[function(e,t,n){t.exports=function listCacheClear(){this.__data__=[],this.size=0}},{}],55:[function(e,t,n){var i=e("./_assocIndexOf"),s=Array.prototype.splice;t.exports=function listCacheDelete(e){var t=this.__data__,n=i(t,e);return!(n<0)&&(n==t.length-1?t.pop():s.call(t,n,1),--this.size,!0)}},{"./_assocIndexOf":12}],56:[function(e,t,n){var i=e("./_assocIndexOf");t.exports=function listCacheGet(e){var t=this.__data__,n=i(t,e);return n<0?void 0:t[n][1]}},{"./_assocIndexOf":12}],57:[function(e,t,n){var i=e("./_assocIndexOf");t.exports=function listCacheHas(e){return i(this.__data__,e)>-1}},{"./_assocIndexOf":12}],58:[function(e,t,n){var i=e("./_assocIndexOf");t.exports=function listCacheSet(e,t){var n=this.__data__,s=i(n,e);return s<0?(++this.size,n.push([e,t])):n[s][1]=t,this}},{"./_assocIndexOf":12}],59:[function(e,t,n){var i=e("./_Hash"),s=e("./_ListCache"),a=e("./_Map");t.exports=function mapCacheClear(){this.size=0,this.__data__={hash:new i,map:new(a||s),string:new i}}},{"./_Hash":1,"./_ListCache":2,"./_Map":3}],60:[function(e,t,n){var i=e("./_getMapData");t.exports=function mapCacheDelete(e){var t=i(this,e).delete(e);return this.size-=t?1:0,t}},{"./_getMapData":38}],61:[function(e,t,n){var i=e("./_getMapData");t.exports=function mapCacheGet(e){return i(this,e).get(e)}},{"./_getMapData":38}],62:[function(e,t,n){var i=e("./_getMapData");t.exports=function mapCacheHas(e){return i(this,e).has(e)}},{"./_getMapData":38}],63:[function(e,t,n){var i=e("./_getMapData");t.exports=function mapCacheSet(e,t){var n=i(this,e),s=n.size;return n.set(e,t),this.size+=n.size==s?0:1,this}},{"./_getMapData":38}],64:[function(e,t,n){var i=e("./_getNative")(Object,"create");t.exports=i},{"./_getNative":39}],65:[function(e,t,n){t.exports=function nativeKeysIn(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}},{}],66:[function(e,t,n){var i=e("./_freeGlobal"),s="object"==typeof n&&n&&!n.nodeType&&n,a=s&&"object"==typeof t&&t&&!t.nodeType&&t,c=a&&a.exports===s&&i.process,d=function(){try{var e=a&&a.require&&a.require("util").types;return e||c&&c.binding&&c.binding("util")}catch(e){}}();t.exports=d},{"./_freeGlobal":37}],67:[function(e,t,n){var i=Object.prototype.toString;t.exports=function objectToString(e){return i.call(e)}},{}],68:[function(e,t,n){t.exports=function overArg(e,t){return function(n){return e(t(n))}}},{}],69:[function(e,t,n){var i=e("./_apply"),s=Math.max;t.exports=function overRest(e,t,n){return t=s(void 0===t?e.length-1:t,0),function(){for(var a=arguments,c=-1,d=s(a.length-t,0),l=Array(d);++c<d;)l[c]=a[t+c];c=-1;for(var h=Array(t+1);++c<t;)h[c]=a[c];return h[t]=n(l),i(e,this,h)}}},{"./_apply":8}],70:[function(e,t,n){var i=e("./_freeGlobal"),s="object"==typeof self&&self&&self.Object===Object&&self,a=i||s||Function("return this")();t.exports=a},{"./_freeGlobal":37}],71:[function(e,t,n){t.exports=function safeGet(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}},{}],72:[function(e,t,n){var i=e("./_baseSetToString"),s=e("./_shortOut")(i);t.exports=s},{"./_baseSetToString":24,"./_shortOut":73}],73:[function(e,t,n){var i=Date.now;t.exports=function shortOut(e){var t=0,n=0;return function(){var s=i(),a=16-(s-n);if(n=s,a>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}},{}],74:[function(e,t,n){var i=e("./_ListCache");t.exports=function stackClear(){this.__data__=new i,this.size=0}},{"./_ListCache":2}],75:[function(e,t,n){t.exports=function stackDelete(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}},{}],76:[function(e,t,n){t.exports=function stackGet(e){return this.__data__.get(e)}},{}],77:[function(e,t,n){t.exports=function stackHas(e){return this.__data__.has(e)}},{}],78:[function(e,t,n){var i=e("./_ListCache"),s=e("./_Map"),a=e("./_MapCache");t.exports=function stackSet(e,t){var n=this.__data__;if(n instanceof i){var c=n.__data__;if(!s||c.length<199)return c.push([e,t]),this.size=++n.size,this;n=this.__data__=new a(c)}return n.set(e,t),this.size=n.size,this}},{"./_ListCache":2,"./_Map":3,"./_MapCache":4}],79:[function(e,t,n){var i=Function.prototype.toString;t.exports=function toSource(e){if(null!=e){try{return i.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},{}],80:[function(e,t,n){t.exports=function constant(e){return function(){return e}}},{}],81:[function(e,t,n){var i=e("./_apply"),s=e("./_baseRest"),a=e("./_customDefaultsMerge"),c=e("./mergeWith"),d=s((function(e){return e.push(void 0,a),i(c,void 0,e)}));t.exports=d},{"./_apply":8,"./_baseRest":23,"./_customDefaultsMerge":35,"./mergeWith":96}],82:[function(e,t,n){t.exports=function eq(e,t){return e===t||e!=e&&t!=t}},{}],83:[function(e,t,n){t.exports=function identity(e){return e}},{}],84:[function(e,t,n){var i=e("./_baseIsArguments"),s=e("./isObjectLike"),a=Object.prototype,c=a.hasOwnProperty,d=a.propertyIsEnumerable,l=i(function(){return arguments}())?i:function(e){return s(e)&&c.call(e,"callee")&&!d.call(e,"callee")};t.exports=l},{"./_baseIsArguments":17,"./isObjectLike":92}],85:[function(e,t,n){var i=Array.isArray;t.exports=i},{}],86:[function(e,t,n){var i=e("./isFunction"),s=e("./isLength");t.exports=function isArrayLike(e){return null!=e&&s(e.length)&&!i(e)}},{"./isFunction":89,"./isLength":90}],87:[function(e,t,n){var i=e("./isArrayLike"),s=e("./isObjectLike");t.exports=function isArrayLikeObject(e){return s(e)&&i(e)}},{"./isArrayLike":86,"./isObjectLike":92}],88:[function(e,t,n){var i=e("./_root"),s=e("./stubFalse"),a="object"==typeof n&&n&&!n.nodeType&&n,c=a&&"object"==typeof t&&t&&!t.nodeType&&t,d=c&&c.exports===a?i.Buffer:void 0,l=(d?d.isBuffer:void 0)||s;t.exports=l},{"./_root":70,"./stubFalse":97}],89:[function(e,t,n){var i=e("./_baseGetTag"),s=e("./isObject");t.exports=function isFunction(e){if(!s(e))return!1;var t=i(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},{"./_baseGetTag":16,"./isObject":91}],90:[function(e,t,n){t.exports=function isLength(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},{}],91:[function(e,t,n){t.exports=function isObject(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},{}],92:[function(e,t,n){t.exports=function isObjectLike(e){return null!=e&&"object"==typeof e}},{}],93:[function(e,t,n){var i=e("./_baseGetTag"),s=e("./_getPrototype"),a=e("./isObjectLike"),c=Function.prototype,d=Object.prototype,l=c.toString,h=d.hasOwnProperty,p=l.call(Object);t.exports=function isPlainObject(e){if(!a(e)||"[object Object]"!=i(e))return!1;var t=s(e);if(null===t)return!0;var n=h.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&l.call(n)==p}},{"./_baseGetTag":16,"./_getPrototype":40,"./isObjectLike":92}],94:[function(e,t,n){var i=e("./_baseIsTypedArray"),s=e("./_baseUnary"),a=e("./_nodeUtil"),c=a&&a.isTypedArray,d=c?s(c):i;t.exports=d},{"./_baseIsTypedArray":19,"./_baseUnary":26,"./_nodeUtil":66}],95:[function(e,t,n){var i=e("./_arrayLikeKeys"),s=e("./_baseKeysIn"),a=e("./isArrayLike");t.exports=function keysIn(e){return a(e)?i(e,!0):s(e)}},{"./_arrayLikeKeys":9,"./_baseKeysIn":20,"./isArrayLike":86}],96:[function(e,t,n){var i=e("./_baseMerge"),s=e("./_createAssigner")((function(e,t,n,s){i(e,t,n,s)}));t.exports=s},{"./_baseMerge":21,"./_createAssigner":33}],97:[function(e,t,n){t.exports=function stubFalse(){return!1}},{}],98:[function(e,t,n){var i=e("./_copyObject"),s=e("./keysIn");t.exports=function toPlainObject(e){return i(e,s(e))}},{"./_copyObject":31,"./keysIn":95}],99:[function(e,t,n){var i,s;i=this,s=function(){var noop=function(){},e="undefined"!=typeof window&&void 0!==window.navigator&&/Trident\/|MSIE /.test(window.navigator.userAgent),t=["trace","debug","info","warn","error"];function bindMethod(e,t){var n=e[t];if("function"==typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(t){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function traceForIE(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function realMethod(t){return"debug"===t&&(t="log"),"undefined"!=typeof console&&("trace"===t&&e?traceForIE:void 0!==console[t]?bindMethod(console,t):void 0!==console.log?bindMethod(console,"log"):noop)}function replaceLoggingMethods(e,n){for(var i=0;i<t.length;i++){var s=t[i];this[s]=i<e?noop:this.methodFactory(s,e,n)}this.log=this.debug}function enableLoggingWhenConsoleArrives(e,t,n){return function(){"undefined"!=typeof console&&(replaceLoggingMethods.call(this,t,n),this[e].apply(this,arguments))}}function defaultMethodFactory(e,t,n){return realMethod(e)||enableLoggingWhenConsoleArrives.apply(this,arguments)}function Logger(e,n,i){var s,a=this;n=null==n?"WARN":n;var c="loglevel";function getPersistedLevel(){var e;if("undefined"!=typeof window&&c){try{e=window.localStorage[c]}catch(e){}if(void 0===e)try{var t=window.document.cookie,n=t.indexOf(encodeURIComponent(c)+"=");-1!==n&&(e=/^([^;]+)/.exec(t.slice(n))[1])}catch(e){}return void 0===a.levels[e]&&(e=void 0),e}}"string"==typeof e?c+=":"+e:"symbol"==typeof e&&(c=void 0),a.name=e,a.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},a.methodFactory=i||defaultMethodFactory,a.getLevel=function(){return s},a.setLevel=function(n,i){if("string"==typeof n&&void 0!==a.levels[n.toUpperCase()]&&(n=a.levels[n.toUpperCase()]),!("number"==typeof n&&n>=0&&n<=a.levels.SILENT))throw"log.setLevel() called with invalid level: "+n;if(s=n,!1!==i&&function persistLevelIfPossible(e){var n=(t[e]||"silent").toUpperCase();if("undefined"!=typeof window&&c){try{return void(window.localStorage[c]=n)}catch(e){}try{window.document.cookie=encodeURIComponent(c)+"="+n+";"}catch(e){}}}(n),replaceLoggingMethods.call(a,n,e),"undefined"==typeof console&&n<a.levels.SILENT)return"No console available for logging"},a.setDefaultLevel=function(e){n=e,getPersistedLevel()||a.setLevel(e,!1)},a.resetLevel=function(){a.setLevel(n,!1),function clearPersistedLevel(){if("undefined"!=typeof window&&c){try{return void window.localStorage.removeItem(c)}catch(e){}try{window.document.cookie=encodeURIComponent(c)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(e){}}}()},a.enableAll=function(e){a.setLevel(a.levels.TRACE,e)},a.disableAll=function(e){a.setLevel(a.levels.SILENT,e)};var d=getPersistedLevel();null==d&&(d=n),a.setLevel(d,!1)}var n=new Logger,i={};n.getLogger=function getLogger(e){if("symbol"!=typeof e&&"string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=i[e];return t||(t=i[e]=new Logger(e,n.getLevel(),n.methodFactory)),t};var s="undefined"!=typeof window?window.log:void 0;return n.noConflict=function(){return"undefined"!=typeof window&&window.log===n&&(window.log=s),n},n.getLoggers=function getLoggers(){return i},n.default=n,n},"object"==typeof t&&t.exports?t.exports=s():i.log=s()},{}],100:[function(e,t,n){var i=e("sdp");function writeMediaSection(e,t,n,s,a){var c=i.writeRtpDescription(e.kind,t);if(c+=i.writeIceParameters(e.iceGatherer.getLocalParameters()),c+=i.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":a||"active"),c+="a=mid:"+e.mid+"\r\n",e.rtpSender&&e.rtpReceiver?c+="a=sendrecv\r\n":e.rtpSender?c+="a=sendonly\r\n":e.rtpReceiver?c+="a=recvonly\r\n":c+="a=inactive\r\n",e.rtpSender){var d=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=d;var l="msid:"+(s?s.id:"-")+" "+d+"\r\n";c+="a="+l,c+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+l,e.sendEncodingParameters[0].rtx&&(c+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+l,c+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return c+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+i.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(c+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+i.localCName+"\r\n"),c}function getCommonCapabilities(e,t){var n={codecs:[],headerExtensions:[],fecMechanisms:[]},findCodecByPayloadType=function(e,t){e=parseInt(e,10);for(var n=0;n<t.length;n++)if(t[n].payloadType===e||t[n].preferredPayloadType===e)return t[n]},rtxCapabilityMatches=function(e,t,n,i){var s=findCodecByPayloadType(e.parameters.apt,n),a=findCodecByPayloadType(t.parameters.apt,i);return s&&a&&s.name.toLowerCase()===a.name.toLowerCase()};return e.codecs.forEach((function(i){for(var s=0;s<t.codecs.length;s++){var a=t.codecs[s];if(i.name.toLowerCase()===a.name.toLowerCase()&&i.clockRate===a.clockRate){if("rtx"===i.name.toLowerCase()&&i.parameters&&a.parameters.apt&&!rtxCapabilityMatches(i,a,e.codecs,t.codecs))continue;(a=JSON.parse(JSON.stringify(a))).numChannels=Math.min(i.numChannels,a.numChannels),n.codecs.push(a),a.rtcpFeedback=a.rtcpFeedback.filter((function(e){for(var t=0;t<i.rtcpFeedback.length;t++)if(i.rtcpFeedback[t].type===e.type&&i.rtcpFeedback[t].parameter===e.parameter)return!0;return!1}));break}}})),e.headerExtensions.forEach((function(e){for(var i=0;i<t.headerExtensions.length;i++){var s=t.headerExtensions[i];if(e.uri===s.uri){n.headerExtensions.push(s);break}}})),n}function isActionAllowedInSignalingState(e,t,n){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(n)}function maybeAddCandidate(e,t){var n=e.getRemoteCandidates().find((function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type}));return n||e.addRemoteCandidate(t),!n}function makeError(e,t){var n=new Error(t);return n.name=e,n.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],n}t.exports=function(e,t){function addTrackToStreamAndFireEvent(t,n){n.addTrack(t),n.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:t}))}function fireAddTrack(t,n,i,s){var a=new Event("track");a.track=n,a.receiver=i,a.transceiver={receiver:i},a.streams=s,e.setTimeout((function(){t._dispatchEvent("track",a)}))}var RTCPeerConnection=function(n){var s=this,a=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach((function(e){s[e]=a[e].bind(a)})),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",n=JSON.parse(JSON.stringify(n||{})),this.usingBundle="max-bundle"===n.bundlePolicy,"negotiate"===n.rtcpMuxPolicy)throw makeError("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(n.rtcpMuxPolicy||(n.rtcpMuxPolicy="require"),n.iceTransportPolicy){case"all":case"relay":break;default:n.iceTransportPolicy="all"}switch(n.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:n.bundlePolicy="balanced"}if(n.iceServers=function filterIceServers(e,t){var n=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var i=e.urls||e.url;e.url&&!e.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var s="string"==typeof i;return s&&(i=[i]),i=i.filter((function(e){return 0===e.indexOf("turn:")&&-1!==e.indexOf("transport=udp")&&-1===e.indexOf("turn:[")&&!n?(n=!0,!0):0===e.indexOf("stun:")&&t>=14393&&-1===e.indexOf("?transport=udp")})),delete e.url,e.urls=s?i[0]:i,!!i.length}}))}(n.iceServers||[],t),this._iceGatherers=[],n.iceCandidatePoolSize)for(var c=n.iceCandidatePoolSize;c>0;c--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:n.iceServers,gatherPolicy:n.iceTransportPolicy}));else n.iceCandidatePoolSize=0;this._config=n,this.transceivers=[],this._sdpSessionId=i.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(RTCPeerConnection.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(RTCPeerConnection.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),RTCPeerConnection.prototype.onicecandidate=null,RTCPeerConnection.prototype.onaddstream=null,RTCPeerConnection.prototype.ontrack=null,RTCPeerConnection.prototype.onremovestream=null,RTCPeerConnection.prototype.onsignalingstatechange=null,RTCPeerConnection.prototype.oniceconnectionstatechange=null,RTCPeerConnection.prototype.onconnectionstatechange=null,RTCPeerConnection.prototype.onicegatheringstatechange=null,RTCPeerConnection.prototype.onnegotiationneeded=null,RTCPeerConnection.prototype.ondatachannel=null,RTCPeerConnection.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"==typeof this["on"+e]&&this["on"+e](t))},RTCPeerConnection.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},RTCPeerConnection.prototype.getConfiguration=function(){return this._config},RTCPeerConnection.prototype.getLocalStreams=function(){return this.localStreams},RTCPeerConnection.prototype.getRemoteStreams=function(){return this.remoteStreams},RTCPeerConnection.prototype._createTransceiver=function(e,t){var n=this.transceivers.length>0,i={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0};if(this.usingBundle&&n)i.iceTransport=this.transceivers[0].iceTransport,i.dtlsTransport=this.transceivers[0].dtlsTransport;else{var s=this._createIceAndDtlsTransports();i.iceTransport=s.iceTransport,i.dtlsTransport=s.dtlsTransport}return t||this.transceivers.push(i),i},RTCPeerConnection.prototype.addTrack=function(t,n){if(this._isClosed)throw makeError("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var i;if(this.transceivers.find((function(e){return e.track===t})))throw makeError("InvalidAccessError","Track already exists.");for(var s=0;s<this.transceivers.length;s++)this.transceivers[s].track||this.transceivers[s].kind!==t.kind||(i=this.transceivers[s]);return i||(i=this._createTransceiver(t.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(n)&&this.localStreams.push(n),i.track=t,i.stream=n,i.rtpSender=new e.RTCRtpSender(t,i.dtlsTransport),i.rtpSender},RTCPeerConnection.prototype.addStream=function(e){var n=this;if(t>=15025)e.getTracks().forEach((function(t){n.addTrack(t,e)}));else{var i=e.clone();e.getTracks().forEach((function(e,t){var n=i.getTracks()[t];e.addEventListener("enabled",(function(e){n.enabled=e.enabled}))})),i.getTracks().forEach((function(e){n.addTrack(e,i)}))}},RTCPeerConnection.prototype.removeTrack=function(t){if(this._isClosed)throw makeError("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(t instanceof e.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var n=this.transceivers.find((function(e){return e.rtpSender===t}));if(!n)throw makeError("InvalidAccessError","Sender was not created by this connection.");var i=n.stream;n.rtpSender.stop(),n.rtpSender=null,n.track=null,n.stream=null,-1===this.transceivers.map((function(e){return e.stream})).indexOf(i)&&this.localStreams.indexOf(i)>-1&&this.localStreams.splice(this.localStreams.indexOf(i),1),this._maybeFireNegotiationNeeded()},RTCPeerConnection.prototype.removeStream=function(e){var t=this;e.getTracks().forEach((function(e){var n=t.getSenders().find((function(t){return t.track===e}));n&&t.removeTrack(n)}))},RTCPeerConnection.prototype.getSenders=function(){return this.transceivers.filter((function(e){return!!e.rtpSender})).map((function(e){return e.rtpSender}))},RTCPeerConnection.prototype.getReceivers=function(){return this.transceivers.filter((function(e){return!!e.rtpReceiver})).map((function(e){return e.rtpReceiver}))},RTCPeerConnection.prototype._createIceGatherer=function(t,n){var i=this;if(n&&t>0)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var s=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(s,"state",{value:"new",writable:!0}),this.transceivers[t].bufferedCandidateEvents=[],this.transceivers[t].bufferCandidates=function(e){var n=!e.candidate||0===Object.keys(e.candidate).length;s.state=n?"completed":"gathering",null!==i.transceivers[t].bufferedCandidateEvents&&i.transceivers[t].bufferedCandidateEvents.push(e)},s.addEventListener("localcandidate",this.transceivers[t].bufferCandidates),s},RTCPeerConnection.prototype._gather=function(t,n){var s=this,a=this.transceivers[n].iceGatherer;if(!a.onlocalcandidate){var c=this.transceivers[n].bufferedCandidateEvents;this.transceivers[n].bufferedCandidateEvents=null,a.removeEventListener("localcandidate",this.transceivers[n].bufferCandidates),a.onlocalcandidate=function(e){if(!(s.usingBundle&&n>0)){var c=new Event("icecandidate");c.candidate={sdpMid:t,sdpMLineIndex:n};var d=e.candidate,l=!d||0===Object.keys(d).length;if(l)"new"!==a.state&&"gathering"!==a.state||(a.state="completed");else{"new"===a.state&&(a.state="gathering"),d.component=1,d.ufrag=a.getLocalParameters().usernameFragment;var h=i.writeCandidate(d);c.candidate=Object.assign(c.candidate,i.parseCandidate(h)),c.candidate.candidate=h,c.candidate.toJSON=function(){return{candidate:c.candidate.candidate,sdpMid:c.candidate.sdpMid,sdpMLineIndex:c.candidate.sdpMLineIndex,usernameFragment:c.candidate.usernameFragment}}}var p=i.getMediaSections(s._localDescription.sdp);p[c.candidate.sdpMLineIndex]+=l?"a=end-of-candidates\r\n":"a="+c.candidate.candidate+"\r\n",s._localDescription.sdp=i.getDescription(s._localDescription.sdp)+p.join("");var u=s.transceivers.every((function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state}));"gathering"!==s.iceGatheringState&&(s.iceGatheringState="gathering",s._emitGatheringStateChange()),l||s._dispatchEvent("icecandidate",c),u&&(s._dispatchEvent("icecandidate",new Event("icecandidate")),s.iceGatheringState="complete",s._emitGatheringStateChange())}},e.setTimeout((function(){c.forEach((function(e){a.onlocalcandidate(e)}))}),0)}},RTCPeerConnection.prototype._createIceAndDtlsTransports=function(){var t=this,n=new e.RTCIceTransport(null);n.onicestatechange=function(){t._updateIceConnectionState(),t._updateConnectionState()};var i=new e.RTCDtlsTransport(n);return i.ondtlsstatechange=function(){t._updateConnectionState()},i.onerror=function(){Object.defineProperty(i,"state",{value:"failed",writable:!0}),t._updateConnectionState()},{iceTransport:n,dtlsTransport:i}},RTCPeerConnection.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer);var n=this.transceivers[e].iceTransport;n&&(delete n.onicestatechange,delete this.transceivers[e].iceTransport);var i=this.transceivers[e].dtlsTransport;i&&(delete i.ondtlsstatechange,delete i.onerror,delete this.transceivers[e].dtlsTransport)},RTCPeerConnection.prototype._transceive=function(e,n,s){var a=getCommonCapabilities(e.localCapabilities,e.remoteCapabilities);n&&e.rtpSender&&(a.encodings=e.sendEncodingParameters,a.rtcp={cname:i.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(a.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(a)),s&&e.rtpReceiver&&a.codecs.length>0&&("video"===e.kind&&e.recvEncodingParameters&&t<15019&&e.recvEncodingParameters.forEach((function(e){delete e.rtx})),e.recvEncodingParameters.length?a.encodings=e.recvEncodingParameters:a.encodings=[{}],a.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(a.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(a.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(a))},RTCPeerConnection.prototype.setLocalDescription=function(e){var t,n,s=this;if(-1===["offer","answer"].indexOf(e.type))return Promise.reject(makeError("TypeError",'Unsupported type "'+e.type+'"'));if(!isActionAllowedInSignalingState("setLocalDescription",e.type,s.signalingState)||s._isClosed)return Promise.reject(makeError("InvalidStateError","Can not set local "+e.type+" in state "+s.signalingState));if("offer"===e.type)t=i.splitSections(e.sdp),n=t.shift(),t.forEach((function(e,t){var n=i.parseRtpParameters(e);s.transceivers[t].localCapabilities=n})),s.transceivers.forEach((function(e,t){s._gather(e.mid,t)}));else if("answer"===e.type){t=i.splitSections(s._remoteDescription.sdp),n=t.shift();var a=i.matchPrefix(n,"a=ice-lite").length>0;t.forEach((function(e,t){var c=s.transceivers[t],d=c.iceGatherer,l=c.iceTransport,h=c.dtlsTransport,p=c.localCapabilities,u=c.remoteCapabilities;if(!(i.isRejected(e)&&0===i.matchPrefix(e,"a=bundle-only").length)&&!c.rejected){var m=i.getIceParameters(e,n),g=i.getDtlsParameters(e,n);a&&(g.role="server"),s.usingBundle&&0!==t||(s._gather(c.mid,t),"new"===l.state&&l.start(d,m,a?"controlling":"controlled"),"new"===h.state&&h.start(g));var v=getCommonCapabilities(p,u);s._transceive(c,v.codecs.length>0,!1)}}))}return s._localDescription={type:e.type,sdp:e.sdp},"offer"===e.type?s._updateSignalingState("have-local-offer"):s._updateSignalingState("stable"),Promise.resolve()},RTCPeerConnection.prototype.setRemoteDescription=function(n){var s=this;if(-1===["offer","answer"].indexOf(n.type))return Promise.reject(makeError("TypeError",'Unsupported type "'+n.type+'"'));if(!isActionAllowedInSignalingState("setRemoteDescription",n.type,s.signalingState)||s._isClosed)return Promise.reject(makeError("InvalidStateError","Can not set remote "+n.type+" in state "+s.signalingState));var a={};s.remoteStreams.forEach((function(e){a[e.id]=e}));var c=[],d=i.splitSections(n.sdp),l=d.shift(),h=i.matchPrefix(l,"a=ice-lite").length>0,p=i.matchPrefix(l,"a=group:BUNDLE ").length>0;s.usingBundle=p;var u=i.matchPrefix(l,"a=ice-options:")[0];return s.canTrickleIceCandidates=!!u&&u.substr(14).split(" ").indexOf("trickle")>=0,d.forEach((function(d,u){var m=i.splitLines(d),g=i.getKind(d),v=i.isRejected(d)&&0===i.matchPrefix(d,"a=bundle-only").length,f=m[0].substr(2).split(" ")[2],b=i.getDirection(d,l),y=i.parseMsid(d),C=i.getMid(d)||i.generateIdentifier();if(v||"application"===g&&("DTLS/SCTP"===f||"UDP/DTLS/SCTP"===f))s.transceivers[u]={mid:C,kind:g,protocol:f,rejected:!0};else{var S,E,T,I,k,w,R,P,_;!v&&s.transceivers[u]&&s.transceivers[u].rejected&&(s.transceivers[u]=s._createTransceiver(g,!0));var x,M,D=i.parseRtpParameters(d);v||(x=i.getIceParameters(d,l),(M=i.getDtlsParameters(d,l)).role="client"),R=i.parseRtpEncodingParameters(d);var O=i.parseRtcpParameters(d),A=i.matchPrefix(d,"a=end-of-candidates",l).length>0,L=i.matchPrefix(d,"a=candidate:").map((function(e){return i.parseCandidate(e)})).filter((function(e){return 1===e.component}));if(("offer"===n.type||"answer"===n.type)&&!v&&p&&u>0&&s.transceivers[u]&&(s._disposeIceAndDtlsTransports(u),s.transceivers[u].iceGatherer=s.transceivers[0].iceGatherer,s.transceivers[u].iceTransport=s.transceivers[0].iceTransport,s.transceivers[u].dtlsTransport=s.transceivers[0].dtlsTransport,s.transceivers[u].rtpSender&&s.transceivers[u].rtpSender.setTransport(s.transceivers[0].dtlsTransport),s.transceivers[u].rtpReceiver&&s.transceivers[u].rtpReceiver.setTransport(s.transceivers[0].dtlsTransport)),"offer"!==n.type||v){if("answer"===n.type&&!v){E=(S=s.transceivers[u]).iceGatherer,T=S.iceTransport,I=S.dtlsTransport,k=S.rtpReceiver,w=S.sendEncodingParameters,P=S.localCapabilities,s.transceivers[u].recvEncodingParameters=R,s.transceivers[u].remoteCapabilities=D,s.transceivers[u].rtcpParameters=O,L.length&&"new"===T.state&&(!h&&!A||p&&0!==u?L.forEach((function(e){maybeAddCandidate(S.iceTransport,e)})):T.setRemoteCandidates(L)),p&&0!==u||("new"===T.state&&T.start(E,x,"controlling"),"new"===I.state&&I.start(M)),!getCommonCapabilities(S.localCapabilities,S.remoteCapabilities).codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&S.sendEncodingParameters[0].rtx&&delete S.sendEncodingParameters[0].rtx,s._transceive(S,"sendrecv"===b||"recvonly"===b,"sendrecv"===b||"sendonly"===b),!k||"sendrecv"!==b&&"sendonly"!==b?delete S.rtpReceiver:(_=k.track,y?(a[y.stream]||(a[y.stream]=new e.MediaStream),addTrackToStreamAndFireEvent(_,a[y.stream]),c.push([_,k,a[y.stream]])):(a.default||(a.default=new e.MediaStream),addTrackToStreamAndFireEvent(_,a.default),c.push([_,k,a.default])))}}else{(S=s.transceivers[u]||s._createTransceiver(g)).mid=C,S.iceGatherer||(S.iceGatherer=s._createIceGatherer(u,p)),L.length&&"new"===S.iceTransport.state&&(!A||p&&0!==u?L.forEach((function(e){maybeAddCandidate(S.iceTransport,e)})):S.iceTransport.setRemoteCandidates(L)),P=e.RTCRtpReceiver.getCapabilities(g),t<15019&&(P.codecs=P.codecs.filter((function(e){return"rtx"!==e.name}))),w=S.sendEncodingParameters||[{ssrc:1001*(2*u+2)}];var N,B=!1;if("sendrecv"===b||"sendonly"===b){if(B=!S.rtpReceiver,k=S.rtpReceiver||new e.RTCRtpReceiver(S.dtlsTransport,g),B)_=k.track,y&&"-"===y.stream||(y?(a[y.stream]||(a[y.stream]=new e.MediaStream,Object.defineProperty(a[y.stream],"id",{get:function(){return y.stream}})),Object.defineProperty(_,"id",{get:function(){return y.track}}),N=a[y.stream]):(a.default||(a.default=new e.MediaStream),N=a.default)),N&&(addTrackToStreamAndFireEvent(_,N),S.associatedRemoteMediaStreams.push(N)),c.push([_,k,N])}else S.rtpReceiver&&S.rtpReceiver.track&&(S.associatedRemoteMediaStreams.forEach((function(t){var n=t.getTracks().find((function(e){return e.id===S.rtpReceiver.track.id}));n&&function removeTrackFromStreamAndFireEvent(t,n){n.removeTrack(t),n.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:t}))}(n,t)})),S.associatedRemoteMediaStreams=[]);S.localCapabilities=P,S.remoteCapabilities=D,S.rtpReceiver=k,S.rtcpParameters=O,S.sendEncodingParameters=w,S.recvEncodingParameters=R,s._transceive(s.transceivers[u],!1,B)}}})),void 0===s._dtlsRole&&(s._dtlsRole="offer"===n.type?"active":"passive"),s._remoteDescription={type:n.type,sdp:n.sdp},"offer"===n.type?s._updateSignalingState("have-remote-offer"):s._updateSignalingState("stable"),Object.keys(a).forEach((function(t){var n=a[t];if(n.getTracks().length){if(-1===s.remoteStreams.indexOf(n)){s.remoteStreams.push(n);var i=new Event("addstream");i.stream=n,e.setTimeout((function(){s._dispatchEvent("addstream",i)}))}c.forEach((function(e){var t=e[0],i=e[1];n.id===e[2].id&&fireAddTrack(s,t,i,[n])}))}})),c.forEach((function(e){e[2]||fireAddTrack(s,e[0],e[1],[])})),e.setTimeout((function(){s&&s.transceivers&&s.transceivers.forEach((function(e){e.iceTransport&&"new"===e.iceTransport.state&&e.iceTransport.getRemoteCandidates().length>0&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),e.iceTransport.addRemoteCandidate({}))}))}),4e3),Promise.resolve()},RTCPeerConnection.prototype.close=function(){this.transceivers.forEach((function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()})),this._isClosed=!0,this._updateSignalingState("closed")},RTCPeerConnection.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",t)},RTCPeerConnection.prototype._maybeFireNegotiationNeeded=function(){var t=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,e.setTimeout((function(){if(t.needNegotiation){t.needNegotiation=!1;var e=new Event("negotiationneeded");t._dispatchEvent("negotiationneeded",e)}}),0))},RTCPeerConnection.prototype._updateIceConnectionState=function(){var e,t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&!e.rejected&&t[e.iceTransport.state]++})),e="new",t.failed>0?e="failed":t.checking>0?e="checking":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0?e="connected":t.completed>0&&(e="completed"),e!==this.iceConnectionState){this.iceConnectionState=e;var n=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",n)}},RTCPeerConnection.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};if(this.transceivers.forEach((function(e){e.iceTransport&&e.dtlsTransport&&!e.rejected&&(t[e.iceTransport.state]++,t[e.dtlsTransport.state]++)})),t.connected+=t.completed,e="new",t.failed>0?e="failed":t.connecting>0?e="connecting":t.disconnected>0?e="disconnected":t.new>0?e="new":t.connected>0&&(e="connected"),e!==this.connectionState){this.connectionState=e;var n=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",n)}},RTCPeerConnection.prototype.createOffer=function(){var n=this;if(n._isClosed)return Promise.reject(makeError("InvalidStateError","Can not call createOffer after close"));var s=n.transceivers.filter((function(e){return"audio"===e.kind})).length,a=n.transceivers.filter((function(e){return"video"===e.kind})).length,c=arguments[0];if(c){if(c.mandatory||c.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==c.offerToReceiveAudio&&(s=!0===c.offerToReceiveAudio?1:!1===c.offerToReceiveAudio?0:c.offerToReceiveAudio),void 0!==c.offerToReceiveVideo&&(a=!0===c.offerToReceiveVideo?1:!1===c.offerToReceiveVideo?0:c.offerToReceiveVideo)}for(n.transceivers.forEach((function(e){"audio"===e.kind?--s<0&&(e.wantReceive=!1):"video"===e.kind&&--a<0&&(e.wantReceive=!1)}));s>0||a>0;)s>0&&(n._createTransceiver("audio"),s--),a>0&&(n._createTransceiver("video"),a--);var d=i.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.transceivers.forEach((function(s,a){var c=s.track,d=s.kind,l=s.mid||i.generateIdentifier();s.mid=l,s.iceGatherer||(s.iceGatherer=n._createIceGatherer(a,n.usingBundle));var h=e.RTCRtpSender.getCapabilities(d);t<15019&&(h.codecs=h.codecs.filter((function(e){return"rtx"!==e.name}))),h.codecs.forEach((function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1"),s.remoteCapabilities&&s.remoteCapabilities.codecs&&s.remoteCapabilities.codecs.forEach((function(t){e.name.toLowerCase()===t.name.toLowerCase()&&e.clockRate===t.clockRate&&(e.preferredPayloadType=t.payloadType)}))})),h.headerExtensions.forEach((function(e){(s.remoteCapabilities&&s.remoteCapabilities.headerExtensions||[]).forEach((function(t){e.uri===t.uri&&(e.id=t.id)}))}));var p=s.sendEncodingParameters||[{ssrc:1001*(2*a+1)}];c&&t>=15019&&"video"===d&&!p[0].rtx&&(p[0].rtx={ssrc:p[0].ssrc+1}),s.wantReceive&&(s.rtpReceiver=new e.RTCRtpReceiver(s.dtlsTransport,d)),s.localCapabilities=h,s.sendEncodingParameters=p})),"max-compat"!==n._config.bundlePolicy&&(d+="a=group:BUNDLE "+n.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),d+="a=ice-options:trickle\r\n",n.transceivers.forEach((function(e,t){d+=writeMediaSection(e,e.localCapabilities,"offer",e.stream,n._dtlsRole),d+="a=rtcp-rsize\r\n",!e.iceGatherer||"new"===n.iceGatheringState||0!==t&&n.usingBundle||(e.iceGatherer.getLocalCandidates().forEach((function(e){e.component=1,d+="a="+i.writeCandidate(e)+"\r\n"})),"completed"===e.iceGatherer.state&&(d+="a=end-of-candidates\r\n"))}));var l=new e.RTCSessionDescription({type:"offer",sdp:d});return Promise.resolve(l)},RTCPeerConnection.prototype.createAnswer=function(){var n=this;if(n._isClosed)return Promise.reject(makeError("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==n.signalingState&&"have-local-pranswer"!==n.signalingState)return Promise.reject(makeError("InvalidStateError","Can not call createAnswer in signalingState "+n.signalingState));var s=i.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.usingBundle&&(s+="a=group:BUNDLE "+n.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),s+="a=ice-options:trickle\r\n";var a=i.getMediaSections(n._remoteDescription.sdp).length;n.transceivers.forEach((function(e,i){if(!(i+1>a)){if(e.rejected)return"application"===e.kind?"DTLS/SCTP"===e.protocol?s+="m=application 0 DTLS/SCTP 5000\r\n":s+="m=application 0 "+e.protocol+" webrtc-datachannel\r\n":"audio"===e.kind?s+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(s+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(s+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n");var c;if(e.stream)"audio"===e.kind?c=e.stream.getAudioTracks()[0]:"video"===e.kind&&(c=e.stream.getVideoTracks()[0]),c&&t>=15019&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1});var d=getCommonCapabilities(e.localCapabilities,e.remoteCapabilities);!d.codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,s+=writeMediaSection(e,d,"answer",e.stream,n._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(s+="a=rtcp-rsize\r\n")}}));var c=new e.RTCSessionDescription({type:"answer",sdp:s});return Promise.resolve(c)},RTCPeerConnection.prototype.addIceCandidate=function(e){var t,n=this;return e&&void 0===e.sdpMLineIndex&&!e.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise((function(s,a){if(!n._remoteDescription)return a(makeError("InvalidStateError","Can not add ICE candidate without a remote description"));if(e&&""!==e.candidate){var c=e.sdpMLineIndex;if(e.sdpMid)for(var d=0;d<n.transceivers.length;d++)if(n.transceivers[d].mid===e.sdpMid){c=d;break}var l=n.transceivers[c];if(!l)return a(makeError("OperationError","Can not add ICE candidate"));if(l.rejected)return s();var h=Object.keys(e.candidate).length>0?i.parseCandidate(e.candidate):{};if("tcp"===h.protocol&&(0===h.port||9===h.port))return s();if(h.component&&1!==h.component)return s();if((0===c||c>0&&l.iceTransport!==n.transceivers[0].iceTransport)&&!maybeAddCandidate(l.iceTransport,h))return a(makeError("OperationError","Can not add ICE candidate"));var p=e.candidate.trim();0===p.indexOf("a=")&&(p=p.substr(2)),(t=i.getMediaSections(n._remoteDescription.sdp))[c]+="a="+(h.type?p:"end-of-candidates")+"\r\n",n._remoteDescription.sdp=i.getDescription(n._remoteDescription.sdp)+t.join("")}else for(var u=0;u<n.transceivers.length&&(n.transceivers[u].rejected||(n.transceivers[u].iceTransport.addRemoteCandidate({}),(t=i.getMediaSections(n._remoteDescription.sdp))[u]+="a=end-of-candidates\r\n",n._remoteDescription.sdp=i.getDescription(n._remoteDescription.sdp)+t.join(""),!n.usingBundle));u++);s()}))},RTCPeerConnection.prototype.getStats=function(t){if(t&&t instanceof e.MediaStreamTrack){var n=null;if(this.transceivers.forEach((function(e){e.rtpSender&&e.rtpSender.track===t?n=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===t&&(n=e.rtpReceiver)})),!n)throw makeError("InvalidAccessError","Invalid selector.");return n.getStats()}var i=[];return this.transceivers.forEach((function(e){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach((function(t){e[t]&&i.push(e[t].getStats())}))})),Promise.all(i).then((function(e){var t=new Map;return e.forEach((function(e){e.forEach((function(e){t.set(e.id,e)}))})),t}))};["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach((function(t){var n=e[t];if(n&&n.prototype&&n.prototype.getStats){var i=n.prototype.getStats;n.prototype.getStats=function(){return i.apply(this).then((function(e){var t=new Map;return Object.keys(e).forEach((function(n){e[n].type=function fixStatsType(e){return{inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type}(e[n]),t.set(n,e[n])})),t}))}}}));var n=["createOffer","createAnswer"];return n.forEach((function(e){var t=RTCPeerConnection.prototype[e];RTCPeerConnection.prototype[e]=function(){var e=arguments;return"function"==typeof e[0]||"function"==typeof e[1]?t.apply(this,[arguments[2]]).then((function(t){"function"==typeof e[0]&&e[0].apply(null,[t])}),(function(t){"function"==typeof e[1]&&e[1].apply(null,[t])})):t.apply(this,arguments)}})),(n=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach((function(e){var t=RTCPeerConnection.prototype[e];RTCPeerConnection.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]||"function"==typeof e[2]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)}),(function(t){"function"==typeof e[2]&&e[2].apply(null,[t])})):t.apply(this,arguments)}})),["getStats"].forEach((function(e){var t=RTCPeerConnection.prototype[e];RTCPeerConnection.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)})):t.apply(this,arguments)}})),RTCPeerConnection}},{sdp:101}],101:[function(e,t,n){var i={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};i.localCName=i.generateIdentifier(),i.splitLines=function(e){return e.trim().split("\n").map((function(e){return e.trim()}))},i.splitSections=function(e){return e.split("\nm=").map((function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"}))},i.getDescription=function(e){var t=i.splitSections(e);return t&&t[0]},i.getMediaSections=function(e){var t=i.splitSections(e);return t.shift(),t},i.matchPrefix=function(e,t){return i.splitLines(e).filter((function(e){return 0===e.indexOf(t)}))},i.parseCandidate=function(e){for(var t,n={foundation:(t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]},i=8;i<t.length;i+=2)switch(t[i]){case"raddr":n.relatedAddress=t[i+1];break;case"rport":n.relatedPort=parseInt(t[i+1],10);break;case"tcptype":n.tcpType=t[i+1];break;case"ufrag":n.ufrag=t[i+1],n.usernameFragment=t[i+1];break;default:n[t[i]]=t[i+1]}return n},i.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var n=e.type;return t.push("typ"),t.push(n),"host"!==n&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},i.parseIceOptions=function(e){return e.substr(14).split(" ")},i.parseRtpMap=function(e){var t=e.substr(9).split(" "),n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.channels=3===t.length?parseInt(t[2],10):1,n.numChannels=n.channels,n},i.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var n=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},i.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}},i.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},i.parseFmtp=function(e){for(var t,n={},i=e.substr(e.indexOf(" ")+1).split(";"),s=0;s<i.length;s++)n[(t=i[s].trim().split("="))[0].trim()]=t[1];return n},i.writeFmtp=function(e){var t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){var i=[];Object.keys(e.parameters).forEach((function(t){e.parameters[t]?i.push(t+"="+e.parameters[t]):i.push(t)})),t+="a=fmtp:"+n+" "+i.join(";")+"\r\n"}return t},i.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},i.writeRtcpFb=function(e){var t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach((function(e){t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),t},i.parseSsrcMedia=function(e){var t=e.indexOf(" "),n={ssrc:parseInt(e.substr(7,t-7),10)},i=e.indexOf(":",t);return i>-1?(n.attribute=e.substr(t+1,i-t-1),n.value=e.substr(i+1)):n.attribute=e.substr(t+1),n},i.parseSsrcGroup=function(e){var t=e.substr(13).split(" ");return{semantics:t.shift(),ssrcs:t.map((function(e){return parseInt(e,10)}))}},i.getMid=function(e){var t=i.matchPrefix(e,"a=mid:")[0];if(t)return t.substr(6)},i.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}},i.getDtlsParameters=function(e,t){return{role:"auto",fingerprints:i.matchPrefix(e+t,"a=fingerprint:").map(i.parseFingerprint)}},i.writeDtlsParameters=function(e,t){var n="a=setup:"+t+"\r\n";return e.fingerprints.forEach((function(e){n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),n},i.parseCryptoLine=function(e){var t=e.substr(9).split(" ");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},i.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"==typeof e.keyParams?i.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},i.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:"))return null;var t=e.substr(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},i.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},i.getCryptoParameters=function(e,t){return i.matchPrefix(e+t,"a=crypto:").map(i.parseCryptoLine)},i.getIceParameters=function(e,t){var n=i.matchPrefix(e+t,"a=ice-ufrag:")[0],s=i.matchPrefix(e+t,"a=ice-pwd:")[0];return n&&s?{usernameFragment:n.substr(12),password:s.substr(10)}:null},i.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},i.parseRtpParameters=function(e){for(var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},n=i.splitLines(e)[0].split(" "),s=3;s<n.length;s++){var a=n[s],c=i.matchPrefix(e,"a=rtpmap:"+a+" ")[0];if(c){var d=i.parseRtpMap(c),l=i.matchPrefix(e,"a=fmtp:"+a+" ");switch(d.parameters=l.length?i.parseFmtp(l[0]):{},d.rtcpFeedback=i.matchPrefix(e,"a=rtcp-fb:"+a+" ").map(i.parseRtcpFb),t.codecs.push(d),d.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(d.name.toUpperCase())}}}return i.matchPrefix(e,"a=extmap:").forEach((function(e){t.headerExtensions.push(i.parseExtmap(e))})),t},i.writeRtpDescription=function(e,t){var n="";n+="m="+e+" ",n+=t.codecs.length>0?"9":"0",n+=" UDP/TLS/RTP/SAVPF ",n+=t.codecs.map((function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType})).join(" ")+"\r\n",n+="c=IN IP4 0.0.0.0\r\n",n+="a=rtcp:9 IN IP4 0.0.0.0\r\n",t.codecs.forEach((function(e){n+=i.writeRtpMap(e),n+=i.writeFmtp(e),n+=i.writeRtcpFb(e)}));var s=0;return t.codecs.forEach((function(e){e.maxptime>s&&(s=e.maxptime)})),s>0&&(n+="a=maxptime:"+s+"\r\n"),n+="a=rtcp-mux\r\n",t.headerExtensions&&t.headerExtensions.forEach((function(e){n+=i.writeExtmap(e)})),n},i.parseRtpEncodingParameters=function(e){var t,n=[],s=i.parseRtpParameters(e),a=-1!==s.fecMechanisms.indexOf("RED"),c=-1!==s.fecMechanisms.indexOf("ULPFEC"),d=i.matchPrefix(e,"a=ssrc:").map((function(e){return i.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute})),l=d.length>0&&d[0].ssrc,h=i.matchPrefix(e,"a=ssrc-group:FID").map((function(e){return e.substr(17).split(" ").map((function(e){return parseInt(e,10)}))}));h.length>0&&h[0].length>1&&h[0][0]===l&&(t=h[0][1]),s.codecs.forEach((function(e){if("RTX"===e.name.toUpperCase()&&e.parameters.apt){var i={ssrc:l,codecPayloadType:parseInt(e.parameters.apt,10)};l&&t&&(i.rtx={ssrc:t}),n.push(i),a&&((i=JSON.parse(JSON.stringify(i))).fec={ssrc:l,mechanism:c?"red+ulpfec":"red"},n.push(i))}})),0===n.length&&l&&n.push({ssrc:l});var p=i.matchPrefix(e,"b=");return p.length&&(p=0===p[0].indexOf("b=TIAS:")?parseInt(p[0].substr(7),10):0===p[0].indexOf("b=AS:")?1e3*parseInt(p[0].substr(5),10)*.95-16e3:void 0,n.forEach((function(e){e.maxBitrate=p}))),n},i.parseRtcpParameters=function(e){var t={},n=i.matchPrefix(e,"a=ssrc:").map((function(e){return i.parseSsrcMedia(e)})).filter((function(e){return"cname"===e.attribute}))[0];n&&(t.cname=n.value,t.ssrc=n.ssrc);var s=i.matchPrefix(e,"a=rtcp-rsize");t.reducedSize=s.length>0,t.compound=0===s.length;var a=i.matchPrefix(e,"a=rtcp-mux");return t.mux=a.length>0,t},i.parseMsid=function(e){var t,n=i.matchPrefix(e,"a=msid:");if(1===n.length)return{stream:(t=n[0].substr(7).split(" "))[0],track:t[1]};var s=i.matchPrefix(e,"a=ssrc:").map((function(e){return i.parseSsrcMedia(e)})).filter((function(e){return"msid"===e.attribute}));return s.length>0?{stream:(t=s[0].value.split(" "))[0],track:t[1]}:void 0},i.parseSctpDescription=function(e){var t,n=i.parseMLine(e),s=i.matchPrefix(e,"a=max-message-size:");s.length>0&&(t=parseInt(s[0].substr(19),10)),isNaN(t)&&(t=65536);var a=i.matchPrefix(e,"a=sctp-port:");if(a.length>0)return{port:parseInt(a[0].substr(12),10),protocol:n.fmt,maxMessageSize:t};if(i.matchPrefix(e,"a=sctpmap:").length>0){var c=i.matchPrefix(e,"a=sctpmap:")[0].substr(10).split(" ");return{port:parseInt(c[0],10),protocol:c[1],maxMessageSize:t}}},i.writeSctpDescription=function(e,t){var n=[];return n="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&n.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),n.join("")},i.generateSessionId=function(){return Math.random().toString().substr(2,21)},i.writeSessionBoilerplate=function(e,t,n){var s=void 0!==t?t:2;return"v=0\r\no="+(n||"thisisadapterortc")+" "+(e||i.generateSessionId())+" "+s+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},i.writeMediaSection=function(e,t,n,s){var a=i.writeRtpDescription(e.kind,t);if(a+=i.writeIceParameters(e.iceGatherer.getLocalParameters()),a+=i.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":"active"),a+="a=mid:"+e.mid+"\r\n",e.direction?a+="a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?a+="a=sendrecv\r\n":e.rtpSender?a+="a=sendonly\r\n":e.rtpReceiver?a+="a=recvonly\r\n":a+="a=inactive\r\n",e.rtpSender){var c="msid:"+s.id+" "+e.rtpSender.track.id+"\r\n";a+="a="+c,a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+c,e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+c,a+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")}return a+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+i.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(a+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+i.localCName+"\r\n"),a},i.getDirection=function(e,t){for(var n=i.splitLines(e),s=0;s<n.length;s++)switch(n[s]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return n[s].substr(2)}return t?i.getDirection(t):"sendrecv"},i.getKind=function(e){return i.splitLines(e)[0].split(" ")[0].substr(2)},i.isRejected=function(e){return"0"===e.split(" ",2)[1]},i.parseMLine=function(e){var t=i.splitLines(e)[0].substr(2).split(" ");return{kind:t[0],port:parseInt(t[1],10),protocol:t[2],fmt:t.slice(3).join(" ")}},i.parseOLine=function(e){var t=i.matchPrefix(e,"o=")[0].substr(2).split(" ");return{username:t[0],sessionId:t[1],sessionVersion:parseInt(t[2],10),netType:t[3],addressType:t[4],address:t[5]}},i.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;for(var t=i.splitLines(e),n=0;n<t.length;n++)if(t[n].length<2||"="!==t[n].charAt(1))return!1;return!0},"object"==typeof t&&(t.exports=i)},{}],102:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var i=(0,e("./adapter_factory.js").adapterFactory)({window:"undefined"==typeof window?void 0:window});n.default=i},{"./adapter_factory.js":103}],103:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.adapterFactory=function adapterFactory(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.window,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0},h=i.log,p=i.detectBrowser(t),u={browserDetails:p,commonShim:l,extractVersion:i.extractVersion,disableLog:i.disableLog,disableWarnings:i.disableWarnings};switch(p.browser){case"chrome":if(!s||!s.shimPeerConnection||!n.shimChrome)return h("Chrome shim is not included in this adapter release."),u;if(null===p.version)return h("Chrome shim can not determine version, not shimming."),u;h("adapter.js shimming chrome."),u.browserShim=s,l.shimAddIceCandidateNullOrEmpty(t,p),s.shimGetUserMedia(t,p),s.shimMediaStream(t,p),s.shimPeerConnection(t,p),s.shimOnTrack(t,p),s.shimAddTrackRemoveTrack(t,p),s.shimGetSendersWithDtmf(t,p),s.shimGetStats(t,p),s.shimSenderReceiverGetStats(t,p),s.fixNegotiationNeeded(t,p),l.shimRTCIceCandidate(t,p),l.shimConnectionState(t,p),l.shimMaxMessageSize(t,p),l.shimSendThrowTypeError(t,p),l.removeExtmapAllowMixed(t,p);break;case"firefox":if(!c||!c.shimPeerConnection||!n.shimFirefox)return h("Firefox shim is not included in this adapter release."),u;h("adapter.js shimming firefox."),u.browserShim=c,l.shimAddIceCandidateNullOrEmpty(t,p),c.shimGetUserMedia(t,p),c.shimPeerConnection(t,p),c.shimOnTrack(t,p),c.shimRemoveStream(t,p),c.shimSenderGetStats(t,p),c.shimReceiverGetStats(t,p),c.shimRTCDataChannel(t,p),c.shimAddTransceiver(t,p),c.shimGetParameters(t,p),c.shimCreateOffer(t,p),c.shimCreateAnswer(t,p),l.shimRTCIceCandidate(t,p),l.shimConnectionState(t,p),l.shimMaxMessageSize(t,p),l.shimSendThrowTypeError(t,p);break;case"edge":if(!a||!a.shimPeerConnection||!n.shimEdge)return h("MS edge shim is not included in this adapter release."),u;h("adapter.js shimming edge."),u.browserShim=a,a.shimGetUserMedia(t,p),a.shimGetDisplayMedia(t,p),a.shimPeerConnection(t,p),a.shimReplaceTrack(t,p),l.shimMaxMessageSize(t,p),l.shimSendThrowTypeError(t,p);break;case"safari":if(!d||!n.shimSafari)return h("Safari shim is not included in this adapter release."),u;h("adapter.js shimming safari."),u.browserShim=d,l.shimAddIceCandidateNullOrEmpty(t,p),d.shimRTCIceServerUrls(t,p),d.shimCreateOfferLegacy(t,p),d.shimCallbacksAPI(t,p),d.shimLocalStreamsAPI(t,p),d.shimRemoteStreamsAPI(t,p),d.shimTrackEventTransceiver(t,p),d.shimGetUserMedia(t,p),d.shimAudioContext(t,p),l.shimRTCIceCandidate(t,p),l.shimMaxMessageSize(t,p),l.shimSendThrowTypeError(t,p),l.removeExtmapAllowMixed(t,p);break;default:h("Unsupported browser!")}return u};var i=_interopRequireWildcard(e("./utils")),s=_interopRequireWildcard(e("./chrome/chrome_shim")),a=_interopRequireWildcard(e("./edge/edge_shim")),c=_interopRequireWildcard(e("./firefox/firefox_shim")),d=_interopRequireWildcard(e("./safari/safari_shim")),l=_interopRequireWildcard(e("./common_shim"));function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}},{"./chrome/chrome_shim":104,"./common_shim":107,"./edge/edge_shim":108,"./firefox/firefox_shim":112,"./safari/safari_shim":115,"./utils":116}],104:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=n.shimGetUserMedia=void 0;var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=e("./getusermedia");Object.defineProperty(n,"shimGetUserMedia",{enumerable:!0,get:function get(){return s.shimGetUserMedia}});var a=e("./getdisplaymedia");Object.defineProperty(n,"shimGetDisplayMedia",{enumerable:!0,get:function get(){return a.shimGetDisplayMedia}}),n.shimMediaStream=function shimMediaStream(e){e.MediaStream=e.MediaStream||e.webkitMediaStream},n.shimOnTrack=function shimOnTrack(e){if("object"===(void 0===e?"undefined":i(e))&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get:function get(){return this._ontrack},set:function set(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function setRemoteDescription(){var n=this;return this._ontrackpoly||(this._ontrackpoly=function(t){t.stream.addEventListener("addtrack",(function(i){var s=void 0;s=e.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find((function(e){return e.track&&e.track.id===i.track.id})):{track:i.track};var a=new Event("track");a.track=i.track,a.receiver=s,a.transceiver={receiver:s},a.streams=[t.stream],n.dispatchEvent(a)})),t.stream.getTracks().forEach((function(i){var s=void 0;s=e.RTCPeerConnection.prototype.getReceivers?n.getReceivers().find((function(e){return e.track&&e.track.id===i.id})):{track:i};var a=new Event("track");a.track=i,a.receiver=s,a.transceiver={receiver:s},a.streams=[t.stream],n.dispatchEvent(a)}))},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else c.wrapPeerConnectionEvent(e,"track",(function(e){return e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e}))},n.shimGetSendersWithDtmf=function shimGetSendersWithDtmf(e){if("object"===(void 0===e?"undefined":i(e))&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){var t=function shimSenderWithDtmf(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function getSenders(){return this._senders=this._senders||[],this._senders.slice()};var n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function addTrack(e,i){var s=n.apply(this,arguments);return s||(s=t(this,e),this._senders.push(s)),s};var s=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function removeTrack(e){s.apply(this,arguments);var t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}var a=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function addStream(e){var n=this;this._senders=this._senders||[],a.apply(this,[e]),e.getTracks().forEach((function(e){n._senders.push(t(n,e))}))};var c=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function removeStream(e){var t=this;this._senders=this._senders||[],c.apply(this,[e]),e.getTracks().forEach((function(e){var n=t._senders.find((function(t){return t.track===e}));n&&t._senders.splice(t._senders.indexOf(n),1)}))}}else if("object"===(void 0===e?"undefined":i(e))&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){var d=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function getSenders(){var e=this,t=d.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}},n.shimGetStats=function shimGetStats(e){if(!e.RTCPeerConnection)return;var t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function getStats(){var e=this,n=Array.prototype.slice.call(arguments),i=n[0],s=n[1],a=n[2];if(arguments.length>0&&"function"==typeof i)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof i))return t.apply(this,[]);var c=function fixChromeStats_(e){var t={};return e.result().forEach((function(e){var n={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};e.names().forEach((function(t){n[t]=e.stat(t)})),t[n.id]=n})),t},d=function makeMapStats(e){return new Map(Object.keys(e).map((function(t){return[t,e[t]]})))};if(arguments.length>=2){var l=function successCallbackWrapper_(e){s(d(c(e)))};return t.apply(this,[l,i])}return new Promise((function(n,i){t.apply(e,[function(e){n(d(c(e)))},i])})).then(s,a)}},n.shimSenderReceiverGetStats=function shimSenderReceiverGetStats(e){if(!("object"===(void 0===e?"undefined":i(e))&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function getSenders(){var e=this,n=t.apply(this,[]);return n.forEach((function(t){return t._pc=e})),n});var n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function addTrack(){var e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function getStats(){var e=this;return this._pc.getStats().then((function(t){return c.filterStats(t,e.track,!0)}))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){var s=e.RTCPeerConnection.prototype.getReceivers;s&&(e.RTCPeerConnection.prototype.getReceivers=function getReceivers(){var e=this,t=s.apply(this,[]);return t.forEach((function(t){return t._pc=e})),t}),c.wrapPeerConnectionEvent(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function getStats(){var e=this;return this._pc.getStats().then((function(t){return c.filterStats(t,e.track,!1)}))}}if(!("getStats"in e.RTCRtpSender.prototype)||!("getStats"in e.RTCRtpReceiver.prototype))return;var a=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function getStats(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){var t=arguments[0],n=void 0,i=void 0,s=void 0;return this.getSenders().forEach((function(e){e.track===t&&(n?s=!0:n=e)})),this.getReceivers().forEach((function(e){return e.track===t&&(i?s=!0:i=e),e.track===t})),s||n&&i?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):n?n.getStats():i?i.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return a.apply(this,arguments)}},n.shimAddTrackRemoveTrackWithNative=shimAddTrackRemoveTrackWithNative,n.shimAddTrackRemoveTrack=function shimAddTrackRemoveTrack(e,t){if(!e.RTCPeerConnection)return;if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return shimAddTrackRemoveTrackWithNative(e);var n=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function getLocalStreams(){var e=this,t=n.apply(this);return this._reverseStreams=this._reverseStreams||{},t.map((function(t){return e._reverseStreams[t.id]}))};var i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function addStream(t){var n=this;if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach((function(e){if(n.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")})),!this._reverseStreams[t.id]){var s=new e.MediaStream(t.getTracks());this._streams[t.id]=s,this._reverseStreams[s.id]=t,t=s}i.apply(this,[t])};var s=e.RTCPeerConnection.prototype.removeStream;function replaceInternalStreamId(e,t){var n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((function(t){var i=e._reverseStreams[t],s=e._streams[i.id];n=n.replace(new RegExp(s.id,"g"),i.id)})),new RTCSessionDescription({type:t.type,sdp:n})}function replaceExternalStreamId(e,t){var n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach((function(t){var i=e._reverseStreams[t],s=e._streams[i.id];n=n.replace(new RegExp(i.id,"g"),s.id)})),new RTCSessionDescription({type:t.type,sdp:n})}e.RTCPeerConnection.prototype.removeStream=function removeStream(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},s.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function addTrack(t,n){var i=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var s=[].slice.call(arguments,1);if(1!==s.length||!s[0].getTracks().find((function(e){return e===t})))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");var a=this.getSenders().find((function(e){return e.track===t}));if(a)throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};var c=this._streams[n.id];if(c)c.addTrack(t),Promise.resolve().then((function(){i.dispatchEvent(new Event("negotiationneeded"))}));else{var d=new e.MediaStream([t]);this._streams[n.id]=d,this._reverseStreams[d.id]=n,this.addStream(d)}return this.getSenders().find((function(e){return e.track===t}))},["createOffer","createAnswer"].forEach((function(t){var n=e.RTCPeerConnection.prototype[t],i=_defineProperty({},t,(function(){var e=this,t=arguments,i=arguments.length&&"function"==typeof arguments[0];return i?n.apply(this,[function(n){var i=replaceInternalStreamId(e,n);t[0].apply(null,[i])},function(e){t[1]&&t[1].apply(null,e)},arguments[2]]):n.apply(this,arguments).then((function(t){return replaceInternalStreamId(e,t)}))}));e.RTCPeerConnection.prototype[t]=i[t]}));var a=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function setLocalDescription(){return arguments.length&&arguments[0].type?(arguments[0]=replaceExternalStreamId(this,arguments[0]),a.apply(this,arguments)):a.apply(this,arguments)};var c=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get:function get(){var e=c.get.apply(this);return""===e.type?e:replaceInternalStreamId(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function removeTrack(e){var t=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(e._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};var n=void 0;Object.keys(this._streams).forEach((function(i){t._streams[i].getTracks().find((function(t){return e.track===t}))&&(n=t._streams[i])})),n&&(1===n.getTracks().length?this.removeStream(this._reverseStreams[n.id]):n.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}},n.shimPeerConnection=function shimPeerConnection(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection);if(!e.RTCPeerConnection)return;t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var n=e.RTCPeerConnection.prototype[t],i=_defineProperty({},t,(function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}));e.RTCPeerConnection.prototype[t]=i[t]}))},n.fixNegotiationNeeded=function fixNegotiationNeeded(e,t){c.wrapPeerConnectionEvent(e,"negotiationneeded",(function(e){var n=e.target;if(!(t.version<72||n.getConfiguration&&"plan-b"===n.getConfiguration().sdpSemantics)||"stable"===n.signalingState)return e}))};var c=function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../utils.js"));function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function shimAddTrackRemoveTrackWithNative(e){e.RTCPeerConnection.prototype.getLocalStreams=function getLocalStreams(){var e=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map((function(t){return e._shimmedLocalStreams[t][0]}))};var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function addTrack(e,n){if(!n)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var i=t.apply(this,arguments);return this._shimmedLocalStreams[n.id]?-1===this._shimmedLocalStreams[n.id].indexOf(i)&&this._shimmedLocalStreams[n.id].push(i):this._shimmedLocalStreams[n.id]=[n,i],i};var n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function addStream(e){var t=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach((function(e){if(t.getSenders().find((function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")}));var i=this.getSenders();n.apply(this,arguments);var s=this.getSenders().filter((function(e){return-1===i.indexOf(e)}));this._shimmedLocalStreams[e.id]=[e].concat(s)};var i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function removeStream(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],i.apply(this,arguments)};var s=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function removeTrack(e){var t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach((function(n){var i=t._shimmedLocalStreams[n].indexOf(e);-1!==i&&t._shimmedLocalStreams[n].splice(i,1),1===t._shimmedLocalStreams[n].length&&delete t._shimmedLocalStreams[n]})),s.apply(this,arguments)}}},{"../utils.js":116,"./getdisplaymedia":105,"./getusermedia":106}],105:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function shimGetDisplayMedia(e,t){if(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices)return;if(!e.navigator.mediaDevices)return;if("function"!=typeof t)return void console.error("shimGetDisplayMedia: getSourceId argument is not a function");e.navigator.mediaDevices.getDisplayMedia=function getDisplayMedia(n){return t(n).then((function(t){var i=n.video&&n.video.width,s=n.video&&n.video.height,a=n.video&&n.video.frameRate;return n.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:a||3}},i&&(n.video.mandatory.maxWidth=i),s&&(n.video.mandatory.maxHeight=s),e.navigator.mediaDevices.getUserMedia(n)}))}}},{}],106:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};n.shimGetUserMedia=function shimGetUserMedia(e,t){var n=e&&e.navigator;if(!n.mediaDevices)return;var a=function constraintsToChrome_(e){if("object"!==(void 0===e?"undefined":i(e))||e.mandatory||e.optional)return e;var t={};return Object.keys(e).forEach((function(n){if("require"!==n&&"advanced"!==n&&"mediaSource"!==n){var s="object"===i(e[n])?e[n]:{ideal:e[n]};void 0!==s.exact&&"number"==typeof s.exact&&(s.min=s.max=s.exact);var a=function oldname_(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==s.ideal){t.optional=t.optional||[];var c={};"number"==typeof s.ideal?(c[a("min",n)]=s.ideal,t.optional.push(c),(c={})[a("max",n)]=s.ideal,t.optional.push(c)):(c[a("",n)]=s.ideal,t.optional.push(c))}void 0!==s.exact&&"number"!=typeof s.exact?(t.mandatory=t.mandatory||{},t.mandatory[a("",n)]=s.exact):["min","max"].forEach((function(e){void 0!==s[e]&&(t.mandatory=t.mandatory||{},t.mandatory[a(e,n)]=s[e])}))}})),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},c=function shimConstraints_(e,c){if(t.version>=61)return c(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"===i(e.audio)){var d=function remap(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])};d((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),d(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=a(e.audio)}if(e&&"object"===i(e.video)){var l=e.video.facingMode;l=l&&("object"===(void 0===l?"undefined":i(l))?l:{ideal:l});var h=t.version<66;if(l&&("user"===l.exact||"environment"===l.exact||"user"===l.ideal||"environment"===l.ideal)&&(!n.mediaDevices.getSupportedConstraints||!n.mediaDevices.getSupportedConstraints().facingMode||h)){delete e.video.facingMode;var p=void 0;if("environment"===l.exact||"environment"===l.ideal?p=["back","rear"]:"user"!==l.exact&&"user"!==l.ideal||(p=["front"]),p)return n.mediaDevices.enumerateDevices().then((function(t){var n=(t=t.filter((function(e){return"videoinput"===e.kind}))).find((function(e){return p.some((function(t){return e.label.toLowerCase().includes(t)}))}));return!n&&t.length&&p.includes("back")&&(n=t[t.length-1]),n&&(e.video.deviceId=l.exact?{exact:n.deviceId}:{ideal:n.deviceId}),e.video=a(e.video),s("chrome: "+JSON.stringify(e)),c(e)}))}e.video=a(e.video)}return s("chrome: "+JSON.stringify(e)),c(e)},d=function shimError_(e){return t.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString:function toString(){return this.name+(this.message&&": ")+this.message}}};if(n.getUserMedia=function getUserMedia_(e,t,i){c(e,(function(e){n.webkitGetUserMedia(e,t,(function(e){i&&i(d(e))}))}))}.bind(n),n.mediaDevices.getUserMedia){var l=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(e){return c(e,(function(e){return l(e).then((function(t){if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw t.getTracks().forEach((function(e){e.stop()})),new DOMException("","NotFoundError");return t}),(function(e){return Promise.reject(d(e))}))}))}}};var s=function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../utils.js")).log},{"../utils.js":116}],107:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};n.shimRTCIceCandidate=function shimRTCIceCandidate(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;var t=e.RTCIceCandidate;e.RTCIceCandidate=function RTCIceCandidate(e){if("object"===(void 0===e?"undefined":i(e))&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){var n=new t(e),a=s.default.parseCandidate(e.candidate),c=Object.assign(n,a);return c.toJSON=function toJSON(){return{candidate:c.candidate,sdpMid:c.sdpMid,sdpMLineIndex:c.sdpMLineIndex,usernameFragment:c.usernameFragment}},c}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,a.wrapPeerConnectionEvent(e,"icecandidate",(function(t){return t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t}))},n.shimMaxMessageSize=function shimMaxMessageSize(e,t){if(!e.RTCPeerConnection)return;"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get:function get(){return void 0===this._sctp?null:this._sctp}});var n=function sctpInDescription(e){if(!e||!e.sdp)return!1;var t=s.default.splitSections(e.sdp);return t.shift(),t.some((function(e){var t=s.default.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")}))},i=function getRemoteFirefoxVersion(e){var t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;var n=parseInt(t[1],10);return n!=n?-1:n},a=function getCanSendMaxMessageSize(e){var n=65536;return"firefox"===t.browser&&(n=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),n},c=function getMaxMessageSize(e,n){var i=65536;"firefox"===t.browser&&57===t.version&&(i=65535);var a=s.default.matchPrefix(e.sdp,"a=max-message-size:");return a.length>0?i=parseInt(a[0].substr(19),10):"firefox"===t.browser&&-1!==n&&(i=2147483637),i},d=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function setRemoteDescription(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){var e=this.getConfiguration(),s=e.sdpSemantics;"plan-b"===s&&Object.defineProperty(this,"sctp",{get:function get(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(n(arguments[0])){var l=i(arguments[0]),h=a(l),p=c(arguments[0],l),u=void 0;u=0===h&&0===p?Number.POSITIVE_INFINITY:0===h||0===p?Math.max(h,p):Math.min(h,p);var m={};Object.defineProperty(m,"maxMessageSize",{get:function get(){return u}}),this._sctp=m}return d.apply(this,arguments)}},n.shimSendThrowTypeError=function shimSendThrowTypeError(e){if(!e.RTCPeerConnection||!("createDataChannel"in e.RTCPeerConnection.prototype))return;function wrapDcSend(e,t){var n=e.send;e.send=function send(){var i=arguments[0],s=i.length||i.size||i.byteLength;if("open"===e.readyState&&t.sctp&&s>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return n.apply(e,arguments)}}var t=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function createDataChannel(){var e=t.apply(this,arguments);return wrapDcSend(e,this),e},a.wrapPeerConnectionEvent(e,"datachannel",(function(e){return wrapDcSend(e.channel,e.target),e}))},n.shimConnectionState=function shimConnectionState(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;var t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get:function get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get:function get(){return this._onconnectionstatechange||null},set:function set(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach((function(e){var n=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(e){var t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;var n=new Event("connectionstatechange",e);t.dispatchEvent(n)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}}))},n.removeExtmapAllowMixed=function removeExtmapAllowMixed(e,t){if(!e.RTCPeerConnection)return;if("chrome"===t.browser&&t.version>=71)return;if("safari"===t.browser&&t.version>=605)return;var n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function setRemoteDescription(t){if(t&&t.sdp&&-1!==t.sdp.indexOf("\na=extmap-allow-mixed")){var i=t.sdp.split("\n").filter((function(e){return"a=extmap-allow-mixed"!==e.trim()})).join("\n");e.RTCSessionDescription&&t instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:t.type,sdp:i}):t.sdp=i}return n.apply(this,arguments)}},n.shimAddIceCandidateNullOrEmpty=function shimAddIceCandidateNullOrEmpty(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;var n=e.RTCPeerConnection.prototype.addIceCandidate;if(!n||0===n.length)return;e.RTCPeerConnection.prototype.addIceCandidate=function addIceCandidate(){return arguments[0]?("chrome"===t.browser&&t.version<78||"firefox"===t.browser&&t.version<68||"safari"===t.browser)&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())}};var s=function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}(e("sdp")),a=function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("./utils"))},{"./utils":116,sdp:101}],108:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=n.shimGetUserMedia=void 0;var i=e("./getusermedia");Object.defineProperty(n,"shimGetUserMedia",{enumerable:!0,get:function get(){return i.shimGetUserMedia}});var s=e("./getdisplaymedia");Object.defineProperty(n,"shimGetDisplayMedia",{enumerable:!0,get:function get(){return s.shimGetDisplayMedia}}),n.shimPeerConnection=function shimPeerConnection(e,t){if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function RTCIceCandidate(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function RTCSessionDescription(e){return e}),t.version<15025)){var n=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set:function set(e){n.set.call(this,e);var t=new Event("enabled");t.enabled=e,this.dispatchEvent(t)}})}e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)&&Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}});e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);var i=(0,d.default)(e,t.version);e.RTCPeerConnection=function RTCPeerConnection(e){return e&&e.iceServers&&(e.iceServers=(0,c.filterIceServers)(e.iceServers,t.version),a.log("ICE servers after filtering:",e.iceServers)),new i(e)},e.RTCPeerConnection.prototype=i.prototype},n.shimReplaceTrack=function shimReplaceTrack(e){e.RTCRtpSender&&!("replaceTrack"in e.RTCRtpSender.prototype)&&(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)};var a=function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../utils")),c=e("./filtericeservers"),d=function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}(e("rtcpeerconnection-shim"))},{"../utils":116,"./filtericeservers":109,"./getdisplaymedia":110,"./getusermedia":111,"rtcpeerconnection-shim":100}],109:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.filterIceServers=function filterIceServers(e,t){var n=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var t=e.urls||e.url;e.url&&!e.urls&&i.deprecated("RTCIceServer.url","RTCIceServer.urls");var s="string"==typeof t;return s&&(t=[t]),t=t.filter((function(e){if(0===e.indexOf("stun:"))return!1;var t=e.startsWith("turn")&&!e.startsWith("turn:[")&&e.includes("transport=udp");return t&&!n?(n=!0,!0):t&&!n})),delete e.url,e.urls=s?t[0]:t,!!t.length}}))};var i=function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../utils"))},{"../utils":116}],110:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function shimGetDisplayMedia(e){if(!("getDisplayMedia"in e.navigator))return;if(!e.navigator.mediaDevices)return;if(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices)return;e.navigator.mediaDevices.getDisplayMedia=e.navigator.getDisplayMedia.bind(e.navigator)}},{}],111:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetUserMedia=function shimGetUserMedia(e){var t=e&&e.navigator,n=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return n(e).catch((function(e){return Promise.reject(function shimError_(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString:function toString(){return this.name}}}(e))}))}}},{}],112:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=n.shimGetUserMedia=void 0;var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=e("./getusermedia");Object.defineProperty(n,"shimGetUserMedia",{enumerable:!0,get:function get(){return s.shimGetUserMedia}});var a=e("./getdisplaymedia");Object.defineProperty(n,"shimGetDisplayMedia",{enumerable:!0,get:function get(){return a.shimGetDisplayMedia}}),n.shimOnTrack=function shimOnTrack(e){"object"===(void 0===e?"undefined":i(e))&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function get(){return{receiver:this.receiver}}})},n.shimPeerConnection=function shimPeerConnection(e,t){if("object"!==(void 0===e?"undefined":i(e))||!e.RTCPeerConnection&&!e.mozRTCPeerConnection)return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection);t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach((function(t){var n=e.RTCPeerConnection.prototype[t],i=function _defineProperty(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n;return e}({},t,(function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}));e.RTCPeerConnection.prototype[t]=i[t]}));var n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},s=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function getStats(){var e=Array.prototype.slice.call(arguments),i=e[0],a=e[1],c=e[2];return s.apply(this,[i||null]).then((function(e){if(t.version<53&&!a)try{e.forEach((function(e){e.type=n[e.type]||e.type}))}catch(t){if("TypeError"!==t.name)throw t;e.forEach((function(t,i){e.set(i,Object.assign({},t,{type:n[t.type]||t.type}))}))}return e})).then(a,c)}},n.shimSenderGetStats=function shimSenderGetStats(e){if("object"!==(void 0===e?"undefined":i(e))||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function getSenders(){var e=this,n=t.apply(this,[]);return n.forEach((function(t){return t._pc=e})),n});var n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function addTrack(){var e=n.apply(this,arguments);return e._pc=this,e});e.RTCRtpSender.prototype.getStats=function getStats(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}},n.shimReceiverGetStats=function shimReceiverGetStats(e){if("object"!==(void 0===e?"undefined":i(e))||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;var t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function getReceivers(){var e=this,n=t.apply(this,[]);return n.forEach((function(t){return t._pc=e})),n});c.wrapPeerConnectionEvent(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function getStats(){return this._pc.getStats(this.track)}},n.shimRemoveStream=function shimRemoveStream(e){if(!e.RTCPeerConnection||"removeStream"in e.RTCPeerConnection.prototype)return;e.RTCPeerConnection.prototype.removeStream=function removeStream(e){var t=this;c.deprecated("removeStream","removeTrack"),this.getSenders().forEach((function(n){n.track&&e.getTracks().includes(n.track)&&t.removeTrack(n)}))}},n.shimRTCDataChannel=function shimRTCDataChannel(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)},n.shimAddTransceiver=function shimAddTransceiver(e){if("object"!==(void 0===e?"undefined":i(e))||!e.RTCPeerConnection)return;var t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function addTransceiver(){this.setParametersPromises=[];var e=arguments[1],n=e&&"sendEncodings"in e;n&&e.sendEncodings.forEach((function(e){if("rid"in e){if(!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.")}if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")}));var i=t.apply(this,arguments);if(n){var s=i.sender,a=s.getParameters();(!("encodings"in a)||1===a.encodings.length&&0===Object.keys(a.encodings[0]).length)&&(a.encodings=e.sendEncodings,s.sendEncodings=e.sendEncodings,this.setParametersPromises.push(s.setParameters(a).then((function(){delete s.sendEncodings})).catch((function(){delete s.sendEncodings}))))}return i})},n.shimGetParameters=function shimGetParameters(e){if("object"!==(void 0===e?"undefined":i(e))||!e.RTCRtpSender)return;var t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function getParameters(){var e=t.apply(this,arguments);return"encodings"in e||(e.encodings=[].concat(this.sendEncodings||[{}])),e})},n.shimCreateOffer=function shimCreateOffer(e){if("object"!==(void 0===e?"undefined":i(e))||!e.RTCPeerConnection)return;var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function createOffer(){var e=this,n=arguments;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((function(){return t.apply(e,n)})).finally((function(){e.setParametersPromises=[]})):t.apply(this,arguments)}},n.shimCreateAnswer=function shimCreateAnswer(e){if("object"!==(void 0===e?"undefined":i(e))||!e.RTCPeerConnection)return;var t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function createAnswer(){var e=this,n=arguments;return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then((function(){return t.apply(e,n)})).finally((function(){e.setParametersPromises=[]})):t.apply(this,arguments)}};var c=function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../utils"))},{"../utils":116,"./getdisplaymedia":113,"./getusermedia":114}],113:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.shimGetDisplayMedia=function shimGetDisplayMedia(e,t){if(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices)return;if(!e.navigator.mediaDevices)return;e.navigator.mediaDevices.getDisplayMedia=function getDisplayMedia(n){if(!n||!n.video){var i=new DOMException("getDisplayMedia without video constraints is undefined");return i.name="NotFoundError",i.code=8,Promise.reject(i)}return!0===n.video?n.video={mediaSource:t}:n.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(n)}}},{}],114:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};n.shimGetUserMedia=function shimGetUserMedia(e,t){var n=e&&e.navigator,a=e&&e.MediaStreamTrack;if(n.getUserMedia=function(e,t,i){s.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(e).then(t,i)},!(t.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){var c=function remap(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},d=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(e){return"object"===(void 0===e?"undefined":i(e))&&"object"===i(e.audio)&&(e=JSON.parse(JSON.stringify(e)),c(e.audio,"autoGainControl","mozAutoGainControl"),c(e.audio,"noiseSuppression","mozNoiseSuppression")),d(e)},a&&a.prototype.getSettings){var l=a.prototype.getSettings;a.prototype.getSettings=function(){var e=l.apply(this,arguments);return c(e,"mozAutoGainControl","autoGainControl"),c(e,"mozNoiseSuppression","noiseSuppression"),e}}if(a&&a.prototype.applyConstraints){var h=a.prototype.applyConstraints;a.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"===(void 0===e?"undefined":i(e))&&(e=JSON.parse(JSON.stringify(e)),c(e,"autoGainControl","mozAutoGainControl"),c(e,"noiseSuppression","mozNoiseSuppression")),h.apply(this,[e])}}}};var s=function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../utils"))},{"../utils":116}],115:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};n.shimLocalStreamsAPI=function shimLocalStreamsAPI(e){if("object"!==(void 0===e?"undefined":i(e))||!e.RTCPeerConnection)return;"getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function getLocalStreams(){return this._localStreams||(this._localStreams=[]),this._localStreams});if(!("addStream"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function addStream(e){var n=this;this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach((function(i){return t.call(n,i,e)})),e.getVideoTracks().forEach((function(i){return t.call(n,i,e)}))},e.RTCPeerConnection.prototype.addTrack=function addTrack(e){for(var n=this,i=arguments.length,s=Array(i>1?i-1:0),a=1;a<i;a++)s[a-1]=arguments[a];return s&&s.forEach((function(e){n._localStreams?n._localStreams.includes(e)||n._localStreams.push(e):n._localStreams=[e]})),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function removeStream(e){var t=this;this._localStreams||(this._localStreams=[]);var n=this._localStreams.indexOf(e);if(-1!==n){this._localStreams.splice(n,1);var i=e.getTracks();this.getSenders().forEach((function(e){i.includes(e.track)&&t.removeTrack(e)}))}})},n.shimRemoteStreamsAPI=function shimRemoteStreamsAPI(e){if("object"!==(void 0===e?"undefined":i(e))||!e.RTCPeerConnection)return;"getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function getRemoteStreams(){return this._remoteStreams?this._remoteStreams:[]});if(!("onaddstream"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function get(){return this._onaddstream},set:function set(e){var t=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach((function(e){if(t._remoteStreams||(t._remoteStreams=[]),!t._remoteStreams.includes(e)){t._remoteStreams.push(e);var n=new Event("addstream");n.stream=e,t.dispatchEvent(n)}}))})}});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function setRemoteDescription(){var e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach((function(t){if(e._remoteStreams||(e._remoteStreams=[]),!(e._remoteStreams.indexOf(t)>=0)){e._remoteStreams.push(t);var n=new Event("addstream");n.stream=t,e.dispatchEvent(n)}}))}),t.apply(e,arguments)}}},n.shimCallbacksAPI=function shimCallbacksAPI(e){if("object"!==(void 0===e?"undefined":i(e))||!e.RTCPeerConnection)return;var t=e.RTCPeerConnection.prototype,n=t.createOffer,s=t.createAnswer,a=t.setLocalDescription,c=t.setRemoteDescription,d=t.addIceCandidate;t.createOffer=function createOffer(e,t){var i=arguments.length>=2?arguments[2]:arguments[0],s=n.apply(this,[i]);return t?(s.then(e,t),Promise.resolve()):s},t.createAnswer=function createAnswer(e,t){var n=arguments.length>=2?arguments[2]:arguments[0],i=s.apply(this,[n]);return t?(i.then(e,t),Promise.resolve()):i};var l=function withCallback(e,t,n){var i=a.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i};t.setLocalDescription=l,l=function withCallback(e,t,n){var i=c.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i},t.setRemoteDescription=l,l=function withCallback(e,t,n){var i=d.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i},t.addIceCandidate=l},n.shimGetUserMedia=function shimGetUserMedia(e){var t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){var n=t.mediaDevices,i=n.getUserMedia.bind(n);t.mediaDevices.getUserMedia=function(e){return i(shimConstraints(e))}}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function getUserMedia(e,n,i){t.mediaDevices.getUserMedia(e).then(n,i)}.bind(t))},n.shimConstraints=shimConstraints,n.shimRTCIceServerUrls=function shimRTCIceServerUrls(e){if(!e.RTCPeerConnection)return;var t=e.RTCPeerConnection;e.RTCPeerConnection=function RTCPeerConnection(e,n){if(e&&e.iceServers){for(var i=[],a=0;a<e.iceServers.length;a++){var c=e.iceServers[a];!c.hasOwnProperty("urls")&&c.hasOwnProperty("url")?(s.deprecated("RTCIceServer.url","RTCIceServer.urls"),(c=JSON.parse(JSON.stringify(c))).urls=c.url,delete c.url,i.push(c)):i.push(e.iceServers[a])}e.iceServers=i}return new t(e,n)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function get(){return t.generateCertificate}})},n.shimTrackEventTransceiver=function shimTrackEventTransceiver(e){"object"===(void 0===e?"undefined":i(e))&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function get(){return{receiver:this.receiver}}})},n.shimCreateOfferLegacy=function shimCreateOfferLegacy(e){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function createOffer(e){if(e){void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);var n=this.getTransceivers().find((function(e){return"audio"===e.receiver.track.kind}));!1===e.offerToReceiveAudio&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveAudio||n||this.addTransceiver("audio"),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);var i=this.getTransceivers().find((function(e){return"video"===e.receiver.track.kind}));!1===e.offerToReceiveVideo&&i?"sendrecv"===i.direction?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":"recvonly"===i.direction&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):!0!==e.offerToReceiveVideo||i||this.addTransceiver("video")}return t.apply(this,arguments)}},n.shimAudioContext=function shimAudioContext(e){if("object"!==(void 0===e?"undefined":i(e))||e.AudioContext)return;e.AudioContext=e.webkitAudioContext};var s=function _interopRequireWildcard(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(e("../utils"));function shimConstraints(e){return e&&void 0!==e.video?Object.assign({},e,{video:s.compactObject(e.video)}):e}},{"../utils":116}],116:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};n.extractVersion=extractVersion,n.wrapPeerConnectionEvent=function wrapPeerConnectionEvent(e,t,n){if(!e.RTCPeerConnection)return;var i=e.RTCPeerConnection.prototype,s=i.addEventListener;i.addEventListener=function(e,i){if(e!==t)return s.apply(this,arguments);var a=function wrappedCallback(e){var t=n(e);t&&(i.handleEvent?i.handleEvent(t):i(t))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(i,a),s.apply(this,[e,a])};var a=i.removeEventListener;i.removeEventListener=function(e,n){if(e!==t||!this._eventMap||!this._eventMap[t])return a.apply(this,arguments);if(!this._eventMap[t].has(n))return a.apply(this,arguments);var i=this._eventMap[t].get(n);return this._eventMap[t].delete(n),0===this._eventMap[t].size&&delete this._eventMap[t],0===Object.keys(this._eventMap).length&&delete this._eventMap,a.apply(this,[e,i])},Object.defineProperty(i,"on"+t,{get:function get(){return this["_on"+t]},set:function set(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})},n.disableLog=function disableLog(e){if("boolean"!=typeof e)return new Error("Argument type: "+(void 0===e?"undefined":i(e))+". Please use a boolean.");return s=e,e?"adapter.js logging disabled":"adapter.js logging enabled"},n.disableWarnings=function disableWarnings(e){if("boolean"!=typeof e)return new Error("Argument type: "+(void 0===e?"undefined":i(e))+". Please use a boolean.");return a=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled")},n.log=function log(){if("object"===("undefined"==typeof window?"undefined":i(window))){if(s)return;"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}},n.deprecated=function deprecated(e,t){if(!a)return;console.warn(e+" is deprecated, please use "+t+" instead.")},n.detectBrowser=function detectBrowser(e){var t={browser:null,version:null};if(void 0===e||!e.navigator)return t.browser="Not a browser.",t;var n=e.navigator;if(n.mozGetUserMedia)t.browser="firefox",t.version=extractVersion(n.userAgent,/Firefox\/(\d+)\./,1);else if(n.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)t.browser="chrome",t.version=extractVersion(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(n.mediaDevices&&n.userAgent.match(/Edge\/(\d+).(\d+)$/))t.browser="edge",t.version=extractVersion(n.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.RTCPeerConnection||!n.userAgent.match(/AppleWebKit\/(\d+)\./))return t.browser="Not a supported browser.",t;t.browser="safari",t.version=extractVersion(n.userAgent,/AppleWebKit\/(\d+)\./,1),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return t},n.compactObject=function compactObject(e){if(!isObject(e))return e;return Object.keys(e).reduce((function(t,n){var i=isObject(e[n]),s=i?compactObject(e[n]):e[n],a=i&&!Object.keys(s).length;return void 0===s||a?t:Object.assign(t,function _defineProperty(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n;return e}({},n,s))}),{})},n.walkStats=walkStats,n.filterStats=function filterStats(e,t,n){var i=n?"outbound-rtp":"inbound-rtp",s=new Map;if(null===t)return s;var a=[];return e.forEach((function(e){"track"===e.type&&e.trackIdentifier===t.id&&a.push(e)})),a.forEach((function(t){e.forEach((function(n){n.type===i&&n.trackId===t.id&&walkStats(e,n,s)}))})),s};var s=!0,a=!0;function extractVersion(e,t,n){var i=e.match(t);return i&&i.length>=n&&parseInt(i[n],10)}function isObject(e){return"[object Object]"===Object.prototype.toString.call(e)}function walkStats(e,t,n){t&&!n.has(t.id)&&(n.set(t.id,t),Object.keys(t).forEach((function(i){i.endsWith("Id")?walkStats(e,e.get(t[i]),n):i.endsWith("Ids")&&t[i].forEach((function(t){walkStats(e,e.get(t),n)}))})))}},{}],117:[function(e,t,n){t.exports=class APIManager{constructor(e){this.instance=e,this.apiFunctions={},this.registerFunction({name:"sendData",category:"VM_communication",fn:e=>{this.instance.sendEvent(e)},description:'Send data to the instance using WebSocket messages. The data must be a JSON object. Example usage: {type: "MOUSE_PRESS", x: 100, y: 100}'}),this.registerFunction({name:"addEventListener",category:"VM_communication",fn:(e,t)=>this.instance.registerEventCallback(e,t),description:"Add an event listener for WebSocket messages from the instance. The listener will be triggered whenever the specified event occurs."}),this.registerFunction({name:"disconnect",category:"VM_communication",fn:()=>{this.instance.destroy()},description:"Disconnect from the current instance, ending the WebSocket communication."}),this.registerFunction({name:"getRegisteredFunctions",category:"utils",fn:()=>this.getRegisteredFunctions(),description:"Retrieve a list of all registered API functions with their descriptions."}),this.registerFunction({name:"enableTrackEvents",category:"analytics",fn:e=>{this.instance.store.dispatch({type:"ENABLE_TRACKED_EVENTS",payload:e}),e||this.instance.store.dispatch({type:"FLUSH_TRACKED_EVENTS"})},description:"Enable or disable the tracking of analytic events. If disabled, all tracked events will be cleared."}),this.registerFunction({name:"trackEvents",category:"analytics",fn:e=>{this.instance.store.subscribe(t=>{let{trackedEvents:n}=t;this.instance.store.state.trackedEvents.events.length&&(e([...n.events]),this.instance.store.dispatch({type:"FLUSH_TRACKED_EVENTS"}))},["trackedEvents.events"])},description:"Invoke a callback function with an array of tracked events. This function is called whenever a new event is recorded."})}registerFunction(e){let{name:t,category:n="global",fn:i,description:s=""}=e;if(this.apiFunctions[`${n}_${t}`])throw new Error(`Function ${t} for category ${n} is already registered.`);this.apiFunctions[`${n}_${t}`]={fn:i,category:n,description:s,name:t}}getRegisteredFunctions(){return Object.entries(this.apiFunctions).reduce((e,t)=>(e[t[1].name]=t[1].description,e),{})}getExposedApiFunctions(){return Object.entries(this.apiFunctions).reduce((e,t)=>{const{name:n,category:i,fn:s}=t[1];return e[i]||(e[i]={}),e[i][n]=s,e},{})}}},{}],118:[function(e,t,n){const i=e("./plugins/MultiTouchEvents"),s=e("./plugins/ButtonsEvents"),a=e("./plugins/Fullscreen"),c=e("./plugins/Clipboard"),d=e("./plugins/StreamBitrate"),l=e("./plugins/Screencast"),h=e("./plugins/StreamResolution"),p=e("./plugins/CoordinateUtils"),u=e("./plugins/KeyboardEvents"),m=e("./plugins/KeyboardMapping"),g=e("./plugins/MouseEvents"),v=e("./plugins/PeerConnectionStats"),f=e("./plugins/Gamepad"),b=e("./plugins/Camera"),y=e("./plugins/GPS"),C=e("./plugins/FileUpload"),S=e("./plugins/Battery"),E=e("./plugins/Identifiers"),T=e("./plugins/Network"),I=e("./plugins/Phone"),k=e("./plugins/BasebandRIL"),w=e("./plugins/IOThrottling"),R=e("./plugins/GamepadManager"),P=e("./plugins/FingerPrint"),_=e("./plugins/MediaManager"),{generateUID:x}=e("./utils/helpers"),M=e("loglevel");M.setDefaultLevel("error"),t.exports=class DeviceRenderer{constructor(e,t){this.timeoutCallbacks=[],this.videoBackupStyleBackground="",this.options=t,this.initialized=!1,this.reconnecting=!1,this.touchEventsEnabled=!1,this.gamepadEventsEnabled=!1,this.webRTCWebsocket=null,this.useWebsocketAsDataChannel=!1,this.root=e,this.video=this.getChildByClass(this.root,"gm-video"),this.wrapper=this.getChildByClass(this.root,"gm-wrapper"),this.videoWrapper=this.getChildByClass(this.root,"gm-video-wrapper"),this.stream=null,this.callbacks={},this.allListeners=[],this.peerConnection=null,this.signalingDataChannel=null,this.cameraSender=null,this.microphoneSender=null,this.sdpConstraints={offerToReceiveAudio:!0,offerToReceiveVideo:!0},this.x=0,this.y=0}getPlugins(){return[{enabled:this.options.touch,class:i},{enabled:this.options.fullscreen,class:a},{enabled:this.options.clipboard,class:c,params:[this.options.i18n]},{enabled:this.options.streamBitrate,class:d,params:[this.options.i18n]},{enabled:this.options.camera,class:b,params:[this.options.i18n],dependencies:[_]},{enabled:this.options.fileUpload,class:C,params:[this.options.i18n]},{enabled:this.options.battery,class:S,params:[this.options.i18n]},{enabled:this.options.gps,class:y,params:[this.options.i18n,this.options.gpsSpeedSupport]},{enabled:this.options.capture,class:l,params:[this.options.i18n]},{enabled:this.options.streamResolution,class:h},{enabled:this.options.touch||this.options.mouse,class:p},{enabled:this.options.keyboard,class:u},{enabled:this.options.keyboardMapping,class:m},{enabled:this.options.mouse,class:g},{enabled:this.options.gamepad,class:f,params:[this.options.i18n],dependencies:[R]},{enabled:this.options.identifiers,class:E,params:[this.options.i18n]},{enabled:this.options.network,class:T,params:[this.options.i18n]},{enabled:this.options.phone,class:I,params:[this.options.i18n]},{enabled:this.options.baseband,class:k,params:[this.options.i18n,this.options.baseband]},{enabled:this.options.diskIO,class:w,params:[this.options.i18n]},{enabled:this.options.biometrics,class:P},{enabled:this.options.microphone,dependencies:[_]},{enabled:this.options.buttons,class:s,params:[this.options.i18n,this.options.translateHomeKey]}]}dispatchEvent(e,t){window.dispatchEvent(new CustomEvent(e,{detail:t}))}getChildByClass(e,t){for(let n=0;n<e.childNodes.length;n++){const i=e.childNodes[n];if(i.classList&&i.classList.contains(t))return i;const s=this.getChildByClass(i,t);if(s)return s}return null}registerEventCallback(e,t){this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t)}emit(e,t){this.callbacks[e]&&this.callbacks[e].forEach(e=>{e(t)})}isWebsocketOpen(e){return e&&e instanceof WebSocket&&e.readyState===e.OPEN}onWebRTCReady(){this.webRTCConnectionRetryCount=0,this.openWebRTCConnection()}openWebRTCConnection(){this.webRTCWebsocket&&(this.disconnect(),this.reconnecting=!0),this.webRTCWebsocket=new WebSocket(this.options.webRTCUrl,this.webRTCWebsocketName),this.webRTCWebsocket.onopen=this.sendAuthenticationToken.bind(this),this.webRTCWebsocket.onmessage=this.onWebSocketMessage.bind(this),this.webRTCWebsocket.onerror=this.onWebSocketMessage.bind(this),this.webRTCWebsocket.binaryType="arraybuffer",this.webRTCConnectionRetryCount<=13?this.onConnectionClosed():M.error("Unable to establish connection to your instance.")}onConnectionClosed(){const e=this.video,t=this.store;this.webRTCWebsocket.onclose=n=>{switch(t.dispatch({type:"WEBRTC_CONNECTION_READY",payload:!1}),e.style.background=this.videoBackupStyleBackground,this.initialized=!1,M.debug("Error! Maybe your VM is not available yet? ("+n.code+") "+n.reason),n.code){case 1e3:case 1001:case 1005:M.debug("Closing websocket"),this.dispatchEvent("closeConnection",{msg:"Closing connection"});break;case 1002:case 1003:case 1006:case 1007:case 1008:case 1009:case 1010:case 1011:case 1012:case 1013:case 1014:case 1015:{this.dispatchEvent("closeConnectionUnavailable",{msg:"Can't connect to the WebSocket"}),M.debug("Retrying in 3 seconds...");const e=setTimeout(()=>{this.openWebRTCConnection()},3e3);this.timeoutCallbacks.push(e),this.webRTCConnectionRetryCount++;break}case 4242:this.dispatchEvent("closeWrongToken",{msg:"Wrong token, can't establish connection"});break;case 4243:this.dispatchEvent("closeNoLongerValidToken",{msg:"The token provided is no longer valid"});break;case 4244:this.dispatchEvent("closeServerShutdown",{msg:"Server is shutting down..."});break;default:this.dispatchEvent("defaultCloseConnection",{msg:"Default close connection"})}}}sendAuthenticationToken(){const e={type:"token",token:this.options.token};this.isWebsocketOpen(this.webRTCWebsocket)&&this.webRTCWebsocket.send(JSON.stringify(e))}disconnect(){var e;if(this.initialized=!1,null===(e=this.mediaManager)||void 0===e||e.disconnect(),this.webRTCWebsocket&&(this.webRTCWebsocket.close(),this.webRTCWebsocket=null,this.timeoutCallbacks.forEach(e=>{clearTimeout(e)}),this.timeoutCallbacks=[]),this.peerConnection&&(this.peerConnection.close(),this.peerConnection=null),this.signalingDataChannel&&(this.signalingDataChannel.close(),this.signalingDataChannel=null),void 0!==this.fileUpload){const e={type:"close"};this.fileUpload.loaderWorker.postMessage(e)}}sendEvent(e){e=JSON.stringify(e),this.useWebsocketAsDataChannel?this.isWebsocketOpen(this.webRTCWebsocket)&&this.webRTCWebsocket.send(e):this.signalingDataChannel&&"open"===this.signalingDataChannel.readyState?this.signalingDataChannel.send(e):M.warn("cannot send event, signaling data channel closed")}async renegotiateWebRTCConnection(){/^((?!chrome|android).)*safari/i.test(navigator.userAgent)&&(this.peerConnection.addTransceiver("audio"),this.peerConnection.addTransceiver("video"));try{const e=await this.peerConnection.createOffer(this.sdpConstraints);this.setLocalDescription(e)}catch(e){return this.onWebRTCConnectionError(e),!1}return!0}createPeerConnection(){M.debug("Creating peer connection");const e=[];Array.isArray(this.options.stun)?this.options.stun.forEach(t=>{e.push(t)}):Object.keys(this.options.stun).length>0&&e.push(this.options.stun),Array.isArray(this.options.turn)?this.options.turn.forEach(t=>{e.push(t)}):Object.keys(this.options.turn).length>0&&e.push(this.options.turn);const t={iceServers:e};if(this.peerConnection)M.debug("Peer connection already exists");else try{this.peerConnection=new RTCPeerConnection(t)}catch(e){M.warn("Failed to create PeerConnection, exception:",e.message)}void 0!==this.peerConnection.createDataChannel?this.createDataChannels():this.useWebsocketAsDataChannel=!0,this.peerConnection.onicecandidate=e=>{void 0!==e.candidate&&(e.candidate?this.sendIceCandidate(e.candidate):M.debug("All candidates ready"))},this.peerConnection.ontrack=e=>{if(M.debug("Received track:",e.track.kind),"video"!==e.track.kind)return;M.debug("Added remote video track using ontrack"),this.video.srcObject=e.streams[0],this.video.setAttribute("playsinline",!0),this.stream=e.streams[0],new v(this,this.peerConnection,3e3),this.videoBackupStyleBackground=this.video.style.background,this.video.style.background="transparent",this.touchEventsEnabled&&this.touchEvents.addTouchCallbacks(),this.gamepadEventsEnabled&&this.gamepadManager.addGamepadCallbacks();const t=this.video.play();t&&t.then(()=>{M.debug("Playing video with sound enabled"),this.dispatchEvent("video",{msg:"play automatically allowed with sound"})}).catch(()=>{M.debug("Can't play video with sound enabled"),this.dispatchEvent("video",{msg:"play with sound denied"}),this.video.muted=!0;this.video.play().then(()=>{M.debug("Playing video with sound disabled"),this.dispatchEvent("video",{msg:"play automatically allowed without sound"});const e=document.createElement("div");e.classList.add("gm-click-to-unmute"),e.innerHTML=this.options.i18n.UNMUTE_INVITE||"By default, the sound has been turned off, please click anywhere to re-enable audio",this.videoWrapper.prepend(e);this.removeAddSoundListener=this.addListener(window,["click","touchend"],()=>{this.video.muted=!1,this.removeAddSoundListener(),this.dispatchEvent("video",{msg:"sound manually allowed by click"}),e.remove(),M.debug("Playing video with sound enabled has been authorized due to user click")})}).catch(()=>{M.debug("Can't play video, even with sound disabled"),this.dispatchEvent("video",{msg:"play denied even without sound"});const e=document.createElement("div");this.classList.add("gm-click-to-display"),this.classList.add("gm-video-overlay"),this.videoWrapper.prepend(e);this.removeAllowPlayListener=this.addListener(e,["click","touchend"],()=>{this.removeAllowPlayListener(),this.video.play(),e.remove(),this.dispatchEvent("video",{msg:"play manually allowed by click"}),M.debug("Playing video with sound disabled has been authorized due to user click")})})})},this.peerConnection.oniceconnectionstatechange=()=>{const e=this.peerConnection?this.peerConnection.iceConnectionState:"No peerConnection";if(M.debug("iceConnectionState: ",e),this.dispatchEvent("iceConnectionState",{msg:e}),"failed"!==e)return;let t='<div class="gm-error-text">Aw, snap!<br/>Connection failed.<p>Check your internet connection & firewall rules.{DOC_AVAILABLE}</p></div>';const n=document.createElement("div");if(n.classList.add("gm-overlay-cant-connect"),n.classList.add("gm-video-overlay"),this.videoWrapper.prepend(n),this.options.connectionFailedURL){t=t.replace("{DOC_AVAILABLE}",'</br>See <a href="">help</a> to setup TURN configuration.');const openDocumentationLink=()=>{this.removeOpenDocListener(),this.dispatchEvent("iceConnectionStateDocumentation",{msg:"clicked"}),n.remove(),window.open(this.options.connectionFailedURL,"_blank")};this.removeOpenDocListener=this.addListener(n,["click","touchend"],openDocumentationLink)}else t=t.replace("{DOC_AVAILABLE}","");n.innerHTML=t},this.onConnectionStateChange=()=>{M.debug("ConnectionState changed:",this.peerConnection.iceConnectionState),"disconnected"===this.peerConnection.iceConnectionState&&this.onWebRTCReady()},this.addListener(this.peerConnection,"connectionstatechange",this.onConnectionStateChange),this.peerConnection.onnegotiationneeded=()=>{M.debug("on Negotiation needed")},this.renegotiateWebRTCConnection()}createDataChannels(){this.signalingDataChannel=this.peerConnection.createDataChannel("events",{ordered:!0}),this.signalingDataChannel.onerror=e=>{M.warn("Data Channel Error:",e)},this.signalingDataChannel.onmessage=e=>{M.debug("Got Data Channel Message:",e.data)},this.signalingDataChannel.onopen=()=>{this.store.dispatch({type:"WEBRTC_CONNECTION_READY",payload:!0}),M.debug("Data Channel opened")},this.signalingDataChannel.onclose=()=>{M.debug("The Data Channel is Closed")},this.peerConnection.ondatachannel=e=>{e.channel.onmessage=this.onDataChannelMessage.bind(this)}}sendIceCandidate(e){this.isWebsocketOpen(this.webRTCWebsocket)&&this.webRTCWebsocket.send(JSON.stringify(e))}setLocalDescription(e){const t=[...e.sdp.matchAll(/a=rtpmap:(\d+) opus\/48000\/2/g)][0];t&&(e.sdp=e.sdp.replace(new RegExp(`(a=fmtp:${t[1]}) ?(.*)(\r?\n)`,"g"),(e,t,n,i,s,a)=>`${n?`${t} ${n};`:t+" "}stereo=1;maxplaybackrate=48000;maxaveragebitrate=256000${i}`)),this.peerConnection.setLocalDescription(e),this.isWebsocketOpen(this.webRTCWebsocket)&&this.webRTCWebsocket.send(JSON.stringify(e))}onWebSocketMessage(e){let t=null;try{t=JSON.parse(e.data)}catch(e){return}if(t)if(t.sdp)try{const e=new RTCSessionDescription(t);this.peerConnection.setRemoteDescription(e,this.onWebRTCConnectionEstablished.bind(this),this.onWebRTCConnectionError.bind(this))}catch(e){M.warn("Failed to create SDP ",e.message)}else if(t.candidate){if("end-of-candidates"===t.candidate)return void M.debug("End of ICE candidates received");try{const e=new RTCIceCandidate(t);this.peerConnection.addIceCandidate(e)}catch(e){M.warn("Failed to create ICE ",e.message)}}else t.connection?this.createPeerConnection():this.handleMessage(t)}onWebRTCConnectionEstablished(){if(M.debug("WebRTC connection success"),!this.initialized&&(this.initialized=!0,this.reconnecting?this.reconnecting=!1:this.dispatchEvent("successConnection",{msg:"Connection established"}),this.fileUpload)){const e={type:"address",fileUploadAddress:this.options.fileUploadUrl,token:this.options.token};this.fileUpload.loaderWorker&&this.fileUpload.loaderWorker.postMessage(e)}}onWebRTCConnectionError(e){M.debug("Failure callback:",e)}onDataChannelMessage(e){const t=JSON.parse(e.data);this.handleMessage(t)}handleMessage(e){if("USERS"===e.type)"SUCCESS"===e.code&&this.dispatchEvent("userListUpdated",{msg:e.message});else if("VERSION"===e.type){if("SUCCESS"===e.code){const t=this.getChildByClass(this.root,"gm-version-number");t&&(t.innerHTML=e.message)}}else"CAPABILITIES"===e.type&&[{widget:this.battery,capability:e.message.battery},{widget:this.camera,capability:e.message.camera},{widget:this.gps,capability:e.message.gps},{widget:this.identifiers,capability:e.message.identifiers},{widget:this.network,capability:e.message.network},{widget:this.network,capability:e.message.mobileThrottling,enable:e=>{e.enableMobileThrottling()},disable:e=>{e.disableMobileThrottling()}},{widget:this.network,capability:e.message.enable5G,enable:e=>{e.enable5G()},disable:e=>{e.disable5G()}},{widget:this.phone,capability:e.message.phone},{widget:this.baseband,capability:e.message.phone},{widget:this.diskIO,capability:e.message.diskIO},{widget:this.buttonsEvents,capability:e.message.accelerometer,enable:e=>{e.enableRotation()},disable:e=>{e.disableRotation()}},{widget:this.fileUpload,capability:e.message.systemPatcher,enable:e=>{e.setAvailability(!0)},disable:e=>{e.setAvailability(!1)}},{widget:this.fingerprint,capability:e.message.biometrics},{widget:this.gamepad,capability:e.message.gamepad}].forEach(e=>{void 0!==e.widget&&(!0===e.capability?e.enable?e.enable(e.widget):e.widget.enable():e.disable?e.disable(e.widget):e.widget.disable())});"SUCCESS"===e.code&&this.emit(e.type,e.message)}addListener(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const s=Array.isArray(t)?t:[t],a=x();return s.forEach(t=>{e.addEventListener(t,n,i),this.allListeners.push({id:a,object:e,event:t,handler:n,options:i})}),()=>{this.allListeners=this.allListeners.filter(t=>t.id!==a||(e.removeEventListener(t.event,t.handler,t.options),!1))}}removeAllListeners(){this.allListeners.forEach(e=>{let{object:t,event:n,handler:i,options:s}=e;t.removeEventListener(n,i,s)}),this.allListeners.length=0}destroy(){var e;0!==this.webRTCWebsocket.readyState&&(this.removeAllListeners(),this.disconnect(),null===(e=this.peerConnectionStats)||void 0===e||e.destroy(),delete this.peerConnectionStats,delete this.video,delete this.wrapper,delete this.videoWrapper,delete this.root,delete this.stream)}}},{"./plugins/BasebandRIL":121,"./plugins/Battery":122,"./plugins/ButtonsEvents":123,"./plugins/Camera":124,"./plugins/Clipboard":125,"./plugins/CoordinateUtils":126,"./plugins/FileUpload":127,"./plugins/FingerPrint":128,"./plugins/Fullscreen":129,"./plugins/GPS":130,"./plugins/Gamepad":131,"./plugins/GamepadManager":132,"./plugins/IOThrottling":133,"./plugins/Identifiers":134,"./plugins/KeyboardEvents":135,"./plugins/KeyboardMapping":136,"./plugins/MediaManager":137,"./plugins/MouseEvents":138,"./plugins/MultiTouchEvents":139,"./plugins/Network":140,"./plugins/PeerConnectionStats":141,"./plugins/Phone":142,"./plugins/Screencast":143,"./plugins/StreamBitrate":144,"./plugins/StreamResolution":145,"./utils/helpers":153,loglevel:99}],119:[function(e,t,n){const i=e("./DeviceRenderer"),s=e("lodash/defaultsDeep"),a=e("./store"),c=e("./APIManager"),d=e("loglevel");d.setDefaultLevel("error");const l={template:"renderer",touch:!0,mouse:!0,volume:!0,rotation:!0,navbar:!0,power:!0,keyboard:!0,keyboardMapping:!0,fullscreen:!0,camera:!0,microphone:!1,fileUpload:!0,streamBitrate:!1,clipboard:!0,battery:!0,gps:!0,gpsSpeedSupport:!1,capture:!0,identifiers:!0,network:!0,mobilethrottling:!1,baseband:!1,phone:!0,streamResolution:!0,diskIO:!0,gamepad:!0,biometrics:!0,translateHomeKey:!1,token:"",i18n:{},stun:{urls:["stun:stun-eu.genymotion.com:80","stun:stun-eu.genymotion.com:443","stun:stun-eu.genymotion.com:3478","stun:stun-eu.genymotion.com:5349","stun:stun-na.genymotion.com:80","stun:stun-na.genymotion.com:443","stun:stun-na.genymotion.com:3478","stun:stun-na.genymotion.com:5349"]},connectionFailedURL:"",turn:{},giveFeedbackLink:"https://github.com/orgs/Genymobile/discussions"};t.exports=class DeviceRendererFactory{constructor(){this.instances=[],this.templates={bootstrap:{html:'<div class="gm-wrapper">    <div style="text-align: center" class="gm-video-wrapper embed-responsive embed-responsive-16by9">        <video class="gm-video embed-responsive-item" autoplay preload="none">            Your browser does not support the VIDEO tag        </video>    </div>    <div class="gm-toolbars">        <div class="gm-toolbar">            <ul></ul>        </div>    </div></div>',css:".gm_bootstrap .gm-video {    background: transparent;    background-size: contain;    background-position: center;    width: 99%;}.gm_bootstrap {    background-color: black;}.gm_bootstrap .gm-toolbars {    position: absolute;    width: 47px;    height: 100%;    top: 0;    right: 0;    margin: 0;}.gm_bootstrap .gm-toolbar {    position: absolute;    top: 5%;    right: 0;    margin: 0;}.gm_bootstrap li img {    margin: auto;}@media (min-width: 1200px) {    .gm_bootstrap li img {        width: 85%;    }}"},fullscreen:{html:'<a class="gm-fullscreen-message" href="#"> </a><div class="gm-wrapper hide">    <div class="gm-video-wrapper">        <video class="gm-video" autoplay preload="none">Your browser does not support the VIDEO tag</video>    </div>    <div class="gm-toolbars">        <div class="gm-toolbar">            <ul></ul>        </div>    </div></div><p class="gm-layout-fullwindow" hidden></p>',js:"",css:".gm-fullscreen {    position: absolute;    top: 0;    left: 0;    margin: 0;    padding: 0;    display: block;    width: 100%;    height: 97%;    background-color: black;}.gm-fullscreen .gm-fullscreen-message {    display: block;    padding: 0;    margin: 0;    height: 100%;    width: 100%;    background: white;    background-size: cover;}.gm-video .hide {    display: none;}.gm-fullscreen .gm-video {    background: transparent;    position: absolute;    top: 0;    left: 0;    width: 95%;    height: 100%;    padding: 0;}.gm-toolbars {    position: absolute;    top: 0;    right: 0;}"},fullwindow:{html:'<div class="gm-wrapper">    <div class="gm-video-wrapper">        <video class="gm-video" autoplay preload="none">Your browser does not support the VIDEO tag</video>    </div>    <div class="gm-toolbar">        <ul></ul>    </div></div><p class="gm-layout-fullwindow" hidden></p>',js:"",css:".gm_fullwindow {    position: absolute;    top: 0;    left: 0;    margin: 0;    padding: 0;    display: block;    width: 100%;    height: 97%;    min-height: 560px;    background-color: black;}.gm_fullwindow .gm-video {    background: transparent;    position: absolute;    top: 0;    left: 0;    width: calc(95% - 50px);    height: 100%;    padding: 0;}.gm_fullwindow .toolbar {    position: absolute;    top: 10px;    right: 0;    padding-right: 10px;    margin: 0;    width: 50px;}"},renderer:{html:'<div class="gm-wrapper">    <div class="device-renderer">        <div class="gm-video-wrapper">            <video class="gm-video" autoplay preload="none">Your browser does not support the VIDEO tag</video>        </div>        <div class="gm-toolbars">            <div class="gm-toolbar">                <ul></ul>            </div>        </div>    </div></div>',js:"",css:".gm-template-renderer .device-renderer {    position: relative;    border-collapse: separate;    border-radius: 3px;    padding: 40px 10px 40px 10px;    margin-left: auto;    margin-right: auto;    background-color: black;}.gm-template-renderer .gm-video {    background: transparent url('data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz48c3ZnIHdpZHRoPScxMjJweCcgaGVpZ2h0PScxMjJweCcgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB2aWV3Qm94PSIwIDAgMTAwIDEwMCIgcHJlc2VydmVBc3BlY3RSYXRpbz0ieE1pZFlNaWQiIGNsYXNzPSJ1aWwtcmluZyI+PHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEwMCIgaGVpZ2h0PSIxMDAiIGZpbGw9Im5vbmUiIGNsYXNzPSJiayI+PC9yZWN0PjxjaXJjbGUgY3g9IjUwIiBjeT0iNTAiIHI9IjQ1IiBzdHJva2UtZGFzaGFycmF5PSIxNTUuNTA4ODM2MzUyNjk0NzcgMTI3LjIzNDUwMjQ3MDM4NjYyIiBzdHJva2U9IiNFNjE5NUUiIGZpbGw9Im5vbmUiIHN0cm9rZS13aWR0aD0iMTAiPjxhbmltYXRlVHJhbnNmb3JtIGF0dHJpYnV0ZU5hbWU9InRyYW5zZm9ybSIgdHlwZT0icm90YXRlIiB2YWx1ZXM9IjAgNTAgNTA7MTgwIDUwIDUwOzM2MCA1MCA1MDsiIGtleVRpbWVzPSIwOzAuNTsxIiBkdXI9IjFzIiByZXBlYXRDb3VudD0iaW5kZWZpbml0ZSIgYmVnaW49IjBzIj48L2FuaW1hdGVUcmFuc2Zvcm0+PC9jaXJjbGU+PC9zdmc+') no-repeat center;    width: 1024px;    height: 600px;    margin-right: 60px;}.gm-template-renderer .gm-toolbars {    position: absolute;    top: 0;    right: 0;    width: 60px;}"},renderer_minimal:{html:'<div class="gm-wrapper">    <div class="gm-video-wrapper">        <video class="gm-video" autoplay preload="none">Your browser does not support the VIDEO tag</video>    </div>    <div class="gm-toolbar">        <ul></ul>    </div>    <span class="gm-version-number"></span></div>',js:"",css:".gm-template-renderer_minimal {    position: absolute;    top: 0;    left: 0;    margin: 0;    padding: 0;    display: block;    width: 100%;    height: 100%;    min-height: 560px;    background-color: black;}.gm-template-renderer_minimal .gm-video {    position: fixed;    top: 0;    left: 0;    width: calc(100vw - 57px);    height: 100vh;    padding: 0;    margin: 0;    background: transparent url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NCA2NCIgd2lkdGg9IjY0IiBoZWlnaHQ9IjY0IiBmaWxsPSJ3aGl0ZSI+CiAgPGNpcmNsZSB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNiAxNikiIGN4PSIwIiBjeT0iMTYiIHI9IjAiPiAKICAgIDxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9InIiIHZhbHVlcz0iMDsgNDsgMDsgMCIgZHVyPSIxLjJzIiByZXBlYXRDb3VudD0iaW5kZWZpbml0ZSIgYmVnaW49IjAiCiAgICAgIGtleXRpbWVzPSIwOzAuMjswLjc7MSIga2V5U3BsaW5lcz0iMC4yIDAuMiAwLjQgMC44OzAuMiAwLjYgMC40IDAuODswLjIgMC42IDAuNCAwLjgiIGNhbGNNb2RlPSJzcGxpbmUiIC8+CiAgPC9jaXJjbGU+CiAgPGNpcmNsZSB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzMiAxNikiIGN4PSIwIiBjeT0iMTYiIHI9IjAiPiAKICAgIDxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9InIiIHZhbHVlcz0iMDsgNDsgMDsgMCIgZHVyPSIxLjJzIiByZXBlYXRDb3VudD0iaW5kZWZpbml0ZSIgYmVnaW49IjAuMyIKICAgICAga2V5dGltZXM9IjA7MC4yOzAuNzsxIiBrZXlTcGxpbmVzPSIwLjIgMC4yIDAuNCAwLjg7MC4yIDAuNiAwLjQgMC44OzAuMiAwLjYgMC40IDAuOCIgY2FsY01vZGU9InNwbGluZSIgLz4KICA8L2NpcmNsZT4KICA8Y2lyY2xlIHRyYW5zZm9ybT0idHJhbnNsYXRlKDQ4IDE2KSIgY3g9IjAiIGN5PSIxNiIgcj0iMCI+IAogICAgPGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgdmFsdWVzPSIwOyA0OyAwOyAwIiBkdXI9IjEuMnMiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIiBiZWdpbj0iMC42IgogICAgICBrZXl0aW1lcz0iMDswLjI7MC43OzEiIGtleVNwbGluZXM9IjAuMiAwLjIgMC40IDAuODswLjIgMC42IDAuNCAwLjg7MC4yIDAuNiAwLjQgMC44IiBjYWxjTW9kZT0ic3BsaW5lIiAvPgogIDwvY2lyY2xlPgo8L3N2Zz4K') center no-repeat;    background-size: 40%;}.gm-template-renderer_minimal .gm-toolbar {    position: absolute;    top: 10px;    right: 0;    padding-right: 5px;    margin: 0;    width: 50px;}.gm-template-renderer_minimal .gm-version-number {    position: fixed;    right: 5px;    bottom: 5px;    z-index: 2;    color: white;}"},renderer_no_toolbar:{html:'<div class="gm-wrapper">    <div class="gm-video-wrapper">        <video class="gm-video" autoplay poster="src/assets/images/loader.svg" disablePictureInPicture>            Your browser does not support the VIDEO tag        </video>    </div></div>',js:"",css:".gm-template-renderer_no_toolbar {    position: absolute;    top: 0;    left: 0;    margin: 0;    padding: 0;    display: block;    width: 100%;    height: 100%;    min-height: 560px;    background-color: black;}.gm-template-renderer_no_toolbar .gm-video {    position: fixed;    top: 0;    left: 0;    width: 100%;    height: 100%;    padding: 0;    background: transparent url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NCA2NCIgd2lkdGg9IjY0IiBoZWlnaHQ9IjY0IiBmaWxsPSJ3aGl0ZSI+CiAgPGNpcmNsZSB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNiAxNikiIGN4PSIwIiBjeT0iMTYiIHI9IjAiPiAKICAgIDxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9InIiIHZhbHVlcz0iMDsgNDsgMDsgMCIgZHVyPSIxLjJzIiByZXBlYXRDb3VudD0iaW5kZWZpbml0ZSIgYmVnaW49IjAiCiAgICAgIGtleXRpbWVzPSIwOzAuMjswLjc7MSIga2V5U3BsaW5lcz0iMC4yIDAuMiAwLjQgMC44OzAuMiAwLjYgMC40IDAuODswLjIgMC42IDAuNCAwLjgiIGNhbGNNb2RlPSJzcGxpbmUiIC8+CiAgPC9jaXJjbGU+CiAgPGNpcmNsZSB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzMiAxNikiIGN4PSIwIiBjeT0iMTYiIHI9IjAiPiAKICAgIDxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9InIiIHZhbHVlcz0iMDsgNDsgMDsgMCIgZHVyPSIxLjJzIiByZXBlYXRDb3VudD0iaW5kZWZpbml0ZSIgYmVnaW49IjAuMyIKICAgICAga2V5dGltZXM9IjA7MC4yOzAuNzsxIiBrZXlTcGxpbmVzPSIwLjIgMC4yIDAuNCAwLjg7MC4yIDAuNiAwLjQgMC44OzAuMiAwLjYgMC40IDAuOCIgY2FsY01vZGU9InNwbGluZSIgLz4KICA8L2NpcmNsZT4KICA8Y2lyY2xlIHRyYW5zZm9ybT0idHJhbnNsYXRlKDQ4IDE2KSIgY3g9IjAiIGN5PSIxNiIgcj0iMCI+IAogICAgPGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgdmFsdWVzPSIwOyA0OyAwOyAwIiBkdXI9IjEuMnMiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIiBiZWdpbj0iMC42IgogICAgICBrZXl0aW1lcz0iMDswLjI7MC43OzEiIGtleVNwbGluZXM9IjAuMiAwLjIgMC40IDAuODswLjIgMC42IDAuNCAwLjg7MC4yIDAuNiAwLjQgMC44IiBjYWxjTW9kZT0ic3BsaW5lIiAvPgogIDwvY2lyY2xlPgo8L3N2Zz4K') center no-repeat;    background-size: 40%;}"},renderer_partial:{html:'<div class="gm-wrapper">    <div class="gm-video-wrapper">        <video class="gm-video" autoplay preload="none">Your browser does not support the VIDEO tag</video>    </div>    <div class="gm-toolbar">        <ul></ul>    </div>    <span class="gm-version-number"></span></div>',js:"",css:".gm-template-renderer_partial {    top: 0;    left: 0;    margin: 0;    padding: 0;    display: block;    min-height: 800px;    height: 100%;    background-color: black;}.gm-template-renderer_partial .gm-wrapper {    top: 0;    left: 0;    margin: 0;    padding: 0;    display: block;    width: 100%;    height: 100%;}.gm-template-renderer_partial .gm-video-wrapper {    position: relative;    top: 0;    left: 0;    margin: 0;    padding: 0;    display: block;    width: 100%;    height: 100%;}.gm-template-renderer_partial .gm-video {    position: relative;    top: 0;    left: 0;    width: calc(95% - 50px);    height: 100%;    padding: 0;    background: transparent url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NCA2NCIgd2lkdGg9IjY0IiBoZWlnaHQ9IjY0IiBmaWxsPSJ3aGl0ZSI+CiAgPGNpcmNsZSB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxNiAxNikiIGN4PSIwIiBjeT0iMTYiIHI9IjAiPiAKICAgIDxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9InIiIHZhbHVlcz0iMDsgNDsgMDsgMCIgZHVyPSIxLjJzIiByZXBlYXRDb3VudD0iaW5kZWZpbml0ZSIgYmVnaW49IjAiCiAgICAgIGtleXRpbWVzPSIwOzAuMjswLjc7MSIga2V5U3BsaW5lcz0iMC4yIDAuMiAwLjQgMC44OzAuMiAwLjYgMC40IDAuODswLjIgMC42IDAuNCAwLjgiIGNhbGNNb2RlPSJzcGxpbmUiIC8+CiAgPC9jaXJjbGU+CiAgPGNpcmNsZSB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzMiAxNikiIGN4PSIwIiBjeT0iMTYiIHI9IjAiPiAKICAgIDxhbmltYXRlIGF0dHJpYnV0ZU5hbWU9InIiIHZhbHVlcz0iMDsgNDsgMDsgMCIgZHVyPSIxLjJzIiByZXBlYXRDb3VudD0iaW5kZWZpbml0ZSIgYmVnaW49IjAuMyIKICAgICAga2V5dGltZXM9IjA7MC4yOzAuNzsxIiBrZXlTcGxpbmVzPSIwLjIgMC4yIDAuNCAwLjg7MC4yIDAuNiAwLjQgMC44OzAuMiAwLjYgMC40IDAuOCIgY2FsY01vZGU9InNwbGluZSIgLz4KICA8L2NpcmNsZT4KICA8Y2lyY2xlIHRyYW5zZm9ybT0idHJhbnNsYXRlKDQ4IDE2KSIgY3g9IjAiIGN5PSIxNiIgcj0iMCI+IAogICAgPGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgdmFsdWVzPSIwOyA0OyAwOyAwIiBkdXI9IjEuMnMiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIiBiZWdpbj0iMC42IgogICAgICBrZXl0aW1lcz0iMDswLjI7MC43OzEiIGtleVNwbGluZXM9IjAuMiAwLjIgMC40IDAuODswLjIgMC42IDAuNCAwLjg7MC4yIDAuNiAwLjQgMC44IiBjYWxjTW9kZT0ic3BsaW5lIiAvPgogIDwvY2lyY2xlPgo8L3N2Zz4K') center no-repeat;    background-size: 40%;}.gm-template-renderer_partial .gm-toolbar {    position: absolute;    top: 10px;    right: 0;    padding-right: 5px;    margin: 0;    width: 50px;}.gm-template-renderer_partial .gm-version-number {    position: fixed;    right: 5px;    bottom: 5px;    z-index: 2;    color: white;}@media only screen and (max-width: 650px) {    .gm-overlay {        left: auto;        width: calc(100vw - 100px);        right: 55px;        min-height: 0;    }}@media only screen and (min-width: 475px) {    .gm-click-to-unmute {        left: calc(50% - 190px) !important;    }}"}}}setupRenderer(e,t,n){let h=arguments.length>3&&void 0!==arguments[3]?arguments[3]:i;"string"==typeof e&&(e=document.getElementById(e)),void 0===n&&(n={}),(n=s(n,l)).webRTCUrl=t,n.buttons=n.volume||n.rotation||n.navbar||n.power,d.debug("Creating genymotion display on "+t),e.classList.add("device-renderer-instance"),e.classList.add("gm-template-"+n.template),document.body.classList.add("gm-template-"+n.template+"-body"),this.loadTemplate(e,this.templates[n.template],n);const p=new h(e,n);return a(p),p.apiManager=new c(p),this.instances.push(p),this.loadPlugins(p),p.onWebRTCReady(),p.apiManager.getExposedApiFunctions()}loadTemplate(e,t,n){const i=document.getElementsByTagName("head")[0],s="device-renderer-js-"+n.template,a="device-renderer-css-"+n.template;if(!document.getElementById(s)){const e=document.createElement("script");e.id=s,e.text=t.js,i.appendChild(e)}if(!document.getElementById(a)){const e=document.createElement("style");e.id=a,e.appendChild(document.createTextNode(t.css)),i.appendChild(e)}e.innerHTML=t.html}loadPlugins(e){const t=[];if("function"==typeof e.getPlugins){const n=e.getPlugins();Array.isArray(n)&&t.push(...n)}const n=new Map;t.forEach(t=>{const i=t.params||[];t.enabled&&(t.dependencies&&t.dependencies.forEach(t=>{n.has(t)||(new t(e),n.set(t,!0))}),t.class&&new t.class(e,...i))})}}},{"./APIManager":117,"./DeviceRenderer":118,"./store":152,"lodash/defaultsDeep":81,loglevel:99}],120:[function(e,t,n){const i=e("./DeviceRenderer"),s=e("./DeviceRendererFactory"),a=e("./plugins/CoordinateUtils"),c=e("./plugins/KeyboardEvents"),d=e("./plugins/MouseEvents"),l=e("./plugins/MediaManager"),h=e("./plugins/GamepadManager");t.exports={DeviceRenderer:i,DeviceRendererFactory:s,CoordinateUtils:a,KeyboardEvents:c,MouseEvents:d,MediaManager:l,GamepadManager:h}},{"./DeviceRenderer":118,"./DeviceRendererFactory":119,"./plugins/CoordinateUtils":126,"./plugins/GamepadManager":132,"./plugins/KeyboardEvents":135,"./plugins/MediaManager":137,"./plugins/MouseEvents":138}],121:[function(e,t,n){const i=e("./util/OverlayPlugin");t.exports=class BasebandRIL extends i{static get name(){return"BasebandRIL"}constructor(e,t,n){super(e),this.instance=e,this.instance.baseband=this,this.i18n=t||{},this.basebandEnabled=n,this.renderToolbarButton(),this.renderWidget(),this.instance.registerEventCallback("baseband",e=>{this.handleBasebandEvent(e)})}handleBasebandEvent(e){const t=e.split(" ");t.length<3||("network"===t[0]&&"operator"===t[1]&&(this.networkOperatorMMC.value=t[2]),"network"===t[0]&&"operator_name"===t[1]&&(this.networkOperatorName.value=t.slice(2).join(" ")),"sim"===t[0]&&"operator"===t[1]&&(this.simOperatorMMC.value=t[2]),"sim"===t[0]&&"operator_name"===t[1]&&(this.simOperatorName.value=t.slice(2).join(" ")),"sim"===t[0]&&"imsi_id"===t[1]&&(this.simMSIN.value=t[2]),"sim"===t[0]&&"phone_number"===t[1]&&(this.simOperatorPhoneNumber.value=t[2]))}renderToolbarButton(){const e=this.instance.getChildByClass(this.instance.root,"gm-toolbar");if(!e)return;const t=e.children[0];this.toolbarBtn=document.createElement("li"),this.toolbarBtnImage=document.createElement("div"),this.toolbarBtnImage.className="gm-icon-button gm-sim-button",this.toolbarBtnImage.title=this.i18n.BASEBAND_TITLE||"Baseband",this.toolbarBtn.appendChild(this.toolbarBtnImage),this.toolbarBtn.onclick=this.toggleWidget.bind(this),t.appendChild(this.toolbarBtn)}renderWidget(){this.widget=document.createElement("div"),this.form=document.createElement("form");const e=document.createElement("div");if(e.className="gm-title",e.innerHTML=this.i18n.BASEBAND_TITLE||"Baseband",this.form.appendChild(e),this.basebandEnabled){this.networkOperator=document.createElement("div");const e=document.createElement("div");e.className="gm-section";const t=document.createElement("label");t.innerHTML=this.i18n.NETWORK_OPERATOR||"Network Operator",e.appendChild(t);const n=document.createElement("div");n.className="gm-fields";const i=document.createElement("label");i.innerHTML="MCC/MNC",this.networkOperatorMMC=document.createElement("input"),this.networkOperatorMMC.className="gm-network-network-mmc",this.networkOperatorMMC.placeholder="eg: 20814",this.networkOperatorMMC.pattern="[0-9]{5,6}",this.networkOperatorMMC.title="Operator MCC/MNC",n.appendChild(i),n.appendChild(this.networkOperatorMMC);const s=document.createElement("div");s.className="gm-fields";const a=document.createElement("label");a.innerHTML="Name",this.networkOperatorName=document.createElement("input"),this.networkOperatorName.className="gm-network-network-name",this.networkOperatorName.placeholder="eg: Verizon",this.networkOperatorName.title="Operator Name",s.appendChild(a),s.appendChild(this.networkOperatorName),this.networkOperator.appendChild(e),this.networkOperator.appendChild(n),this.networkOperator.appendChild(s),this.simOperator=document.createElement("div");const c=document.createElement("div");c.className="gm-section";const d=document.createElement("label");d.innerHTML=this.i18n.NETWORK_SIM_OPERATOR||"SIM Operator",c.appendChild(d);const l=document.createElement("div");l.className="gm-fields";const h=document.createElement("label");h.innerHTML="MCC/MNC",this.simOperatorMMC=document.createElement("input"),this.simOperatorMMC.className="gm-network-sim-mmc",this.simOperatorMMC.placeholder="eg: 20814",this.simOperatorMMC.pattern="[0-9]{5,6}",this.simOperatorMMC.title="SIM Operator MCC/MNC",this.instance.addListener(this.simOperatorMMC,"keyup",this.checkSimImsiErrors.bind(this)),l.appendChild(h),l.appendChild(this.simOperatorMMC);const p=document.createElement("div");p.className="gm-fields";const u=document.createElement("label");u.innerHTML="Name",this.simOperatorName=document.createElement("input"),this.simOperatorName.className="gm-network-sim-name",this.simOperatorName.placeholder="eg: AT&T",this.simOperatorName.title="SIM Operator Name",p.appendChild(u),p.appendChild(this.simOperatorName);const m=document.createElement("div");m.className="gm-fields";const g=document.createElement("label");g.innerHTML="MSIN",this.simMSIN=document.createElement("input"),this.simMSIN.className="gm-network-sim-msin",this.simMSIN.placeholder="eg: 2176510739",this.simMSIN.pattern="[0-9]{9,10}",this.simMSIN.title="SIM MSIN",this.instance.addListener(this.simMSIN,"keyup",this.checkSimImsiErrors.bind(this)),m.appendChild(g),m.appendChild(this.simMSIN);const v=document.createElement("div");v.className="gm-fields";const f=document.createElement("label");f.innerHTML="Phone Number",this.simOperatorPhoneNumber=document.createElement("input"),this.simOperatorPhoneNumber.className="gm-network-sim-phone",this.simOperatorPhoneNumber.placeholder="eg: 8004337300",this.simOperatorPhoneNumber.pattern="[0-9]*",this.simOperatorPhoneNumber.title="Phone Number",v.appendChild(f),v.appendChild(this.simOperatorPhoneNumber),this.simOperator.appendChild(c),this.simOperator.appendChild(l),this.simOperator.appendChild(m),this.simOperator.appendChild(p),this.simOperator.appendChild(v)}this.submitBtn=document.createElement("button"),this.submitBtn.className="gm-network-update",this.submitBtn.innerHTML=this.i18n.NETWORK_UPDATE||"Update",this.submitBtn.onclick=this.sendDataToInstance.bind(this),this.basebandEnabled&&(this.form.appendChild(this.networkOperator),this.form.appendChild(this.simOperator)),this.form.appendChild(this.submitBtn),this.widget.className="gm-overlay gm-baseband-plugin gm-hidden";const t=document.createElement("div");t.className="gm-close-btn",t.onclick=this.toggleWidget.bind(this),this.widget.appendChild(t),this.widget.appendChild(this.form),this.instance.root.appendChild(this.widget)}checkSimImsiErrors(){this.simMSIN.setCustomValidity(""),this.simOperatorMMC.value.length>0&&this.simMSIN.value.length>0&&(6===this.simOperatorMMC.value.length&&9!==this.simMSIN.value.length?this.simMSIN.setCustomValidity("Should be 9"):5===this.simOperatorMMC.value.length&&10!==this.simMSIN.value.length&&this.simMSIN.setCustomValidity("Should be 10"))}sendDataToInstance(e){if(e.preventDefault(),!this.form.checkValidity())return;const t=[];if(this.basebandEnabled&&(this.networkOperatorMMC.value&&t.push("network operator "+this.networkOperatorMMC.value),this.networkOperatorName.value&&t.push("network operator_name "+this.networkOperatorName.value),this.simOperatorMMC.value&&t.push("sim operator "+this.simOperatorMMC.value),this.simOperatorName.value&&t.push("sim operator_name "+this.simOperatorName.value),this.simMSIN.value&&t.push("sim imsi_id "+this.simMSIN.value),this.simOperatorPhoneNumber.value&&t.push("sim phone_number "+this.simOperatorPhoneNumber.value),t.length>0)){const e={channel:"baseband",messages:t};this.instance.sendEvent(e)}this.instance.store.dispatch({type:"OVERLAY_OPEN",payload:{overlayID:this.overlayID,toOpen:!1}})}}},{"./util/OverlayPlugin":146}],122:[function(e,t,n){const i=e("./util/OverlayPlugin");t.exports=class Battery extends i{static get name(){return"Battery"}constructor(e,t){super(e),this.instance=e,this.i18n=t||{},this.instance.battery=this,this.renderToolbarButton(),this.renderWidget(),this.instance.registerEventCallback("battery",e=>{const t=e.split(" ").splice(-2);2===t.length&&(this.updateUIBatteryChargingState("discharging"!==t[0]),this.onBatteryLevelChange(t[1]))})}renderToolbarButton(){const e=this.instance.getChildByClass(this.instance.root,"gm-toolbar");if(!e)return;const t=e.children[0];this.toolbarBtn=document.createElement("li"),this.toolbarBtnImage=document.createElement("div"),this.toolbarBtnImage.className="gm-icon-button gm-battery-button",this.toolbarBtnImage.title=this.i18n.BATTERY_TITLE||"Battery",this.toolbarBtn.appendChild(this.toolbarBtnImage),this.toolbarBtn.onclick=this.toggleWidget.bind(this),t.appendChild(this.toolbarBtn)}renderWidget(){this.widget=document.createElement("div"),this.container=document.createElement("div");const e=document.createElement("div");e.className="gm-title",e.innerHTML=this.i18n.BATTERY_TITLE||"Battery",this.container.appendChild(e);const t=document.createElement("div");t.className="gm-inputs";const n=this.i18n.BATTERY_CHARGE_LEVEL||"Charge level";t.innerHTML="<label>"+n+"</label>",t.appendChild(this.createLevelSection());const i=document.createElement("label");i.innerHTML=this.i18n.BATTERY_CHARGE_STATE||"State of charge",t.appendChild(i),t.appendChild(this.createChargingSection()),this.container.appendChild(t),this.widget.className="gm-overlay gm-battery-plugin gm-hidden";const s=document.createElement("div");s.onclick=this.toggleWidget.bind(this),s.className="gm-close-btn",this.widget.appendChild(s),this.widget.appendChild(this.container),this.instance.root.appendChild(this.widget)}createChargingSection(){const e=document.createElement("div");return this.chargingInput=document.createElement("input"),this.chargingStatus=document.createElement("div"),e.className="gm-charging-group",this.chargingInput.type="checkbox",this.chargingInput.className="gm-charging-checkbox",this.chargingInput.onchange=this.toggleChargingState.bind(this),this.chargingInput.checked=!0,this.chargingStatus.className="gm-charging-status",this.chargingStatus.innerHTML="Discharging",e.appendChild(this.chargingInput),e.appendChild(this.chargingStatus),e}createLevelSection(){const e=document.createElement("div");e.className="gm-charge-level-group";const t=document.createElement("div");this.chargeInput=document.createElement("input");const n=document.createElement("span");n.innerHTML="%",this.chargeInput.className="gm-charge-input",this.chargeInput.type="number",this.chargeInput.value=50,this.chargeInput.max=100,this.chargeInput.min=0,this.chargeInput.step=1,this.chargeInput.oninput=this.onBatteryLevelChangeEvent.bind(this),t.appendChild(this.chargeInput),t.appendChild(n),e.appendChild(t);const i=document.createElement("div");this.chargeSlider=document.createElement("input"),this.chargeSlider.className="gm-charge-slider",this.chargeSlider.type="range",this.chargeSlider.orient="vertical",this.chargeSlider.max=100,this.chargeSlider.min=0,this.chargeSlider.step=1,this.chargeSlider.value=50,this.chargeSlider.onchange=this.onBatteryLevelChangeEvent.bind(this),i.appendChild(this.chargeSlider),e.appendChild(i);const s=document.createElement("div");return this.chargeImage=document.createElement("div"),this.chargeImageOverlay=document.createElement("div"),this.chargeImage.className="gm-charge-image",this.chargeImageOverlay.className="gm-charge-image-overlay",this.chargeImageOverlay.style.cssText="height: 40%;",s.appendChild(this.chargeImage),this.chargeImage.appendChild(this.chargeImageOverlay),e.appendChild(s),e}toggleChargingState(){this.chargingStatus.classList.toggle("charging");const e=this.i18n.BATTERY_CHARGING||"Charging",t=this.i18n.BATTERY_DISCHARGING||"Discharging";this.chargingStatus.innerHTML=this.chargingInput.checked?e:t,this.sendDataToInstance()}updateUIBatteryChargingState(e){this.chargingInput.checked=e,this.chargingStatus.classList[e?"add":"remove"]("charging");const t=this.i18n.BATTERY_CHARGING||"Charging",n=this.i18n.BATTERY_DISCHARGING||"Discharging";this.chargingStatus.innerHTML=e?t:n}onBatteryLevelChangeEvent(e){const t=Number(e.target.value);this.onBatteryLevelChange(t)&&this.sendDataToInstance()}onBatteryLevelChange(e){return e=Number(e),!Number.isNaN(e)&&(e=Math.min(Math.max(0,e),100),this.chargeSlider.value=e,this.chargeInput.value=e,this.chargeImageOverlay.style.cssText="height: "+(.7*e+4)+"%;",!0)}sendDataToInstance(){const e={channel:"battery",messages:["set state level "+Number(this.chargeInput.value),"set state status "+(this.chargingInput.checked?"charging":"discharging")]};this.instance.sendEvent(e)}}},{"./util/OverlayPlugin":146}],123:[function(e,t,n){t.exports=class ButtonsEvents{constructor(e,t,n){this.instance=e,this.translateHomeKey=n,this.instance.buttonsEvents=this,this.instance.options.rotation&&this.renderToolbarButton("gm-rotation","gm-rotate",t.BUTTONS_ROTATE||"Rotate",!1),this.instance.options.volume&&(this.renderToolbarButton("0x01000070","gm-sound-down",t.BUTTONS_SOUND_DOWN||"Sound down",!1),this.renderToolbarButton("0x01000072","gm-sound-up",t.BUTTONS_SOUND_UP||"Sound up",!1)),this.instance.options.navbar&&(this.renderToolbarButton("0x010000be","gm-recent",t.BUTTONS_RECENT_APPS||"Recent applications",!0),this.renderToolbarButton("0x01000010","gm-home",t.BUTTONS_HOME||"Home",!0),this.renderToolbarButton("0x01000061","gm-back",t.BUTTONS_BACK||"Back",!0)),this.instance.options.power&&this.renderToolbarButton("0x0100010b","gm-power",t.BUTTONS_POWER||"Power",!0);const i=document.getElementsByClassName("gm-icon-button");for(let e=0;e<i.length;e++){const t=i[e];t.onmousedown=this.mouseButtonPressEvent.bind(this),t.onmouseup=this.mouseButtonReleaseEvent.bind(this)}}keyPressEvent(e,t){const n={type:"KEYBOARD_PRESS",keychar:t,keycode:e};this.instance.sendEvent(n)}keyReleaseEvent(e,t){const n={type:"KEYBOARD_RELEASE",keychar:t,keycode:e};this.instance.sendEvent(n)}mouseButtonPressEvent(e){const t=e.target.classList[1];if(t)if("0x01000010"===t&&this.translateHomeKey)this.keyPressEvent(parseInt("0x01000022"),""),this.keyPressEvent(parseInt("0x01000005"),"");else if("0x"===t.substring(0,2)){const e=parseInt(t,16);this.keyPressEvent(e,"0\n")}}mouseButtonReleaseEvent(e){const t=e.target.classList[1];if(t)if("0x01000010"===t&&this.translateHomeKey)this.keyReleaseEvent(parseInt("0x01000005"),""),this.keyReleaseEvent(parseInt("0x01000022"),"");else if("gm-rotation"===t){const e={type:"ROTATE"};this.instance.sendEvent(e)}else if("0x"===t.substring(0,2)){const e=parseInt(t,16);this.keyReleaseEvent(e,"0\n")}}getButtonState(e){const t=this.instance.getChildByClass(this.instance.root,e),n=t.parentNode;return{image:{className:t.className},button:{className:n.className,onclick:n.onclick}}}setButtonState(e,t){const n=this.instance.getChildByClass(this.instance.root,e),i=n.parentNode;n.className=t.image.className,i.className=t.button.className,i.onclick=t.button.onclick}disableRotation(){if(!this.instance.getChildByClass(this.instance.root,"gm-rotate"))return;this.savedRotationState||(this.savedRotationState=this.getButtonState("gm-rotate"));const e=this.instance.getChildByClass(this.instance.root,"gm-rotate"),t=e.parentNode;t.className+=" gm-disabled-widget-pop-up",e.className+=" gm-disabled-widget-icon",t.onclick=null}enableRotation(){this.instance.getChildByClass(this.instance.root,"gm-rotate")&&this.savedRotationState&&(this.setButtonState("gm-rotate",this.savedRotationState),this.savedRotationState=null)}renderToolbarButton(e,t,n,i){const s=this.instance.getChildByClass(this.instance.root,"gm-toolbar");if(!s)return;const a=s.children[0],c=document.createElement("li"),d=document.createElement("div");d.classList.add("gm-icon-button"),d.classList.add(e),d.classList.add(t),d.title=n,c.appendChild(d),i?a.appendChild(c):a.insertBefore(c,a.firstChild)}}},{}],124:[function(e,t,n){const i=e("webrtc-adapter"),s=e("./util/OverlayPlugin");e("loglevel").setDefaultLevel("error"),t.exports=class Camera extends s{static get name(){return"Camera"}constructor(e,t){super(e),this.instance=e,this.i18n=t||{},this.instance.camera=this,this.renderToolbarButton()}renderToolbarButton(){const e=this.instance.getChildByClass(this.instance.root,"gm-toolbar");if(!e)return;const t=e.children[0];if(this.toolbarBtn=document.createElement("li"),this.toolbarBtnImage=document.createElement("div"),this.instance.options.microphone?(this.toolbarBtnImage.className="gm-icon-button gm-camera-mic-button",this.toolbarBtnImage.title=this.i18n.CAMERA_TITLE||"Camera and microphone injection"):(this.toolbarBtnImage.className="gm-icon-button gm-camera-button",this.toolbarBtnImage.title=this.i18n.CAMERA_TITLE||"Camera injection"),this.toolbarBtn.appendChild(this.toolbarBtnImage),t.appendChild(this.toolbarBtn),"safari"===i.default.browserDetails.browser)this.toolbarBtn.className+=" gm-disabled-widget-pop-up",this.toolbarBtnImage.className+=" gm-disabled-widget-icon";else{const toggleVideoStreaming=()=>this.instance.mediaManager.toggleVideoStreaming();this.instance.addListener(this.toolbarBtn,"click",toggleVideoStreaming)}}}},{"./util/OverlayPlugin":146,loglevel:99,"webrtc-adapter":102}],125:[function(e,t,n){const i=e("./util/OverlayPlugin"),s=e("loglevel");s.setDefaultLevel("error"),t.exports=class Clipboard extends i{static get name(){return"Clipboard"}constructor(e,t){super(e),this.instance=e,this.i18n=t||{},this.instance.clipboard=this,this.clipboard="",this.renderToolbarButton(),this.renderWidget(),this.instance.registerEventCallback("framework",e=>{const t=e.split(" ");if(3===t.length&&"clipboard"===t[0])try{this.clipboard=decodeURIComponent(escape(window.atob(t[2])))}catch(e){s.warn("Malformed clipboard content")}})}renderToolbarButton(){const e=this.instance.getChildByClass(this.instance.root,"gm-toolbar");if(!e)return;const t=e.children[0];this.toolbarBtn=document.createElement("li"),this.toolbarBtnImage=document.createElement("div"),this.toolbarBtnImage.className="gm-icon-button gm-clipboard-button",this.toolbarBtnImage.title=this.i18n.CLIPBOARD_TITLE||"Clipboard",this.toolbarBtn.appendChild(this.toolbarBtnImage),this.toolbarBtn.onclick=this.toggleWidget.bind(this),t.appendChild(this.toolbarBtn)}renderWidget(){this.widget=document.createElement("div"),this.container=document.createElement("div");const e=document.createElement("div");e.className="gm-title",e.innerHTML=this.i18n.CLIPBOARD_TITLE||"Device Clipboard",this.container.appendChild(e),this.clipboardInput=document.createElement("textarea"),this.clipboardInput.className="gm-clipboard-input",this.container.appendChild(this.clipboardInput),this.widget.className="gm-overlay gm-clipboard-plugin gm-hidden";const t=document.createElement("div");t.className="gm-close-btn",t.onclick=this.toggleWidget.bind(this),this.widget.appendChild(t),this.widget.appendChild(this.container),this.widget.onclose=()=>{this.clipboard=this.clipboardInput.value,this.sendDataToInstance()},this.instance.root.appendChild(this.widget)}toggleWidget(){super.toggleWidget(),this.instance.store.getters.isWidgetOpened(this.overlayID)&&(this.clipboardInput.value=this.clipboard,this.clipboardInput.focus())}copyInstanceClipboardToClient(e,t){try{navigator.clipboard.writeText(this.clipboardInput.value)}catch(t){e.focus(),e.select(),document.execCommand("copy")}t.classList.remove("gm-invisible"),t.classList.remove("gm-hidden"),setTimeout(()=>{t.classList.add("gm-invisible"),setTimeout(()=>{t.classList.add("gm-hidden")},500)},2e3)}sendDataToInstance(){const e={channel:"framework",messages:["set_device_clipboard "+window.btoa(unescape(encodeURIComponent(this.clipboard)))]};this.instance.sendEvent(e)}}},{"./util/OverlayPlugin":146,loglevel:99}],126:[function(e,t,n){t.exports=class CoordinateUtils{constructor(e){this.instance=e,this.instance.coordinateUtils=this,this.video=this.instance.video}setVideoElement(){this.video=this.instance.video}hasLeftAndRightBorders(){return this.video.offsetWidth/this.video.offsetHeight>this.video.videoWidth/this.video.videoHeight}hasSameOrientation(){return this.video.videoWidth/this.video.videoHeight>1&&this.video.offsetWidth/this.video.offsetHeight>1||this.video.videoWidth/this.video.videoHeight<1&&this.video.offsetWidth/this.video.offsetHeight<1}getCumulativeOffset(e){let t=0,n=0;do{t+=e.offsetTop||0,n+=e.offsetLeft||0,e=e.offsetParent}while(e);return{top:t,left:n}}getRawXCoordinateFromEvent(e){return void 0!==e.pageX?void 0!==e.offsetX?e.offsetX:e.pageX-this.getCumulativeOffset(this.video).left:e.clientX-this.getCumulativeOffset(this.video).left}getRawYCoordinateFromEvent(e){return void 0!==e.pageY?void 0!==e.offsetY?e.offsetY:e.pageY-this.getCumulativeOffset(this.video).top:e.clientY-this.getCumulativeOffset(this.video).top}getXCoordinate(e){this.instance.root.focus(),this.setVideoElement();const t=this.getRawXCoordinateFromEvent(e)-this.getLeftBorder();return Math.round(t*this.getXRatio())}getYCoordinate(e){this.setVideoElement();const t=this.getRawYCoordinateFromEvent(e)-this.getTopBorder();return Math.round(t*this.getYRatio())}getXRatio(){let e;if(this.hasSameOrientation())return this.hasLeftAndRightBorders()?(e=this.video.videoWidth/this.video.videoHeight*this.video.offsetHeight,this.video.videoWidth/e):this.video.videoWidth/this.video.offsetWidth;if(this.hasLeftAndRightBorders())return e=this.video.videoWidth/this.video.videoHeight*this.video.offsetHeight,this.video.videoWidth/e;const t=this.video.videoHeight/this.video.videoWidth*this.video.offsetWidth;return this.video.videoHeight/t}getYRatio(){let e,t;return this.hasSameOrientation()?this.hasLeftAndRightBorders()?this.video.videoHeight/this.video.offsetHeight:(t=this.video.videoHeight/this.video.videoWidth*this.video.offsetWidth,this.video.videoHeight/t):this.hasLeftAndRightBorders()?(e=this.video.videoWidth/this.video.videoHeight*this.video.offsetHeight,this.video.videoWidth/e):(t=this.video.videoHeight/this.video.videoWidth*this.video.offsetWidth,this.video.videoHeight/t)}getTopBorder(){if(this.setVideoElement(),this.hasLeftAndRightBorders())return 0;const e=this.video.videoHeight/this.video.videoWidth*this.video.offsetWidth;return(this.video.offsetHeight-e)/2}getLeftBorder(){if(this.setVideoElement(),!this.hasLeftAndRightBorders())return 0;const e=this.video.videoWidth/this.video.videoHeight*this.video.offsetHeight;return(this.video.offsetWidth-e)/2}calculateCoorFromPercent(e,t){const n=this.instance.video.getBoundingClientRect(),i=e/100*n.width*this.instance.coordinateUtils.getXRatio(),s=t/100*(n.height-2*this.instance.coordinateUtils.getTopBorder())*this.instance.coordinateUtils.getYRatio();return{x:Math.floor(i),y:Math.floor(s)}}calculateCoorToPercent(e,t){const n=this.instance.video.getBoundingClientRect(),i=100/(n.width*this.instance.coordinateUtils.getXRatio()/e),s=100/((n.height-2*this.instance.coordinateUtils.getTopBorder())*this.instance.coordinateUtils.getYRatio()/t);return{x:Math.round(i),y:Math.round(s)}}}},{}],127:[function(e,t,n){const i=e("./util/OverlayPlugin"),s=2*Math.PI,a=Math.PI/2;t.exports=class FileUpload extends i{static get name(){return"FileUpload"}constructor(t,n){if(super(t),this.instance=t,this.i18n=n||{},this.instance.fileUpload=this,this.root=this.instance.videoWrapper,this.stepper={},this.currentStep="homeScreen",this.isUploading=!1,this.hasError=!1,this.flashing=!1,this.canvasContext=null,this.opengappsInstalled=!1,this.capabilityAvailable=!1,window.Worker){let t=e("../worker/FileUploaderWorker");t=t.toString().match(/^\s*function\s*\(\s*\)\s*\{(([\s\S](?!\}$))*[\s\S])/)[1];const n=new Blob([t],{type:"application/javascript"});this.loaderWorker=new Worker(URL.createObjectURL(n)),this.loaderWorker.onmessage=e=>{const t=e.data;switch(t.code){case"SUCCESS":this.onUploadSuccess();break;case"FAIL":this.onUploadFailure();break;case"PROGRESS":this.setUploadProgress(t.value)}}}this.root.ondragenter=e=>{e.stopPropagation(),e.preventDefault()},this.root.ondragover=e=>{e.stopPropagation(),e.preventDefault()},this.root.ondragleave=e=>{e.stopPropagation(),e.preventDefault()},this.root.ondrop=e=>{e.stopPropagation(),e.preventDefault(),this.isUploading||this.upload(e.dataTransfer.files)},this.createStepper(),this.renderToolbarButton(),this.renderWidget(),this.instance.registerEventCallback("systempatcher",e=>{const t=e.split(/ (.+)/);"status"===t[0]?this.onSystemPatcherStatusEvent(t[1]):"last_result"===t[0]&&this.onSystemPatcherLastResultEvent(t[1])})}renderToolbarButton(){const e=this.instance.getChildByClass(this.instance.root,"gm-toolbar");if(!e)return;const t=e.children[0],n=document.createElement("li");this.toolbarBtnImage=document.createElement("div"),this.toolbarBtnImage.className="gm-icon-button gm-uploader-button",this.toolbarBtnImage.title=this.i18n.UPLOADER_TITLE||"File upload",n.appendChild(this.toolbarBtnImage),n.onclick=this.toggleWidget.bind(this),t.appendChild(n)}renderWidget(){this.widget=document.createElement("div"),this.container=document.createElement("div"),this.title=document.createElement("div"),this.title.className="gm-title",this.container.appendChild(this.title),this.inputs=document.createElement("div"),this.inputs.className="gm-uploader-content",this.container.appendChild(this.inputs),this.widget.className="gm-overlay gm-uploader-plugin gm-hidden";const e=document.createElement("div");e.className="gm-close-btn",e.onclick=this.toggleWidget.bind(this),this.widget.appendChild(e),this.widget.appendChild(this.container),this.instance.root.appendChild(this.widget)}toggleWidget(){if(super.toggleWidget(),this.instance.store.getters.isWidgetOpened(this.overlayID)){if(this.displayStep(this.currentStep),"uploadScreen"===this.currentStep){const e={channel:"systempatcher",messages:["notify status"]};this.instance.sendEvent(e)}}else"successScreen"!==this.currentStep&&"errorScreen"!==this.currentStep||(this.currentStep="homeScreen")}upload(e){if(e.length<=0)return;this.createUploadProgressCanvas(),this.setUploadProgress(0);const t={type:"upload",file:e[0]};this.loaderWorker.postMessage(t),this.isUploading=!0,this.hasError=!1}onUploadSuccess(){this.isUploading=!1,this.canvasContext.putImageData(this.canvasImageData,0,0),this.canvasContext.fillText("✓",30,80),this.canvasContext.stroke(),setTimeout(()=>{this.canvasContext.putImageData(this.canvasImageData,0,0)},750)}onUploadFailure(){this.isUploading=!1,this.hasError=!0}setUploadProgress(e,t){this.hasError||this.drawProgress(e,t)}onSystemPatcherStatusEvent(e){const t=document.getElementsByClassName("gm-upload-in-progress-txt-percent")[0],n=document.getElementsByClassName("gm-upload-in-progress-txt-progress")[0],i=document.getElementsByClassName("gm-upload-in-progress-percent")[0],s=e.split(" ");if("downloading"===s[0]&&s.length>=3&&t&&n&&i){const e=parseInt(s[1]),a=parseInt(s[2]);if(0===a||Number.isNaN(a))return;const c=Math.round(100*e/a);t.innerHTML=c+"%",i.style.width=c+"%";const d=1048576,l="Downloading "+Math.round(10*e/d)/10+" Mb/"+Math.round(10*a/d)/10+" Mb";n.innerHTML=l}else if("installing"===s[0]&&n)n.innerHTML=this.i18n.UPLOADER_INSTALLING||"Installing...";else if("ready"===s[0]&&s.length>=2){if(-1!==s[1].indexOf("opengapps")&&this.updateOpenGAppsStatus(!0),!this.flashing)return;const e={channel:"systempatcher",messages:["notify last_result"]};this.instance.sendEvent(e)}}onSystemPatcherLastResultEvent(e){switch(e){case"success":this.displayStep("successScreen"),this.flashing&&!this.instance.store.getters.isWidgetOpened(this.overlayID)&&this.toggleWidget(),this.flashing=!1,this.instance.store.dispatch({type:"ADD_TRACKED_EVENT",payload:{category:"opengapps",action:"installed"}});break;case"unavailable":case"network_error":case"corrupted_archive":case"install_error":this.displayStep("errorScreen"),this.flashing&&!this.instance.store.getters.isWidgetOpened(this.overlayID)&&this.toggleWidget(),this.flashing=!1}}createUploadProgressCanvas(){if(this.canvasContext)return;const e=document.createElement("canvas");e.classList.add("gm-upload-progress"),e.width=120,e.height=120,this.instance.wrapper.insertBefore(e,this.instance.wrapper.firstChild),this.canvasContext=e.getContext("2d"),this.canvasImageData=null,this.canvasContext.beginPath(),this.canvasContext.strokeStyle="#E6195E",this.canvasContext.fillStyle="#E6195E",this.canvasContext.lineCap="square",this.canvasContext.font="bold 60px Arial",this.canvasContext.lineWidth=10,this.canvasContext.closePath(),this.canvasContext.fill(),this.canvasImageData=this.canvasContext.getImageData(0,0,120,120)}drawProgress(e,t){t=void 0!==t?t:"#E6195E",this.canvasContext.strokeStyle=t,this.canvasContext.fillStyle=t,this.canvasContext.putImageData(this.canvasImageData,0,0),this.canvasContext.beginPath(),this.canvasContext.arc(60,60,55,-a,s*e-a,!1);const n=100!==(e=Math.round(100*e))?e:"99";this.canvasContext.fillText(n,25,80),this.canvasContext.stroke()}createStepper(){this.stepper.homeScreen=this.createHomeScreen.bind(this),this.stepper.disclaimerScreen=this.createDisclaimerScreen.bind(this),this.stepper.uploadScreen=this.createUploadScreen.bind(this),this.stepper.successScreen=this.createSuccessStep.bind(this),this.stepper.errorScreen=this.createErrorStep.bind(this)}displayStep(e){this.currentStep=e,this.inputs.innerHTML="";const t=this.stepper[e]();this.title.innerHTML=t.title,this.inputs.appendChild(t.body)}setAvailability(e){this.capabilityAvailable=e}createHomeScreen(){const e=document.createElement("div"),t=document.createElement("div");t.className="gm-upload-main",t.appendChild(this.createIconDiv("gm-upload-main-img")),t.appendChild(this.createTextDiv("gm-upload-main-txt","<p>You can install Open GApps, or upload a file: APK files will be installed, flashable archives will be flashed, and other files types will be pushed to the /sdcard/download folder on the device.</p>")),e.appendChild(t),this.uploader=document.createElement("input"),this.uploader.className="gm-uploader-file",this.uploader.type="file",this.uploader.setAttribute("gm-hidden",""),e.appendChild(this.uploader),this.uploader.onchange=()=>{this.isUploading||(this.toggleWidget(),this.upload(this.uploader.files))};const n=document.createElement("div");n.className="gm-upload-main-bottom-buttons";const i=this.createButtonsGroup("Install Open GApps",e=>{e.preventDefault(),!1===this.opengappsInstalled&&this.capabilityAvailable&&this.displayStep("disclaimerScreen")},"Browse",e=>{e.preventDefault(),this.uploader.click()});return this.installButton=i[0],this.updateOpenGAppsStatus(this.opengappsInstalled),n.appendChild(i[0]),n.appendChild(i[1]),e.appendChild(n),{body:e,title:this.i18n.UPLOADER_HOME_TITLE||"Upload file to the virtual device"}}updateOpenGAppsStatus(e){if(this.opengappsInstalled=e,this.installButton)return this.capabilityAvailable?void(e?(this.installButton.className="gm-upload-main-bottom-buttons-left gm-dont-close gm-uploader-install-opengapps gm-upload-main-bottom-buttons-disabled",this.installButton.innerHTML="Open GApps installed",this.installButton.title="Open GApps are already installed"):(this.installButton.className="gm-upload-main-bottom-buttons-left gm-dont-close gm-uploader-install-opengapps",this.installButton.innerHTML="Install Open GApps",this.installButton.title="Install Open GApps")):(this.installButton.className="gm-upload-main-bottom-buttons-left gm-dont-close gm-uploader-install-opengapps gm-upload-main-bottom-buttons-disabled",this.installButton.innerHTML="Install Open GApps",void(this.installButton.title="Open GApps are not available for this virtual device"))}createDisclaimerScreen(){const e=document.createElement("div"),t=document.createElement("div");t.className="gm-upload-disclaimer",t.appendChild(this.createTextDiv("gm-upload-disclaimer-txt","<p>PLEASE NOTE<br/>        GENYMOBILE INC., ASSUMES NO LIABILITY WHATSOEVER RESULTING FROM THE DOWNLOAD,        INSTALL AND USE OF GOOGLE PLAY SERVICES WITHIN YOUR VIRTUAL DEVICES. YOU ARE        SOLELY RESPONSIBLE FOR THE USE AND ASSUME ALL LIABILITY RELATED THERETO.        MOREOVER        <br/><br/>        GENYMOBILE INC. DISCLAIMS ANY WARRANTIES OF ANY KIND, EITHER EXPRESS OR IMPLIED,        INCLUDING, WITHOUT LIMITATION, IMPLIED WARRANTIES OF MERCHANTABILITY, OR FITNESS        FOR A PARTICULAR PURPOSE REGARDING THE COMPATIBILITY OF THE OPENGAPPS PACKAGES        WITH ANY VERSION OF GENYMOTION. IN NO EVENT SHALL GENYMOBILE INC. OR ITS AFFILIATES,        OR THEIR RESPECTIVE OFFICERS, DIRECTORS, EMPLOYEES, OR AGENTS BE LIABLE WITH RESPECT        TO YOUR DOWNLOAD OR USE OF THE GOOGLE PLAY SERVICES AND YOU RELEASE GENYMOBILE INC.        FROM ANY LIABILITY RELATED THERETO. YOU AGREE TO DEFEND, INDEMNIFY AND HOLD HARMLESS        GENYMOBILE INC. FOR ANY CLAIMS OR COSTS RELATED TO YOUR USE OR DOWNLOAD OF THE GOOGLE        PLAY SERVICES.            </p>")),e.appendChild(t);const n=document.createElement("div");n.className="gm-upload-main-bottom-buttons";const i=this.createButtonsGroup("Back",e=>{e.preventDefault(),this.flashing=!1,this.displayStep("homeScreen")},"Install",e=>{e.preventDefault(),this.flashing=!0;this.instance.sendEvent({channel:"systempatcher",messages:["install opengapps"]}),this.displayStep("uploadScreen")});return n.appendChild(i[0]),n.appendChild(i[1]),e.appendChild(n),{body:e,title:this.i18n.UPLOADER_DISCLAIMER||"You are about to install Open GApps on your virtual device"}}createUploadScreen(){const e=document.createElement("div"),t=document.createElement("div");t.className="gm-upload-in-progress";const n=this.createTextDiv("gm-upload-in-progress-txt-progress",""),i=this.createTextDiv("gm-upload-in-progress-txt-percent",""),s=this.createTextDiv("gm-upload-in-progress-bg-percent",""),a=this.createTextDiv("gm-upload-in-progress-percent","");a.style.width="0%",s.appendChild(a),t.appendChild(n),t.appendChild(i),t.appendChild(s),e.appendChild(t);const c=document.createElement("div");c.className="gm-upload-main-bottom-buttons";const d=this.createButtonsGroup(null,null,"Cancel",e=>{e.preventDefault();this.instance.sendEvent({channel:"systempatcher",messages:["cancel"]}),this.displayStep("disclaimerScreen")});return c.appendChild(d[1]),e.appendChild(c),{body:e,title:this.i18n.UPLOADER_INPROGRESS||"Downloading"}}createSuccessStep(){const e=document.createElement("div"),t=document.createElement("div");return t.className="gm-upload-success",t.appendChild(this.createIconDiv("gm-upload-success-img")),t.appendChild(this.createTextDiv("gm-upload-success-caption","Congratulation!")),t.appendChild(this.createTextDiv("gm-upload-success-txt","<p>Open GApps have been successfully             installed on the virtual device.<br/>Please restart the virtual device to complete the installation.<br/>            You will be redirected to the Open GApps website.</p>")),t.appendChild(this.createButton("gm-upload-success-button","Reboot device",e=>{e.preventDefault();this.instance.sendEvent({channel:"systempatcher",messages:["reboot"]}),this.toggleWidget()})),e.appendChild(t),{body:e,title:this.i18n.UPLOADER_SUCCESS||"Open GApps successfully installed"}}createErrorStep(){const e=document.createElement("div"),t=document.createElement("div");return t.className="gm-upload-error",t.appendChild(this.createIconDiv("gm-upload-error-img")),t.appendChild(this.createTextDiv("gm-upload-error-caption","Failed to install Open GApps")),e.appendChild(t),{body:e,title:this.i18n.UPLOADER_FAILURE||"We've got a problem…"}}createButtonsGroup(e,t,n,i){const s=[null,null];return e&&(s[0]=this.createButton("gm-upload-main-bottom-buttons-left gm-dont-close",e,t)),n&&(s[1]=this.createButton("gm-upload-main-bottom-buttons-right gm-dont-close",n,i)),s}createButton(e,t,n){const i=document.createElement("div");return i.className=e,i.innerHTML=t,i.onclick=n,i}createIconDiv(e){const t=document.createElement("span");return t.className="gm-upload-icon "+e,t}createTextDiv(e,t){const n=document.createElement("div");return n.className=e,n.innerHTML=t,n}}},{"../worker/FileUploaderWorker":154,"./util/OverlayPlugin":146}],128:[function(e,t,n){const i=e("./util/OverlayPlugin"),{switchButton:s}=e("./util/components");e("loglevel").setDefaultLevel("error");const a={SCAN_RECOGNIZED:"scan recognized",SCAN_UNRECOGNIZED:"scan unrecognized",SCAN_DIRTY:"scan dirty",SCAN_TOO_FAST:"scan too_fast",SCAN_PARTIAL:"scan partial",SCAN_INSUFFICIENT:"scan insufficient",SET_AUTO_RECOGNIZE_FALSE:"set auto_recognize false",SET_AUTO_RECOGNIZE_TRUE:"set auto_recognize true",NOTIFY_ALL:"notify all"},c={SCAN_ERROR:"scan error",SCAN_ERROR_TIMEOUT:"scan error timeout",SCAN_ERROR_CANCELED:"scan error canceled",CURRENT_STATUS_IDLE:"current_status idle",CURRENT_STATUS_SCANNING:"current_status scanning",CURRENT_STATUS_ENROLLING:"current_status enrolling",SCAN_START:"scan start",SCAN_SUCCESS:"scan success",AUTO_RECOGNIZE_FALSE:"auto_recognize false",AUTO_RECOGNIZE_TRUE:"auto_recognize true"};t.exports=class FingerPrint extends i{static get name(){return"FingerPrint"}constructor(e,t){if(super(e),this.instance=e,this.i18n=t||{},this.instance.fingerprint=this,this.state=new Proxy({isScanStart:!1,isRecognizedFPByDefault:!1,isEnrolling:!1,isScanning:!1},{set:(e,t,n)=>{const i=e[t];e[t]=n,!e.isEnrolling&&!e.isScanning||e.isRecognizedFPByDefault?this.disableBody():this.enableBody();const s=document.querySelector(".gm-fingerprint-dialog-auth-required-status");switch(t){case"isScanStart":case"isEnrolling":case"isScanning":e.isScanStart&&(e.isEnrolling||e.isScanning)?(s.classList.add("active"),s.setAttribute("data-text",this.i18n.yes||"Yes"),this.toolbarBtnImage.classList.add("fingerprint-require")):(s.classList.remove("active"),s.setAttribute("data-text",this.i18n.no||"No"),this.toolbarBtnImage.classList.remove("fingerprint-require"));break;case"isRecognizedFPByDefault":n!==i&&(n?this.sendDataToInstance(a.SET_AUTO_RECOGNIZE_TRUE):this.sendDataToInstance(a.SET_AUTO_RECOGNIZE_FALSE)),n?this.toolbarBtnImage.classList.add("fingerprint-autoValidation"):this.toolbarBtnImage.classList.remove("fingerprint-autoValidation"),document.querySelector(".gm-fingerprint-dialog-recognized-fp-by-default-status").setState(n)}return!0}}),this.renderToolbarButton(),this.renderWidget(),this.instance.registerEventCallback("fingerprint",e=>this.handleFingerprintEvent(e)),this.instance.store.state.isWebRTCConnectionReady)this.sendDataToInstance(a.NOTIFY_ALL);else{const e=this.instance.store.subscribe(t=>{let{isWebRTCConnectionReady:n}=t;n&&(this.sendDataToInstance(a.NOTIFY_ALL),e())})}}renderToolbarButton(){const e=this.instance.getChildByClass(this.instance.root,"gm-toolbar");if(!e)return;const t=e.children[0];this.toolbarBtn=document.createElement("li"),this.toolbarBtnImage=document.createElement("div"),this.toolbarBtnImage.className="gm-icon-button gm-fingerprint-button",this.toolbarBtnImage.title=this.i18n.FINGERPRINT_TITLE||"Biometrics",this.toolbarBtn.onclick=this.toggleWidget.bind(this),this.toolbarBtn.appendChild(this.toolbarBtnImage),t.appendChild(this.toolbarBtn)}renderWidget(){this.widget=document.createElement("div"),this.container=document.createElement("div"),this.container.className="gm-fingerprint-container";const e=document.createElement("div");e.className="gm-title",e.innerHTML=this.i18n.FINGERPRINT_TITLE||"Biometrics",this.container.appendChild(e);const t=document.createElement("div");t.classList.add("gm-fingerprint-dialog-header");const n=document.createElement("div");n.classList.add("gm-fingerprint-dialog-auth-required");const i=document.createElement("label");i.innerHTML=this.i18n.FINGERPRINT_AUTH_REQUIRED_LABEL||"Authentification required";const c=document.createElement("div");c.classList.add("gm-fingerprint-dialog-auth-required-status"),c.classList.add(this.state.isScanStart?"active":"inactive"),c.classList.remove(this.state.isScanStart?"active":"inactive"),c.setAttribute("data-text",this.state.isScanStart?this.i18n.yes||"Yes":this.i18n.no||"No"),n.appendChild(i),n.appendChild(c);const d=document.createElement("div");d.classList.add("gm-fingerprint-dialog-recognized-fp-by-default");const l=document.createElement("label");l.innerHTML=this.i18n.FINGERPRINT_RECOGNIZED_FP_BY_DEFAULT_LABEL||"Recognized by default";const h=s.createSwitch({onChange:e=>{this.state.isRecognizedFPByDefault=e}});h.classList.add("gm-fingerprint-dialog-recognized-fp-by-default-status"),d.appendChild(l),d.appendChild(h),t.appendChild(n),t.appendChild(d),this.container.appendChild(t),this.container.appendChild(document.createElement("hr"));const p=document.createElement("div");p.classList.add("gm-fingerprint-dialog-body");const u=document.createElement("div");u.classList.add("gm-fingerprint-dialog-buttons");[{cmd:"recognized",message:a.SCAN_RECOGNIZED,onclick:e=>{e.classList.add("gm-loader")}},{cmd:"unrecognized",message:a.SCAN_UNRECOGNIZED},{cmd:"dirty",message:a.SCAN_DIRTY},{cmd:"too-fast",message:a.SCAN_TOO_FAST},{cmd:"partial",message:a.SCAN_PARTIAL},{cmd:"insufficient",message:a.SCAN_INSUFFICIENT}].forEach(e=>{this.createFingerprintButton(e,u)}),p.appendChild(u),this.container.appendChild(p),this.container.appendChild(document.createElement("hr"));const m=document.createElement("div");m.classList.add("gm-fingerprint-dialog-footer");const g=document.createElement("div");g.classList.add("gm-fingerprint-dialog-give-feedback");const v=document.createElement("a");v.href=this.instance.options.giveFeedbackLink,v.innerHTML=this.i18n.FINGERPRINT_GIVE_FEEDBACK_LABEL||"Give feedback",v.target="_blank",v.rel="noopener noreferrer",g.appendChild(v),m.appendChild(g),this.container.appendChild(m),this.widget.className="gm-overlay gm-fingerprint-plugin gm-hidden";const f=document.createElement("div");f.className="gm-close-btn",f.onclick=this.toggleWidget.bind(this),this.widget.appendChild(f),this.widget.appendChild(this.container),this.instance.root.appendChild(this.widget),this.disableBody()}createFingerprintButton(e,t){let{cmd:n,message:i,onclick:s}=e;const a=document.createElement("div");a.classList.add("gm-fingerprint-dialog-button");const c=document.createElement("div");c.className=`gm-${n}-fingerprint-image`;const d=document.createElement("label");d.innerHTML=this.i18n[`FINGERPRINT_${n.toUpperCase()}_LABEL`]||n,a.onclick=()=>{this.sendDataToInstance(i),s&&s(a)},a.appendChild(c),a.appendChild(d),t.appendChild(a)}disableBody(){document.querySelectorAll(".gm-fingerprint-dialog-body .gm-fingerprint-dialog-button").forEach(e=>{e.classList.add("disabled")})}enableBody(){document.querySelectorAll(".gm-fingerprint-dialog-body .gm-fingerprint-dialog-button").forEach(e=>{e.classList.remove("disabled")})}handleFingerprintEvent(e){switch(e){case c.SCAN_START:this.state.isScanStart=!0;break;case c.SCAN_SUCCESS:case c.SCAN_ERROR_TIMEOUT:case c.SCAN_ERROR_CANCELED:case c.SCAN_ERROR:this.state.isEnrolling=!1,this.state.isScanning=!1,this.state.isScanStart=!1,Array.from(document.querySelectorAll(".gm-fingerprint-dialog-button")).forEach(e=>{e.classList.remove("gm-loader")}),this.toggleWidget();break;case c.CURRENT_STATUS_SCANNING:this.state.isScanning=!0;break;case c.CURRENT_STATUS_ENROLLING:this.state.isEnrolling=!0,this.state.isScanning=!1;break;case c.AUTO_RECOGNIZE_FALSE:this.state.isRecognizedFPByDefault=!1;break;case c.AUTO_RECOGNIZE_TRUE:this.state.isRecognizedFPByDefault=!0}}sendDataToInstance(e){const t={channel:"fingerprint",messages:[e]};this.instance.sendEvent(t)}}},{"./util/OverlayPlugin":146,"./util/components":147,loglevel:99}],129:[function(e,t,n){t.exports=class Fullscreen{static get name(){return"Fullscreen"}constructor(e){this.instance=e,document.addEventListener&&(this.instance.addListener(document,"webkitfullscreenchange",this.onFullscreenEvent.bind(this),!1),this.instance.addListener(document,"fullscreenchange",this.onFullscreenEvent.bind(this),!1)),this.instance.apiManager.registerFunction({name:"fullscreen",category:"video",fn:()=>{this.fullscreenEnabled()?this.exitFullscreen():this.goFullscreen(this.instance.root)},description:"Toggle fullscreen mode for the video player. If the player is currently in fullscreen, it will exit fullscreen; otherwise, it will enter fullscreen mode."}),this.renderToolbarButton()}renderToolbarButton(){const e=this.instance.getChildByClass(this.instance.root,"gm-toolbar");if(!e)return;const t=e.children[0];if(this.isTemplateFullscreen()){const e=this.instance.getChildByClass(this.instance.root,"gm-fullscreen-message");e.onclick=()=>{e.classList.add("hide"),this.instance.wrapper.classList.remove("hide"),this.goFullscreen(this.instance.root)}}else this.button=document.createElement("li"),this.image=document.createElement("div"),this.image.className="gm-icon-button gm-fullscreen-button",this.image.title="Fullscreen",this.button.appendChild(this.image),t.appendChild(this.button),this.button.onclick=()=>{this.fullscreenEnabled()?this.exitFullscreen():this.goFullscreen(this.instance.root)}}goFullscreen(e){this.instance.wrapper.classList.add("gm-fullscreen"),this.image.classList.add("gm-active"),e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen()}fullscreenEnabled(){return document.fullscreenElement||document.webkitFullscreenElement}exitFullscreen(){this.instance.wrapper.classList.remove("gm-fullscreen"),this.image.classList.remove("gm-active"),this.fullscreenEnabled()&&(document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen&&document.webkitExitFullscreen())}isTemplateFullscreen(){return Boolean(this.instance.getChildByClass(this.instance.root,"gm-fullscreen-message"))}onFullscreenEvent(){this.fullscreenEnabled()||this.exitFullscreen()}}},{}],130:[function(e,t,n){const i=e("./util/OverlayPlugin"),s=e("loglevel");s.setDefaultLevel("error"),t.exports=class GPS extends i{static get name(){return"GPS"}constructor(e,t,n){super(e),this.instance=e,this.i18n=t||{},this.instance.gps=this,this.fields=["altitude","longitude","latitude","accuracy","bearing"],n&&this.fields.push("speed"),this.map=null,"undefined"!=typeof google?this.elevationService=new google.maps.ElevationService:this.elevationService=!1,this.markers=[],this.mapLat=65.9667,this.mapLng=-18.5333,this.elevation=15.04444408,this.minimumZoomLevel=8,this.renderToolbarButton(),this.renderGPSForm(),this.renderMapView(),this.instance.registerEventCallback("gps",e=>{const t=e.split(" ");this.fields.includes(t[0])&&t.length>=2&&this.setFieldValue("gm-gps-"+t[0],t[1])})}renderToolbarButton(){const e=this.instance.getChildByClass(this.instance.root,"gm-toolbar");if(!e)return;const t=e.children[0];this.toolbarBtn=document.createElement("li"),this.toolbarBtnImage=document.createElement("div"),this.toolbarBtnImage.className="gm-icon-button gm-gps-button",this.toolbarBtnImage.title=this.i18n.GPS_TITLE||"GPS",this.toolbarBtn.appendChild(this.toolbarBtnImage),this.toolbarBtn.onclick=this.toggleForm.bind(this),t.appendChild(this.toolbarBtn)}renderMapView(){this.mapWidget=document.createElement("div"),this.mapview=document.createElement("div");const e=document.createElement("button");e.innerHTML=this.i18n.GPS_CAPTURE||"Capture",e.className="gm-gps-mapview-capture",e.onclick=this.onMapClicked.bind(this);const t=document.createElement("button");t.innerHTML=this.i18n.GPS_CANCEL||"Cancel",t.className="gm-gps-mapview-cancel",t.onclick=this.onHideMapButtonClicked.bind(this),this.mapview.className="gm-mapview",this.mapWidget.className="gm-overlay gm-gps-mapview gm-hidden",this.mapWidget.appendChild(this.mapview),this.mapWidget.appendChild(e),this.mapWidget.appendChild(t),this.instance.root.appendChild(this.mapWidget)}loadMap(){const e=this.getLocationInfo();"undefined"!=typeof google&&(this.map=new google.maps.Map(this.mapview,{center:{lat:e.latitude,lng:e.longitude},zoom:this.minimumZoomLevel}),this.addMapMarker(e.latitude,e.longitude),this.map.addListener("click",e=>{this.clearMarkers(),this.addMapMarker(e.latLng.lat(),e.latLng.lng())}))}toggleMapview(){this.mapWidget.classList.toggle("gm-hidden")}generateInput(e,t,n,i,s){const a=document.createElement("div"),c=document.createElement("label");c.innerHTML=t,a.appendChild(c);const d=document.createElement("input");return d.type="number",d.defaultValue=n,d.min=i,d.max=s,d.className="gm-gps-"+e,d.step="any",this.instance.addListener(d,"keyup",this.checkErrors.bind(this)),a.appendChild(d),a}checkErrors(){let e=!1;this.fields.forEach(t=>{const n=this.instance.getChildByClass(this.instance.root,"gm-gps-"+t);!1===n.checkValidity()?(n.classList.add("gm-error"),e=!0):n.classList.remove("gm-error")}),this.instance.getChildByClass(this.instance.root,"gm-gps-submit").disabled=e}renderGPSForm(){this.widget=document.createElement("div"),this.form=document.createElement("form");const e=document.createElement("div"),t=document.createElement("div");t.className="gm-title",t.innerHTML=this.i18n.GPS_TITLE||"GPS",this.form.appendChild(t);const n=document.createElement("div");n.className="gm-col";const i=this.i18n.GPS_LATITUDE||"Latitude (°)";n.appendChild(this.generateInput("latitude",i,this.mapLat,-90,90));const s=this.i18n.GPS_LONGITUDE||"Longitude (°)";n.appendChild(this.generateInput("longitude",s,this.mapLng,-180,180));const a=this.i18n.GPS_ALTITUDE||"Altitude (m)";n.appendChild(this.generateInput("altitude",a,this.elevation,-1e4,1e4));const c=this.i18n.GPS_ACCURACY||"Accuracy (m)";n.appendChild(this.generateInput("accuracy",c,0,0,200));const d=this.i18n.GPS_BEARING||"Bearing (°)";if(n.appendChild(this.generateInput("bearing",d,0,0,360)),this.fields.includes("speed")){const e=this.i18n.GPS_SPEED||"Speed (m/s)";n.appendChild(this.generateInput("speed",e,0,0,399.99))}const l=document.createElement("div"),h=document.createElement("div"),p=document.createElement("button");this.rightGeolocWrap=document.createElement("div"),this.geolocBtn=document.createElement("button"),l.className="gm-col",h.className="map-wrap",p.className="map",p.innerHTML=this.i18n.GPS_MAP||"MAP",p.onclick=this.onOpenMapButtonClicked.bind(this),this.elevationService||(p.disabled=!0),this.rightGeolocWrap.className="gm-geoloc-wrap",this.geolocBtn.className="gm-gps-geoloc",this.geolocBtn.innerHTML=this.i18n.GPS_GEOLOC||"My position",this.geolocBtn.onclick=this.onGeolocButtonClicked.bind(this),h.appendChild(p),this.rightGeolocWrap.appendChild(this.geolocBtn),l.appendChild(h),l.appendChild(this.rightGeolocWrap),e.className="gm-wrap",e.appendChild(n),e.appendChild(l),this.form.appendChild(e);const u=document.createElement("button");u.innerHTML=this.i18n.GPS_SUBMIT||"Submit",u.className="gm-gps-submit",u.onclick=this.sendDataToInstance.bind(this),this.form.appendChild(u),this.widget.className="gm-overlay gm-gps-controls gm-hidden";const m=document.createElement("div");m.className="gm-close-btn",m.onclick=this.toggleForm.bind(this),this.widget.appendChild(m),this.widget.appendChild(this.form),this.instance.root.appendChild(this.widget)}toggleForm(){this.toggleWidget(),this.checkForGeolocation(),this.mapWidget.classList.add("gm-hidden")}setGeolocButtonAvailability(e){this.geolocBtn.disabled=!e,this.rightGeolocWrap.title=e?this.i18n.GPS_GEOLOC_TOOLTIP||"Get my position from browser location":this.i18n.GPS_NOGEOLOC_TOOLTIP||"Geolocation not supported"}onOpenMapButtonClicked(e){e.preventDefault(),this.toggleMapview(),this.loadMap()}onGeolocButtonClicked(e){e.preventDefault(),this.getLocation()}onMapClicked(e){e.preventDefault(),this.setFieldValue("gm-gps-latitude",this.mapLat),this.setFieldValue("gm-gps-longitude",this.mapLng),this.setFieldValue("gm-gps-altitude",this.elevation),this.toggleMapview()}onHideMapButtonClicked(e){e.preventDefault(),this.mapWidget.classList.add("gm-hidden")}sendDataToInstance(e){e.preventDefault();const t=this.buildEventJson();t.messages.length&&this.instance.sendEvent(t),this.toggleForm()}getLocation(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(e=>{if(e&&e.coords&&(this.fields.forEach(t=>{e.coords[t]&&this.setFieldValue("gm-gps-"+t,e.coords[t])}),!e.coords.altitude&&this.elevationService&&e.coords.latitude&&e.coords.longitude)){const t=new google.maps.LatLng(e.coords.latitude,e.coords.longitude);this.elevationService.getElevationForLocations({locations:[t]},(e,t)=>{"OK"===t&&e[0]&&this.setFieldValue("gm-gps-altitude",e[0].elevation)})}})}checkForGeolocation(){"geolocation"in navigator?navigator.geolocation.getCurrentPosition(()=>{this.setGeolocButtonAvailability(!0)},()=>{this.setGeolocButtonAvailability(!1)}):this.setGeolocButtonAvailability(!1)}setFieldValue(e,t){if(t=Number(t),Number.isNaN(t))return;const n=this.instance.getChildByClass(this.instance.root,e);n&&(n.max&&(t=Math.min(t,n.max)),n.min&&(t=Math.max(t,n.min)),n.value=t)}getLocationInfo(){const e={};return this.fields.forEach(t=>{const n=this.instance.getChildByClass(this.instance.root,"gm-gps-"+t);if(!n)return void s.debug(t+" field not found.");let i=Number(n.value);Number.isNaN(i)||(n.max&&(i=Math.min(i,n.max)),n.min&&(i=Math.max(i,n.min)),e[t]=i)}),e}buildEventJson(){const e={channel:"gps",messages:[]},t=this.getLocationInfo();return this.fields.forEach(n=>{e.messages.push("set "+n+" "+t[n])}),e.messages.length&&e.messages.push("enable"),e}addMapMarker(e,t){this.mapLat=e,this.mapLng=t;const n=new google.maps.Marker({position:{lat:this.mapLat,lng:this.mapLng},map:this.map});if(this.markers.push(n),this.map&&this.map.getZoom()<this.minimumZoomLevel&&(this.map.setCenter(n.getPosition()),this.map.setZoom(this.minimumZoomLevel)),this.elevationService){const n=new google.maps.LatLng(e,t);this.elevationService.getElevationForLocations({locations:[n]},(e,t)=>{"OK"===t&&e[0]&&(this.elevation=e[0].elevation)})}}clearMarkers(){this.markers.forEach(e=>{e.setMap(null)}),this.markers=[]}}},{"./util/OverlayPlugin":146,loglevel:99}],131:[function(e,t,n){const i=e("loglevel");i.setDefaultLevel("error");const s=e("./util/OverlayPlugin");t.exports=class Gamepad extends s{static get name(){return"Gamepad"}constructor(e,t){super(e),this.instance=e,this.i18n=t||{},this.instance.gamepad=this,this.instance.addListener(window,"gm-gamepadButtonPressed",this.onGamepadButtonPressed.bind(this)),this.instance.addListener(window,"gm-gamepadButtonReleased",this.onGamepadButtonReleased.bind(this)),this.instance.addListener(window,"gm-gamepadAxis",this.onGamepadAxisChanged.bind(this)),this.instance.registerEventCallback("vinput",this.handleConfirmation.bind(this)),this.renderToolbarButton(),this.renderWidget()}renderToolbarButton(){const e=this.instance.getChildByClass(this.instance.root,"gm-toolbar");if(!e)return;const t=e.children[0];this.toolbarBtn=document.createElement("li"),this.toolbarBtnImage=document.createElement("div"),this.toolbarBtnImage.className="gm-icon-button gm-gamepad-button",this.toolbarBtnImage.title=this.i18n.GAMEPAD_TITLE||"Gamepad",this.toolbarBtn.appendChild(this.toolbarBtnImage),this.toolbarBtn.onclick=this.toggleWidget.bind(this),t.appendChild(this.toolbarBtn)}renderWidget(){this.widget=document.createElement("div"),this.container=document.createElement("div");const e=document.createElement("div");e.className="gm-title",e.innerHTML=this.i18n.GAMEPAD_TITLE||"Gamepad",this.container.appendChild(e),this.content=document.createElement("div"),this.container.appendChild(this.content),this.generateContent(),this.instance.addListener(window,"gm-gamepadConnected",this.handleGamepadPlugged.bind(this)),this.instance.addListener(window,"gm-gamepadDisconnected",this.handleGamepadUnplugged.bind(this)),this.widget.className="gm-overlay gm-gamepad-plugin gm-hidden";const t=document.createElement("div");t.onclick=this.toggleWidget.bind(this),t.className="gm-close-btn",this.widget.appendChild(t),this.widget.appendChild(this.container),this.instance.root.appendChild(this.widget)}generateContent(){this.content.replaceChildren();const e=this.instance.gamepadManager.getGamepads();if(0===e.length)this.content.innerHTML="No gamepad detected, please plug one or press a button";else{const t=document.createElement("ul");for(const n of e)if("plugged"===n.state){const e=document.createElement("li");e.innerHTML=n.name,t.appendChild(e)}this.content.appendChild(t)}}handleGamepadPlugged(e){i.debug("Gamepad plugged");const t=e.detail;this.generateContent(),this.sendGamepadPlugEvent(t.hostIndex,t.name.split(" ").join("_"),t.vendorID,t.productID)}handleGamepadUnplugged(e){i.debug("Gamepad unplugged");const t=e.detail;this.generateContent(),this.sendGamepadUnplugEvent(t.guestIndex)}sendGamepadPlugEvent(e,t,n,i){const s={channel:"vinput",messages:["gamepad_plugin "+e+" "+t+" "+n+" "+i]};this.instance.sendEvent(s)}sendGamepadUnplugEvent(e){const t={channel:"vinput",messages:["gamepad_plugout "+e]};this.instance.sendEvent(t)}handleConfirmation(e){i.debug("Gamepad plugin confirmation");const t=e.split(" ");"gamepad_plugin_confirmation"===t[0]&&3===t.length&&this.instance.gamepadManager.listenForInputs(parseInt(t[1]),parseInt(t[2]))}onGamepadButtonPressed(e){const t={channel:"vinput",messages:["gamepad_press "+e.detail.gamepadIndex+" "+e.detail.buttonIndex]};this.instance.sendEvent(t)}onGamepadButtonReleased(e){const t={channel:"vinput",messages:["gamepad_release "+e.detail.gamepadIndex+" "+e.detail.buttonIndex]};this.instance.sendEvent(t)}onGamepadAxisChanged(e){const t={channel:"vinput",messages:["gamepad_axis "+e.detail.gamepadIndex+" "+e.detail.axisIndex+" "+e.detail.value]};this.instance.sendEvent(t)}}},{"./util/OverlayPlugin":146,loglevel:99}],132:[function(e,t,n){const i=e("loglevel");i.setDefaultLevel("error");const s=Object.freeze({Xbox360:Symbol("Xbox360"),XboxOne:Symbol("XboxOne"),Dualshock4:Symbol("DualShock4")});t.exports=class GamepadManager{constructor(e){this.instance=e,this.instance.gamepadManager=this,this.instance.gamepadEventsEnabled=!0,this.isRunning=!1,this.gamepadInfos=[["GPD Win 2 X-Box Controller",s.Xbox360,121,6356],["Thrustmaster Gamepad GP XID",s.Xbox360,1103,45862],["Xbox 360 Controller",s.Xbox360,1118,654],["Xbox 360 Controller v2",s.Xbox360,1118,655],["Xbox 360 Wireless Dongle",s.Xbox360,1118,657],["Xbox 360 Big Button IR",s.Xbox360,1118,672],["Xbox 360 Controller",s.Xbox360,1118,673],["Xbox One Controller (1537)",s.XboxOne,1118,733],["Xbox One Controller (Firmware 2015)",s.XboxOne,1103,45862],["Xbox One S Controller (Bluetooth)",s.XboxOne,1118,736],["Xbox One Elite Controller",s.XboxOne,1118,739],["Xbox One S Controller (1708)",s.XboxOne,1118,746],["Xbox One S Controller (1708) (Bluetooth)",s.XboxOne,1118,765],["Xbox One Controller",s.XboxOne,1118,767],["Xbox One Elite Series 2",s.XboxOne,1118,2816],["Xbox 360 Wireless Receiver",s.Xbox360,1118,1817],["Xbox Series X/S Controller",s.XboxOne,1118,2834],["Xbox Series X/S Controller",s.XboxOne,1118,2835],["Logitech Gamepad F310",s.Xbox360,1133,49693],["Logitech Gamepad F510",s.Xbox360,1133,49694],["Logitech Gamepad F710",s.Xbox360,1133,49695],["Logitech Chillstream Controller",s.Xbox360,1133,49730],["HORI Pad Switch",s.Xbox360,3853,193],["HORI Pokken Tournament DX Pro Pad",s.Xbox360,3853,146],["HORI Wireless Switch Pad",s.Xbox360,3853,246],["HORI Battle Pad",s.Xbox360,3853,220],["PowerA Wired Controller Plus/PowerA Wired Gamecube Controller",s.Xbox360,8406,42769],["PDP Wired Fight Pad Pro for Nintendo Switch",s.Xbox360,3695,389],["PDP Faceoff Wired Pro Controller for Nintendo Switch",s.Xbox360,3695,384],["PDP Faceoff Deluxe Wired Pro Controller for Nintendo Switch",s.Xbox360,3695,385],["Nintendo Switch Pro Controller",s.Xbox360,1406,8201],["PlayStation 3 Controller",s.Dualshock4,1356,616],["PlayStation 3 Controller",s.Dualshock4,2341,5],["PlayStation 3 Controller",s.Dualshock4,34952,776],["Afterglow PS3",s.Dualshock4,6708,2102],["HORI horipad4 PS3",s.Dualshock4,3853,110],["HORI horipad4 PS4",s.Dualshock4,3853,102],["HORI Fighting commander PS3",s.Dualshock4,3853,95],["HORI Fighting commander PS4",s.Dualshock4,3853,94],["Madcats Fightpad Pro PS4",s.Dualshock4,1848,33360],["Venom Arcade Stick",s.Dualshock4,121,6170],["PC Twin Shock Controller",s.Dualshock4,121,6],["Digiflip GP006",s.Dualshock4,9571,1315],["SRXJ-PH2400",s.Dualshock4,4607,13105],["ShanWan PS3",s.Dualshock4,8380,21760],["Firestorm Dual Analog 3",s.Dualshock4,1103,45845],["Horipad 3",s.Dualshock4,3853,77],["HORI BDA GP1",s.Dualshock4,3853,9],["Green Asia",s.Dualshock4,3727,8],["Real Arcade Pro 4",s.Dualshock4,3853,106],["Rock Candy PS4",s.Dualshock4,3695,286],["Afterglow PS3",s.Dualshock4,3695,532],["JC-U4113SBK",s.Dualshock4,1390,8211],["Madcatz Fightstick Pro",s.Dualshock4,1848,34872],["Afterglow PS3",s.Dualshock4,6708,2102],["Quanba Q1 fight stick",s.Dualshock4,3888,4352],["HORI fighting mini stick",s.Dualshock4,3853,135],["BTP 2163",s.Dualshock4,33664,3],["PS2 ACME GA-D5",s.Dualshock4,4933,4096],["SpeedLink Strike FX",s.Dualshock4,3727,12405],["Rock Candy PS3",s.Dualshock4,3695,296],["Quanba Drone",s.Dualshock4,11298,8192],["Cyborg V3",s.Dualshock4,1699,63010],["Thrustmaster wireless 3-1",s.Dualshock4,1103,53255],["Gioteck vx2",s.Dualshock4,9712,33731],["JC-U3412SBK",s.Dualshock4,1464,4102],["Power A PS3",s.Dualshock4,8406,22381],["PDP Afterglow Wireless PS3 Controller",s.Dualshock4,3695,4884],["Mad Catz Alpha PS3 mode",s.Dualshock4,1848,12672],["Mad Catz Alpha PS4 mode",s.Dualshock4,1848,33152],["Victrix Pro FS",s.Dualshock4,3695,515],["PlayStation 4 Controller",s.Dualshock4,1356,1476],["PlayStation 4 Controller V2",s.Dualshock4,1356,2508],["PlayStation 4 Wireless Dongle",s.Dualshock4,1356,2976],["PS5 DualSense Controller",s.Dualshock4,1356,3302],["HORI Real Arcade Pro 4",s.Dualshock4,3853,138],["HORIPAD 4 FPS",s.Dualshock4,3853,85],["HORIPAD 4 FPS Plus",s.Dualshock4,3853,102],["HORIPAD 4 FPS Plus",s.Dualshock4,1848,33668],["Mad Catz FightPad Pro PS4",s.Dualshock4,1848,33360],["Mad Catz Fightstick TE S+",s.Dualshock4,1848,33668],["Armor Armor 3 Pad PS4",s.Dualshock4,3090,3600],["EMIO PS4 Elite Controller",s.Dualshock4,3090,7414],["Razer Raiju PS4 Controller",s.Dualshock4,5426,4096],["Razer Panthera PS4 Controller",s.Dualshock4,5426,1025],["STRIKEPAD PS4 Grip Add-on",s.Dualshock4,1356,1477],["Nacon Revolution Pro Controller",s.Dualshock4,5227,3329],["Nacon Revolution Pro Controller V2",s.Dualshock4,5227,3330],["HORI TAC4",s.Dualshock4,3853,160],["HORI TAC PRO",s.Dualshock4,3853,156],["Hitbox Arcade Stick",s.Dualshock4,3090,3830],["Venom Arcade Stick",s.Dualshock4,121,6171],["Mad Catz FightPad PRO",s.Dualshock4,1848,12880],["HORI mini wired gamepad",s.Dualshock4,3853,238],["Mad Catz FightStick TE 2+ PS4",s.Dualshock4,1848,33921],["Mad Catz FightStick TE 2",s.Dualshock4,1848,33920],["Armor 3, Level Up Cobra",s.Dualshock4,30021,260],["Razer Raiju 2 Tournament Edition (USB)",s.Dualshock4,5426,4103],["Razer Raiju 2 Tournament Edition (BT)",s.Dualshock4,5426,4106],["Razer Raiju 2 Ultimate Edition (USB)",s.Dualshock4,5426,4100],["Razer Raiju 2 Ultimate Edition (BT)",s.Dualshock4,5426,4105],["Razer Panthera Evo Fightstick",s.Dualshock4,5426,4104],["Astro C40",s.Dualshock4,39046,37],["Game:Pad 4",s.Dualshock4,3090,3605],["PS4 Fun Controller",s.Dualshock4,16385,260],["Elecom JC-U3613M",s.Xbox360,1390,8196],["Saitek P3600",s.Xbox360,1699,62746],["Mad Catz Wired Xbox 360 Controller",s.Xbox360,1848,18198],["Mad Catz Street Fighter IV FightStick SE",s.Xbox360,1848,18200],["Mad Catz Xbox 360 Controller",s.Xbox360,1848,18214],["Mad Catz Street Fighter IV FightPad",s.Xbox360,1848,18216],["Mad Catz MicroCon Gamepad",s.Xbox360,1848,18230],["Mad Catz Wired Xbox 360 Controller (SFIV)",s.Xbox360,1848,18232],["Mad Catz Beat Pad",s.Xbox360,1848,18240],["Mad Catz FightStick TE 2",s.XboxOne,1848,18945],["Mad Catz Xbox controller - MW2",s.Xbox360,1848,46886],["Mad Catz JOYTECH NEO SE Advanced GamePad",s.Xbox360,1848,48879],["Saitek Cyborg Rumble Pad - PC/Xbox 360",s.Xbox360,1848,51970],["Saitek P3200 Rumble Pad - PC/Xbox 360",s.Xbox360,1848,51971],["Super SFIV FightStick TE S",s.Xbox360,1848,63288],["HSM3 Xbox360 dancepad",s.Xbox360,3695,261],["Afterglow AX.1 Gamepad for Xbox 360",s.Xbox360,3695,275],["Rock Candy Gamepad Wired Controller",s.Xbox360,3695,287],["Xbox 360 Wired Controller",s.Xbox360,3695,307],["Afterglow Prismatic Wired Controller",s.XboxOne,3695,313],["PDP Xbox One Controller",s.XboxOne,3695,314],["Rock Candy Wired Controller for Xbox One",s.XboxOne,3695,326],["PDP Marvel Xbox One Controller",s.XboxOne,3695,327],["PDP Xbox One Arcade Stick",s.XboxOne,3695,348],["PDP Xbox One Controller",s.XboxOne,3695,353],["PDP Xbox One Controller",s.XboxOne,3695,354],["PDP Xbox One Controller",s.XboxOne,3695,355],["PDP Battlefield One",s.XboxOne,3695,356],["PDP Titanfall 2",s.XboxOne,3695,357],["Pelican PL-3601 'TSZ' Wired Xbox 360 Controller",s.Xbox360,3695,513],["Afterglow Gamepad for Xbox 360",s.Xbox360,3695,531],["Rock Candy Gamepad for Xbox 360",s.Xbox360,3695,543],["Rock Candy Gamepad for Xbox One 2015",s.XboxOne,3695,582],["Logic3 Controller",s.Xbox360,3695,769],["Rock Candy Gamepad for Xbox One 2016",s.XboxOne,3695,838],["Logic3 Controller",s.Xbox360,3695,1025],["Afterglow AX.1 Gamepad for Xbox 360",s.Xbox360,3695,1043],["PDP Xbox 360 Controller",s.Xbox360,3695,1281],["PDP Afterglow AX.1",s.Xbox360,3695,63744],["Hori Co. DOA4 FightStick",s.Xbox360,3853,10],["Hori PadEX Turbo",s.Xbox360,3853,12],["Hori Fighting Stick EX2",s.Xbox360,3853,13],["Hori Real Arcade Pro.EX",s.Xbox360,3853,22],["Hori Real Arcade Pro VX",s.Xbox360,3853,27],["Hori Real Arcade Pro Hayabusa (USA) Xbox One",s.XboxOne,3853,99],["HORIPAD ONE",s.XboxOne,3853,103],["Hori Real Arcade Pro V Kai Xbox One",s.XboxOne,3853,120],["Nacon GC-100XF",s.Xbox360,4553,22e3],["Honey Bee Xbox360 dancepad",s.Xbox360,4779,4],["PDP AFTERGLOW AX.1",s.Xbox360,4779,769],["Mortal Kombat Klassic FightStick",s.Xbox360,4779,771],["RedOctane Guitar Hero X-plorer",s.Xbox360,5168,18248],["RedOctane Controller",s.Xbox360,5168,63489],["BigBen Interactive XBOX 360 Controller",s.Xbox360,5227,1537],["Razer Sabertooth",s.Xbox360,5426,55],["Razer Atrox Arcade Stick",s.XboxOne,5426,2560],["Razer Wildcat",s.XboxOne,5426,2563],["Power A Mini Pro Elite",s.Xbox360,5604,16128],["Xbox Airflo wired controller",s.Xbox360,5604,16138],["Batarang Xbox 360 controller",s.Xbox360,5604,16144],["Joytech Neo-Se Take2",s.Xbox360,5678,48879],["Razer Onza Tournament Edition",s.Xbox360,5769,64768],["Razer Onza Classic Edition",s.Xbox360,5769,64769],["Razer Sabertooth",s.Xbox360,5769,65024],["Harmonix Rock Band Guitar",s.Xbox360,7085,2],["Harmonix Rock Band Drumkit",s.Xbox360,7085,3],["Mad Catz Xbox 360 Controller",s.Xbox360,7085,61462],["Mad Catz Street Fighter IV SE Fighting Stick",s.Xbox360,7085,61464],["Mad Catz Brawlstick for Xbox 360",s.Xbox360,7085,61465],["Mad Cats Ghost Recon FS GamePad",s.Xbox360,7085,61473],["MLG Pro Circuit Controller (Xbox)",s.Xbox360,7085,61475],["Mad Catz Call Of Duty",s.Xbox360,7085,61477],["Mad Catz FPS Pro",s.Xbox360,7085,61479],["Street Fighter IV FightPad",s.Xbox360,7085,61480],["Mad Catz Fightpad",s.Xbox360,7085,61486],["Mad Catz MicroCon GamePad Pro",s.Xbox360,7085,61494],["Street Fighter IV FightStick TE",s.Xbox360,7085,61496],["Mad Catz MvC2 TE",s.Xbox360,7085,61497],["Mad Catz SFxT Fightstick Pro",s.Xbox360,7085,61498],["Street Fighter IV Arcade Stick TE - Chun Li",s.Xbox360,7085,61501],["Mad Catz MLG FightStick TE",s.Xbox360,7085,61502],["Mad Catz FightStick SoulCaliber",s.Xbox360,7085,61503],["Mad Catz FightStick TES+",s.Xbox360,7085,61506],["Mad Catz FightStick TE2",s.Xbox360,7085,61568],["HoriPad EX2 Turbo",s.Xbox360,7085,62721],["Hori Real Arcade Pro.VX SA",s.Xbox360,7085,62722],["Hori Fighting Stick VX",s.Xbox360,7085,62723],["Hori Real Arcade Pro. EX",s.Xbox360,7085,62724],["Hori Fighting Stick EX2B",s.Xbox360,7085,62725],["Hori Real Arcade Pro.EX Premium VLX",s.Xbox360,7085,62726],["Harmonix Xbox 360 Controller",s.Xbox360,7085,63744],["Gamestop Xbox 360 Controller",s.Xbox360,7085,63745],["Tron Xbox 360 controller",s.Xbox360,7085,63747],["PDP Versus Fighting Pad",s.Xbox360,7085,63748],["MortalKombat FightStick",s.Xbox360,7085,63750],["MadCatz GamePad",s.Xbox360,7085,64001],["Razer Onza TE",s.Xbox360,7085,64768],["Razer Onza",s.Xbox360,7085,64769],["Razer Atrox Arcade Stick",s.Xbox360,9414,20480],["PowerA MINI PROEX Controller",s.Xbox360,9414,21248],["Xbox Airflo wired controller",s.Xbox360,9414,21251],["Xbox 360 Pro EX Controller",s.Xbox360,9414,21258],["PowerA Pro Ex",s.Xbox360,9414,21274],["FUS1ON Tournament Controller",s.Xbox360,9414,21399],["PowerA Xbox One Mini Wired Controller",s.XboxOne,9414,21530],["Xbox ONE spectra",s.XboxOne,9414,21546],["PowerA Xbox One wired controller",s.XboxOne,9414,21562],["Hori XBOX 360 EX 2 with Turbo",s.Xbox360,9414,21760],["Hori Real Arcade Pro VX-SA",s.Xbox360,9414,21761],["Hori Fighting Stick VX Alt",s.Xbox360,9414,21762],["Hori Fighting Edge",s.Xbox360,9414,21763],["Hori SOULCALIBUR V Stick",s.Xbox360,9414,21766],[" GEM Xbox controller",s.Xbox360,9414,21773],["Hori Real Arcade Pro V Kai 360",s.Xbox360,9414,21774],["PowerA FUSION Pro Controller",s.XboxOne,9414,21786],["PowerA FUSION Controller",s.XboxOne,9414,22042],["Thrustmaster",s.Xbox360,9414,23298],["Thrustmaster Ferrari 458 Racing Wheel",s.Xbox360,9414,23299],["Razer Sabertooth",s.Xbox360,9414,23812],["Rock Candy Gamepad for Xbox 360",s.Xbox360,9414,64254],["Stadia Controller",s.Xbox360,6353,37888]],this.currentGamepads=[]}addGamepadCallbacks(){this.instance.addListener(window,"gamepadconnected",this.onGamepadConnected.bind(this)),this.instance.addListener(window,"gamepaddisconnected",this.onGamepadDisconnected.bind(this))}onGamepadConnected(e){this.instance.store.dispatch({type:"ADD_TRACKED_EVENT",payload:{category:"gamepad",action:"plugged"}});const t=new CustomEvent("gm-gamepadConnected",{detail:this.parseGamepad(e.gamepad)});window.dispatchEvent(t)}onGamepadDisconnected(e){const t=new CustomEvent("gm-gamepadDisconnected",{detail:this.parseGamepad(e.gamepad)});window.dispatchEvent(t),this.stopListeningInputs(e.gamepad.index)}getRawGamepads(){return navigator.getGamepads()}getGamepads(){const e=[],t=this.getRawGamepads();for(let n=0;n<t.length;n++)t[n]&&e.push(this.parseGamepad(t[n]));return e}getRawGamepadByGuestIndex(e){for(let t=0;t<this.currentGamepads.length;t++)if(this.currentGamepads[t].guestIndex===e)return this.getRawGamepads()[t]}getInfosFromID(e,t){return this.gamepadInfos.find(n=>n[2]===e&&n[3]===t)}listenForInputs(e,t){this.currentGamepads[e]={guestIndex:t,buttons:[],axes:[]},this.isRunning||this.loop()}stopListeningInputs(e){this.currentGamepads.splice(e,1)}computeValueInNewRange(e,t,n,i,s){const a=Math.abs(t-e);if(0===a)return n;return(s-e)*Math.abs(i-n)/a+n}loop(){if(0===this.currentGamepads.length)return void(this.isRunning=!1);this.isRunning=!0;const e=this.getRawGamepads();for(const t of e)if(t&&this.currentGamepads[t.index]){for(let e=0;e<t.buttons.length;e++){const n=this.currentGamepads[t.index].buttons.indexOf(e);if(!t.buttons[e].pressed||-1!==n&&6!==e&&7!==e){if(!t.buttons[e].pressed&&-1!==n){this.currentGamepads[t.index].buttons.splice(n,1);const i=new CustomEvent("gm-gamepadButtonReleased",{detail:{gamepadIndex:this.currentGamepads[t.index].guestIndex,buttonIndex:e,value:t.buttons[e].value}});window.dispatchEvent(i)}}else{-1===n&&this.currentGamepads[t.index].buttons.push(e);const i=new CustomEvent("gm-gamepadButtonPressed",{detail:{gamepadIndex:this.currentGamepads[t.index].guestIndex,buttonIndex:e,value:t.buttons[e].value}});window.dispatchEvent(i)}}for(let e=0;e<t.axes.length;e++)if(t.axes[e]!==this.currentGamepads[t.index].axes[e]){this.currentGamepads[t.index].axes[e]=t.axes[e];const n=new CustomEvent("gm-gamepadAxis",{detail:{gamepadIndex:this.currentGamepads[t.index].guestIndex,axisIndex:e,value:t.axes[e]}});window.dispatchEvent(n)}}window.requestAnimationFrame(this.loop.bind(this))}parseGamepad(e){var t;const n=-1!==navigator.userAgent.indexOf("Firefox"),i={hostIndex:e.index,name:e.id,power:"unknown",controllerType:s.Xbox360,vendor:"Default",vendorID:0,productID:0,state:e.connected?"plugged":"undefined",guestIndex:null===(t=this.currentGamepads[e.index])||void 0===t?void 0:t.guestIndex};if(n){const t=/^([0-9a-f]{1,4})-([0-9a-f]{1,4})-\s*(.*)\s*$/i,n=e.id.match(t);n&&(i.vendorID=Number("0x"+n[1]),i.productID=Number("0x"+n[2]),i.name=n[3])}else{const t=/(.+) \(((.+) )?Vendor: (.+) Product: (.+)\)/i,n=e.id.match(t);n&&(i.name=n[1],i.vendor=n[2],i.vendorID=Number("0x"+n[n.length-2]),i.productID=Number("0x"+n[n.length-1]))}const a=this.instance.gamepadManager.getInfosFromID(i.vendorID,i.productID);return a&&(i.name=a[0]+" ("+i.name+")",i.controllerType=a[1]),i}vibration(e,t,n){const s=this.getRawGamepadByGuestIndex(e);if(s)if(s.vibrationActuator){const a=s.vibrationActuator;if(a.playEffect){const e=this.computeValueInNewRange(0,255,0,1,t.toFixed(1)),i=this.computeValueInNewRange(0,255,0,1,n.toFixed(1));a.playEffect("dual-rumble",{startDelay:0,duration:200,weakMagnitude:e,strongMagnitude:i})}else i.error("could not use vibration actuator for controller "+e)}else if(s.hapticActuators&&s.hapticActuators[0]){const t=s.hapticActuators[0];t.pulse?t.pulse(n,200):i.error("could not use haptic actuator for controller "+e)}else i.error("no vibration actuator for controller "+e)}}},{loglevel:99}],133:[function(e,t,n){const i=e("./util/OverlayPlugin"),s=e("./util/iothrottling-profiles");t.exports=class IOThrottling extends i{static get name(){return"IOThrottling"}constructor(e,t){super(e),this.instance=e,this.i18n=t||{},this.instance.diskIO=this,this.fields={},this.renderToolbarButton(),this.renderWidget(),this.instance.registerEventCallback("diskio",e=>{const t=e.split(" ");"readbyterate"===t[0]&&2===t.length&&this.updateDiskIOValues(t[1]/1048576)})}renderToolbarButton(){const e=this.instance.getChildByClass(this.instance.root,"gm-toolbar");if(!e)return;const t=e.children[0];this.toolbarBtn=document.createElement("li"),this.toolbarBtnImage=document.createElement("div"),this.toolbarBtnImage.className="gm-icon-button gm-iothrottling-button",this.toolbarBtnImage.title=this.i18n.IOTHROTTLING_TITLE||"Disk I/O",this.toolbarBtn.appendChild(this.toolbarBtnImage),this.toolbarBtn.onclick=this.toggleWidget.bind(this),t.appendChild(this.toolbarBtn)}renderWidget(){this.widget=document.createElement("div"),this.form=document.createElement("form");const e=document.createElement("div");e.className="gm-title",e.innerHTML=this.i18n.IOTHROTTLING_TITLE||"Disk I/O",this.form.appendChild(e);const t=document.createElement("div");t.className="gm-inputs";const n=this.i18n.IOTHROTTLING_PROFILE||"Profile";t.innerHTML="<label>"+n+"</label>",this.select=document.createElement("select"),this.select.className="gm-iothrottling-select";const i=new Option(this.i18n.IOTHROTTLING_PROFILE_NONE||"None");this.select.add(i),this.select.onchange=this.changeProfile.bind(this),t.appendChild(this.select),s.forEach(e=>{const t=new Option(e.label,e.name);this.select.add(t)}),this.readByteRateDiv=document.createElement("div"),this.readByteRateDiv.classList.add("gm-fields");const a=document.createElement("label");a.innerHTML=this.i18n.IOTHROTTLING_READ_BYTERATE||"Read speed limit:",this.readByteRate=document.createElement("input"),this.readByteRate.className="gm-iothrottling-readbyterate",this.readByteRate.placeholder=this.i18n.IOTHROTTLING_READ_BYTERATE_EXAMPLE||"eg: 100",this.readByteRate.title=this.i18n.READ_BYTE_RATE||"Read speed limit",this.readByteRate.required=!0,this.readByteRate.pattern="[0-9]*",this.readByteRateDiv.appendChild(a);const c=document.createElement("label");c.innerHTML=this.i18n.IOTHROTTLING_BYTERATE_UNIT||"MiB per sec",c.classList.add("gm-units"),this.readByteRateDiv.appendChild(c),this.readByteRateDiv.appendChild(this.readByteRate),this.submitBtn=document.createElement("button"),this.submitBtn.className="gm-iothrottling-update",this.submitBtn.innerHTML=this.i18n.IOTHROTTLING_UPDATE||"Update",this.submitBtn.onclick=this.sendDataToInstance.bind(this),this.clearCacheBtn=document.createElement("button"),this.clearCacheBtn.className="gm-iothrottling-clearcache",this.clearCacheBtn.innerHTML=this.i18n.IOTHROTTLING_CLEAR_CACHE||"Clear cache",this.clearCacheBtn.onclick=this.clearCache.bind(this);const d=document.createElement("div");d.appendChild(this.clearCacheBtn),this.form.appendChild(t),this.form.appendChild(this.readByteRateDiv),this.form.appendChild(d),this.form.appendChild(this.submitBtn),this.setFieldsReadOnly(!0),this.resetFields("0"),this.displayFields(!1),this.widget.className="gm-overlay gm-iothrottling-plugin gm-hidden";const l=document.createElement("div");l.className="gm-close-btn",l.onclick=this.toggleWidget.bind(this),this.widget.appendChild(l),this.widget.appendChild(this.form),this.instance.root.appendChild(this.widget)}setFieldsReadOnly(e){this.readByteRate.readOnly=e}resetFields(e){e=void 0!==e?e:"",this.readByteRate.value=e}displayFields(e){e?this.readByteRateDiv.classList.remove("gm-hidden"):this.readByteRateDiv.classList.add("gm-hidden")}sendDataToInstance(e){if(e.preventDefault(),this.form.checkValidity()){const e={channel:"diskio",messages:["set readbyterate "+1048576*this.readByteRate.value,"clearcache"]};this.instance.sendEvent(e),this.toggleWidget()}}clearCache(e){e.preventDefault();this.instance.sendEvent({channel:"diskio",messages:["clearcache"]})}changeProfile(){const e=s.find(e=>e.name===this.select.value);e&&"Custom"!==e.name?(this.loadDetails(e),this.displayFields(!0)):e&&"Custom"===e.name?(this.setFieldsReadOnly(!1),this.displayFields(!0)):(this.resetFields("0"),this.displayFields(!1))}updateDiskIOValues(e){if(e=Number(e),Number.isNaN(e)||e<=0)return this.select.value=this.i18n.IOTHROTTLING_PROFILE_NONE||"None",this.resetFields("0"),void this.displayFields(!1);this.readByteRate.value=e;const t=s.find(t=>t.readByteRate===e);t&&"Custom"!==t.name?(this.select.value=t.name,this.loadDetails(t),this.displayFields(!0)):(this.select.value="Custom",this.setFieldsReadOnly(!1),this.displayFields(!0))}loadDetails(e){"Custom"!==e.name&&(this.setFieldsReadOnly(!0),this.readByteRate.value=e.readByteRate)}setActive(e){this.updateDiskIOValues(Number(e)/1024)}}},{"./util/OverlayPlugin":146,"./util/iothrottling-profiles":148}],134:[function(e,t,n){const i=e("./util/OverlayPlugin"),s="0123456789abcdef";t.exports=class Identifiers extends i{static get name(){return"Identifiers"}constructor(e,t){super(e),this.instance=e,this.i18n=t||{},this.instance.identifiers=this,this.invalidAndroidId=!1,this.invalidDeviceId=!1,this.renderToolbarButton(),this.renderWidget(),this.instance.registerEventCallback("settings",e=>{const t=e.split(" ");if("parameter"!==t[0]||t.length<2)return;const n=t[1].match(/(device_id:)(\w+)/);n&&(this.deviceInput.value=n[2]);const i=t[1].match(/(android_id:)(\w+)/);i&&(this.androidInput.value=i[2])})}renderToolbarButton(){const e=this.instance.getChildByClass(this.instance.root,"gm-toolbar");if(!e)return;const t=e.children[0];this.toolbarBtn=document.createElement("li"),this.toolbarBtnImage=document.createElement("div"),this.toolbarBtnImage.className="gm-icon-button gm-identifiers-button",this.toolbarBtnImage.title=this.i18n.IDENTIFIERS_TITLE||"Identifiers",this.toolbarBtn.appendChild(this.toolbarBtnImage),this.toolbarBtn.onclick=this.toggleWidget.bind(this),t.appendChild(this.toolbarBtn)}renderWidget(){this.widget=document.createElement("div"),this.container=document.createElement("div");const e=document.createElement("div");e.className="gm-title",e.innerHTML=this.i18n.IDENTIFIERS_TITLE||"Identifiers",this.container.appendChild(e);const t=document.createElement("div");t.className="gm-inputs";const n=this.generateInput("android","Android ID","",this.generateRandomAndroidId.bind(this),this.validateAndroidId.bind(this)),i=this.generateInput("device","Device ID","(IMEI/MEID)",this.generateRandomDeviceId.bind(this),this.validateDeviceId.bind(this));t.appendChild(n),t.appendChild(i),this.submitBtn=document.createElement("button"),this.submitBtn.innerHTML=this.i18n.IDENTIFIERS_UPDATE||"Update",this.submitBtn.className="gm-action gm-identifiers-update",t.appendChild(this.submitBtn),this.submitBtn.onclick=this.sendDataToInstance.bind(this),this.container.appendChild(t),this.widget.className="gm-overlay gm-identifiers-plugin gm-hidden";const s=document.createElement("div");s.className="gm-close-btn",s.onclick=this.toggleWidget.bind(this),this.widget.appendChild(s),this.widget.appendChild(this.container),this.instance.root.appendChild(this.widget)}sendDataToInstance(e){e.preventDefault();const t=this.androidInput.value,n=this.deviceInput.value;if(t&&this.androidInput.checkValidity()){const e={channel:"framework",messages:["set parameter android_id:"+t]};this.instance.sendEvent(e)}if(n&&this.deviceInput.checkValidity()){const e={channel:"settings",messages:["set parameter device_id:"+n]};this.instance.sendEvent(e)}this.toggleWidget()}generateRandomAndroidId(e){e&&e.preventDefault(),this.androidInput.value=this.generateHash(16,s),this.invalidAndroidId=!1,this.checkErrors()}validateAndroidId(){this.invalidAndroidId=!this.androidInput.checkValidity(),this.checkErrors()}generateRandomDeviceId(e){e&&e.preventDefault(),this.deviceInput.value=this.generateHash(15,"0123456789"),this.invalidDeviceId=!1,this.checkErrors()}validateDeviceId(){this.invalidDeviceId=!this.deviceInput.checkValidity(),this.checkErrors()}checkErrors(){this.androidInput.classList[this.invalidAndroidId?"add":"remove"]("gm-error"),this.deviceInput.classList[this.invalidDeviceId?"add":"remove"]("gm-error"),this.submitBtn.disabled=this.invalidAndroidId||this.invalidDeviceId}generateInput(e,t,n,i,a){const c=document.createElement("div"),d=document.createElement("div"),l=document.createElement("input"),h=document.createElement("button");return d.className="gm-input-group",l.className="gm-identifier-"+e+"-input",l.type="text",l.required=!0,this.instance.addListener(l,"keyup",a),d.appendChild(l),"device"===e?(l.maxLength=15,l.pattern="["+s+"]{14,15}"):"android"===e&&(l.maxLength=16,l.pattern="["+s+"]{16}"),h.className="gm-identifier-"+e+"-generate",h.innerHTML=this.i18n.IDENTIFIERS_GENERATE||"Generate",h.onclick=i,d.appendChild(h),c.className="gm-identifier-"+e,c.innerHTML="<label>"+t+'<i class="gm-description">'+n+"</i></label>",c.appendChild(d),this[e+"Input"]=l,this[e+"Gen"]=h,c}generateHash(e,t){let n="";for(let i=0;i<e;i++)n+=t.charAt(Math.floor(Math.random()*t.length));return n}}},{"./util/OverlayPlugin":146}],135:[function(e,t,n){const i={8:"0x01000003",9:"0x01000001",13:"0x01000005",16:"0x01000020",17:"0x01000021",18:"0x01000023",20:"0x01000024",27:"0x01000000",32:"0x20",33:"0x01000016",34:"0x01000017",35:"0x01000011",36:"0x01000010",37:"0x01000012",38:"0x01000013",39:"0x01000014",40:"0x01000015",45:"0x01000006",46:"0x01000007"},s={67:"0x010000cf",86:"0x010000e2",88:"0x010000d0"};t.exports=class KeyboardEvents{static get name(){return"KeyboardEvents"}constructor(e){this.instance=e,this.instance.keyboardEvents=this,this.isListenerAdded=!1,this.currentlyPressedKeys=new Map,this.instance.store.subscribe(e=>{let{isKeyboardEventsEnabled:t}=e;t?this.addKeyboardCallbacks():this.removeKeyboardCallbacks()},["isKeyboardEventsEnabled"]),this.instance.store.dispatch({type:"KEYBOARD_EVENTS_ENABLED",payload:!0})}cancelAllPressedKeys(){this.currentlyPressedKeys.forEach(e=>{const t={type:"KEYBOARD_RELEASE",keychar:"",keycode:e};this.instance.sendEvent(t)}),this.currentlyPressedKeys.clear()}onKeyPress(e){const t=e.charCode;let n=e.key||String.fromCharCode(t);"Spacebar"===n&&(n=" ");let i={type:"KEYBOARD_PRESS",keychar:n,keycode:t};this.instance.sendEvent(i),i={type:"KEYBOARD_RELEASE",keychar:n,keycode:t},this.instance.sendEvent(i)}onKeyDown(e){let t;if(s[e.keyCode]&&e.ctrlKey)t=parseInt(s[e.keyCode],16);else{if(s[e.keyCode]&&e.metaKey){t=parseInt(s[e.keyCode],16);let n={type:"KEYBOARD_PRESS",keychar:"",keycode:t};return this.instance.sendEvent(n),n={type:"KEYBOARD_RELEASE",keychar:"",keycode:t},this.instance.sendEvent(n),e.preventDefault(),e.stopPropagation(),e.returnValue=!1,!1}if(!i[e.keyCode])return!0;t=parseInt(i[e.keyCode],16)}const n={type:"KEYBOARD_PRESS",keychar:"",keycode:t};return this.instance.sendEvent(n),this.currentlyPressedKeys.set(t,t),e.preventDefault(),e.stopPropagation(),e.returnValue=!1,!1}onKeyUp(e){let t;if(s[e.keyCode]&&e.ctrlKey)t=parseInt(s[e.keyCode],16);else{if(!i[e.keyCode])return!0;t=parseInt(i[e.keyCode],16)}const n={type:"KEYBOARD_RELEASE",keychar:"",keycode:t};return this.instance.sendEvent(n),this.currentlyPressedKeys.delete(t),e.preventDefault(),e.stopPropagation(),e.returnValue=!1,!1}addKeyboardCallbacks(){this.instance.root.tabIndex=0,this.isListenerAdded||(this.removeBlurListener=this.instance.addListener(window,"blur",this.cancelAllPressedKeys.bind(this)),this.keyboardCallbacks||(this.keyboardCallbacks=[{event:"keypress",handler:this.onKeyPress.bind(this),removeListener:null},{event:"keydown",handler:this.onKeyDown.bind(this),removeListener:null},{event:"keyup",handler:this.onKeyUp.bind(this),removeListener:null}]),this.instance.root.focus(),this.keyboardCallbacks.forEach((e,t,n)=>{n[t].removeListener=this.instance.addListener(this.instance.root,e.event,e.handler)}),this.isListenerAdded=!0)}removeKeyboardCallbacks(){this.keyboardCallbacks&&this.isListenerAdded&&(this.removeBlurListener(),this.keyboardCallbacks.forEach(e=>{e.removeListener()}),this.isListenerAdded=!1)}}},{}],136:[function(e,t,n){const{generateUID:i}=e("../utils/helpers");t.exports=class KeyboardMapping{static get name(){return"KeyboardMapping"}constructor(e,t){this.instance=e,this.i18n=t||{},this.instance.KeyboardMapping=this,this.keyboardCallbacks=[],this.sequences={},this.requestToGenerate=[],this.currentlyPressedKeys=[],this.state=new Proxy({isActive:!1,isPaused:!1,mappedKeysConfig:{},workingMappedKeysConfig:{}},{set:(e,t,n)=>{switch(e[t]=n,t){case"isActive":this.activatePlugin();break;case"isPaused":n?(this.toolbarBtnImage.classList.add("keymapping-paused"),this.state.isActive=!1):(this.toolbarBtnImage.classList.remove("keymapping-paused"),this.state.isActive=!0);break;case"mappedKeysConfig":this.setupMappedKeysConfig()}return!0}}),this.instance.store.subscribe(e=>{let{overlay:{isOpen:t}}=e;t&&this.state.isActive?this.state.isPaused=!0:!t&&this.state.isPaused&&(this.state.isPaused=!1)},["overlay.isOpen"]),this.renderToolbarButton(),this.exposedAPI()}renderToolbarButton(){const e=this.instance.getChildByClass(this.instance.root,"gm-toolbar");if(!e)return;const t=e.children[0];this.toolbarBtn=document.createElement("li"),this.toolbarBtnImage=document.createElement("div"),this.toolbarBtnImage.className="gm-icon-button gm-keymapping-button",this.toolbarBtnImage.title=this.i18n.KEYMAPPING_TITLE||"Key Mapping",this.toolbarBtn.onclick=()=>this.state.isActive=!this.state.isActive,this.toolbarBtn.appendChild(this.toolbarBtnImage),t.appendChild(this.toolbarBtn)}activatePlugin(){this.state.isActive?(this.toolbarBtnImage&&this.toolbarBtnImage.classList.add("gm-active"),this.addKeyboardCallbacks(),this.instance.store.dispatch({type:"KEYBOARD_EVENTS_ENABLED",payload:!1}),this.instance.store.dispatch({type:"MOUSE_EVENTS_ENABLED",payload:!1})):(this.toolbarBtnImage&&this.toolbarBtnImage.classList.remove("gm-active"),this.removeKeyboardCallbacks(),this.instance.store.dispatch({type:"KEYBOARD_EVENTS_ENABLED",payload:!this.state.isPaused}),this.instance.store.dispatch({type:"MOUSE_EVENTS_ENABLED",payload:!this.state.isPaused}))}setupMappedKeysConfig(){this.state.workingMappedKeysConfig={},Object.entries(this.state.mappedKeysConfig).forEach(e=>{let[t,n]=e;n.forEach(e=>{const s=i();this.sequences[s]=[];const a="dPad"===t?e.keys:n;Object.values(a).forEach(n=>{this.state.workingMappedKeysConfig[n.key]={...n.effect,key:n.key,type:t,name:e.name,groupId:s}})})}),this.sequences.mouse=[]}cancelAllPressedKeys(){this.releaseAllTouch(),this.state.currentlyPressedKeys=[],Object.keys(this.sequences).forEach(e=>{this.sequences[e]=[]})}generateSequences(e){switch(this.state.workingMappedKeysConfig[e].type){case"dPad":this.generateDPADSequence(e);break;case"tap":this.generateTouchSequence(e);break;case"swipe":this.generateSwipeSequence(e)}}generateDPADSequence(e){var t;const n=this.state.workingMappedKeysConfig[e].groupId;let i=0,s=0;const a=Object.values(this.state.workingMappedKeysConfig).filter(e=>e.groupId===n&&this.currentlyPressedKeys.includes(e.key));i=this.state.workingMappedKeysConfig[e].initialX,s=this.state.workingMappedKeysConfig[e].initialY;const c={x:i,y:s};a.forEach(e=>{this.state.workingMappedKeysConfig[e.key]&&(c.x+=e.distanceX,c.y+=e.distanceY)});const d=null===(t=this.sequences[n])||void 0===t?void 0:t[this.sequences[n].length-1];if(d){const{x:e,y:t}=this.instance.coordinateUtils.calculateCoorToPercent(d.points[0].x,d.points[0].y);i=e,s=t}a.length-1!=0||d||this.sequences[n].push({type:"MULTI_TOUCH",mode:0,nb:1,points:[this.instance.coordinateUtils.calculateCoorFromPercent(i,s)]}),d&&this.sequences[n].push(d);for(let e=0;e<=10;e++){const t=e/10,a=Math.floor(i+t*(c.x-i)),d=Math.floor(s+t*(c.y-s));this.sequences[n].push({type:"MULTI_TOUCH",mode:2,nb:1,points:[this.instance.coordinateUtils.calculateCoorFromPercent(a,d)]})}}generateTouchSequence(e){const t=this.state.workingMappedKeysConfig[e].groupId,n=this.state.workingMappedKeysConfig[e].initialX,i=this.state.workingMappedKeysConfig[e].initialY;this.sequences[t].push({type:"MULTI_TOUCH",mode:0,nb:1,points:[this.instance.coordinateUtils.calculateCoorFromPercent(n,i)]})}generateSwipeSequence(e){const t=this.state.workingMappedKeysConfig[e].groupId,n=this.state.workingMappedKeysConfig[e],i={x:n.initialX,y:n.initialY};this.sequences[t].push({type:"MULTI_TOUCH",mode:0,nb:1,points:[this.instance.coordinateUtils.calculateCoorFromPercent(i.x,i.y)]}),i.x+=n.distanceX,i.y+=n.distanceY,this.sequences[t].push({type:"MULTI_TOUCH",mode:2,nb:1,points:[this.instance.coordinateUtils.calculateCoorFromPercent(i.x,i.y)]})}async mergeSequences(){const e=Object.values(this.sequences),t=e.map(e=>e.length).sort().pop(),n=[];Array.from(Array(t).keys()).forEach(t=>{e.forEach(e=>{e.length&&(e[t]?(n[t]||(n[t]=[]),n[t].push(e[t])):(n[t]||(n[t]=[]),n[t].push(e[e.length-1])))})});const i=[];n.forEach(e=>{i.push({type:"MULTI_TOUCH",nb:e.length,mode:e[0].mode,points:e.reduce((e,t)=>e=[...e,...t.points],[])})});for(let e=0;e<i.length;e++)e%1==0&&0!==e&&await new Promise(e=>setTimeout(e,1)),this.sendEvent(i[e]);Object.entries(this.sequences).forEach(e=>{let[t,n]=e;n.length>0?this.sequences[t]=[n[n.length-1]]:this.sequences[t]=[]})}async onKeyDown(e){const t=e.key;this.state.workingMappedKeysConfig[t]&&(this.currentlyPressedKeys.includes(t)||(this.currentlyPressedKeys.push(t),this.state.workingMappedKeysConfig[t]&&(this.generateSequences(t),await Promise.all(this.requestToGenerate),this.requestToGenerate.push(this.mergeSequences()))))}async onKeyUp(e){const t=e.key;if(!this.state.workingMappedKeysConfig[t])return;const n=this.state.workingMappedKeysConfig[t].groupId;if(this.currentlyPressedKeys.includes(t)&&(this.currentlyPressedKeys=this.currentlyPressedKeys.filter(e=>e!==t)),this.currentlyPressedKeys.length){if(this.currentlyPressedKeys.some(e=>this.state.workingMappedKeysConfig[e].groupId===this.state.workingMappedKeysConfig[t].groupId&&"dPad"===this.state.workingMappedKeysConfig[e].type))return this.generateDPADSequence(t),await Promise.all(this.requestToGenerate),this.requestToGenerate=[],void this.requestToGenerate.push(this.mergeSequences());this.sequences[n]=[],await Promise.all(this.requestToGenerate),this.requestToGenerate.push(this.mergeSequences())}else await this.releaseAllTouch()}async onMouseDown(e){this.sequences.mouse||(this.sequences.mouse=[]),this.sequences.mouse.push({type:"MULTI_TOUCH",mode:0,nb:1,points:[{x:this.instance.coordinateUtils.getXCoordinate(e),y:this.instance.coordinateUtils.getYCoordinate(e)}]}),await Promise.all(this.requestToGenerate),this.requestToGenerate.push(this.mergeSequences())}async onMouseUp(){this.currentlyPressedKeys.length?(await Promise.all(this.requestToGenerate),this.sequences.mouse=[],this.requestToGenerate.push(this.mergeSequences())):await this.releaseAllTouch()}async onMouseMove(e){this.sequences.mouse||(this.sequences.mouse=[]),1===e.buttons&&(this.sequences.mouse.push({type:"MULTI_TOUCH",mode:2,nb:1,points:[{x:this.instance.coordinateUtils.getXCoordinate(e),y:this.instance.coordinateUtils.getYCoordinate(e)}]}),await Promise.all(this.requestToGenerate),this.requestToGenerate.push(this.mergeSequences()))}getTapTouchEvent(e){return this.instance.coordinateUtils.calculateCoorFromPercent(e.x,e.y)}async releaseAllTouch(){await Promise.all(this.requestToGenerate),this.sendEvent({type:"MULTI_TOUCH",nb:0,mode:1,points:[]}),Object.keys(this.sequences).forEach(e=>{this.sequences[e]=[]})}sendEvent(e){this.instance.sendEvent(e)}addKeyboardCallbacks(){this.keyboardCallbacks.length||(this.removeBlurListener=this.instance.addListener(window,"blur",this.cancelAllPressedKeys.bind(this)),this.keyboardCallbacks=[{event:"keydown",handler:this.onKeyDown.bind(this),removeListener:null},{event:"keyup",handler:this.onKeyUp.bind(this),removeListener:null},{event:"mousedown",handler:this.onMouseDown.bind(this),removeListener:null},{event:"mouseup",handler:this.onMouseUp.bind(this),removeListener:null},{event:"mousemove",handler:this.onMouseMove.bind(this),removeListener:null}],this.instance.root.focus(),this.keyboardCallbacks.forEach((e,t,n)=>{n[t].removeListener=this.instance.addListener(this.instance.root,e.event,e.handler)}))}removeKeyboardCallbacks(){this.keyboardCallbacks.length&&(this.removeBlurListener(),this.keyboardCallbacks.forEach(e=>{e.removeListener()}),this.keyboardCallbacks.length=0)}exposedAPI(){var e=this;this.instance.apiManager.registerFunction({name:"setConfig",category:"keyMapping",fn:e=>{try{this.state.mappedKeysConfig=JSON.parse(JSON.stringify(e))}catch(e){throw new Error("Invalid JSON")}this.state.config=e},description:"Submit a config for mapping keys. Please refer to the keyMapping > setConfig section of the README file for details."}),this.instance.apiManager.registerFunction({name:"activeKeyMappingDebug",category:"keyMapping",fn:function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.activateTrace(t),e.activateGrid(n)},description:"Activate debug mode for key mapping. The first parameter enables a feature that shows a div with x, y and x%, y% coordinates on click. The second parameter activates a grid overlay on the screen to assist with key mapping, showing 10% increments of the screen width and height."}),this.instance.apiManager.registerFunction({name:"enable",category:"keyMapping",fn:function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e.state.isActive=t},description:"Enable or disable the keyMapping plugin. Pass true to activate and false to deactivate."})}activateTrace(e){const debug=e=>{const t=this.instance.coordinateUtils.getXCoordinate(e),n=this.instance.coordinateUtils.getYCoordinate(e),i=document.createElement("div");i.style.position="absolute",i.style.left=e.clientX+"px",i.style.top=e.clientY+"px",i.style.width="80px",i.style.height="80px",i.style.padding="10px",i.style.background="red";const s=this.instance.video.getBoundingClientRect(),a=100/(s.width*this.instance.coordinateUtils.getXRatio()/t),c=100/((s.height-2*this.instance.coordinateUtils.getTopBorder())*this.instance.coordinateUtils.getYRatio()/n);i.style.whiteSpace="pre-line";const d=document.createTextNode(`x: ${t}\ny: ${n}\nx%: ${String(a).substring(0,5)}\n\n                y%: ${String(c).substring(0,5)}`);i.appendChild(d),i.onclick=e=>{e.stopPropagation(),i.remove()},document.body.appendChild(i)};e?this.removeDebugListener=this.instance.addListener(window,["click"],debug.bind(this)):(this.removeDebugListener&&this.removeDebugListener(),this.removeDebugListener=null)}activateGrid(e){if(e){const e=this.instance.videoWrapper.getBoundingClientRect(),t=this.instance.video.getBoundingClientRect();this.instance.coordinateUtils.hasLeftAndRightBorders()?t.width=this.instance.video.videoWidth/this.instance.video.videoHeight*t.height:t.height=this.instance.video.videoHeight/this.instance.video.videoWidth*t.width,Array.from(Array(11).keys()).forEach((n,i)=>{const s=document.createElement("div");s.style.position="absolute",s.style.left=i*(.1*t.width)+(e.width-t.width)/2+"px",s.style.top="0px",s.style.width="1px",s.style.height="100%",s.style.background="red",0===i&&(s.style.background="green"),s.classList.add("keyMapping-helping-grid"),this.instance.videoWrapper.appendChild(s)}),Array.from(Array(11).keys()).forEach((e,n)=>{const i=document.createElement("div");i.style.position="absolute",i.style.left="0px",i.style.top=n*(.1*t.height)+this.instance.coordinateUtils.getTopBorder()+"px",i.style.width="100%",i.style.height="1px",i.style.background="red",0===n&&(i.style.background="green"),i.classList.add("keyMapping-helping-grid"),this.instance.videoWrapper.appendChild(i)})}else this.instance.videoWrapper.querySelectorAll(".keyMapping-helping-grid").forEach(e=>{e.remove()})}}},{"../utils/helpers":153}],137:[function(e,t,n){const i=e("loglevel");i.setDefaultLevel("error"),t.exports=class MediaManager{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.options.microphone,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1280,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:720;if(this.instance=e,this.instance.mediaManager=this,!navigator.mediaDevices)return i.error("MediaDevices API unsupported: camera and microphone won't be available."),void(this.instance.mediaEventsEnabled=!1);this.setupPermissions(),this.instance.mediaEventsEnabled=!0,this.videoStreaming=!1,this.audioStreaming=!1,this.videoWidth=n,this.videoHeight=s,this.videoWithMicrophone=t,this.instance.apiManager.registerFunction({name:"mute",category:"media",fn:()=>{this.instance.video.isMuted=!0,this.instance.video.muted=!0},description:"Mute the video by setting the muted property to true. This function silences the audio of the current video instance."}),this.instance.apiManager.registerFunction({name:"unmute",category:"media",fn:()=>{this.instance.video.isMuted=!1,this.instance.video.muted=!1},description:"Unmute the video by setting the muted property to false. This function restores the audio of the current video instance."})}async setupPermissions(){if(!navigator.permissions)return!1;if(this.instance.options.microphone)try{const e=await navigator.permissions.query({name:"microphone"});i.debug("microphone "+e.state),this.microphonePermissionObject=e,this.instance.addListener(e,"change",this.onMicrophonePermissionChange.bind(this))}catch(e){return i.warn("Can't get microphone permission object",e),!1}try{const e=await navigator.permissions.query({name:"camera"});i.debug("camera "+e.state),this.cameraPermissionObject=e,this.instance.addListener(e,"change",this.onCameraPermissionChange.bind(this))}catch(e){return i.warn("Can't get camera permission object",e),!1}return!0}async toggleVideoStreaming(){return this.videoStreaming?this.stopVideoStreaming():this.startVideoStreaming()}async toggleAudioStreaming(){return this.audioStreaming?this.stopAudioStreaming():this.startAudioStreaming()}async startVideoStreaming(){if(!navigator.mediaDevices)return!1;try{const e=await navigator.mediaDevices.getUserMedia({audio:this.videoWithMicrophone,video:{width:this.videoWidth,height:this.videoHeight}});return i.debug("Client video stream ready"),this.videoStreaming=!0,this.localVideoStream=e,this.addVideoStream(e)}catch(e){return this.onVideoStreamError(e),!1}}async startAudioStreaming(){if(!navigator.mediaDevices)return!1;try{const e=await navigator.mediaDevices.getUserMedia({audio:!0,video:!1});i.debug("Client audio stream ready"),this.audioStreaming=!0,this.localAudioStream=e;return await this.addAudioStream(e)}catch(e){return this.onAudioStreamError(e),!1}}onVideoStreamError(e){i.error("Can't start client video stream",e)}onAudioStreamError(e){i.error("Can't start client audio stream",e)}async stopVideoStreaming(){if(!this.videoStreaming)return!1;i.debug("removed local video stream");const e=await this.removeVideoStream(this.localVideoStream);return this.localVideoStream=null,this.videoStreaming=!1,e}async stopAudioStreaming(){if(!this.audioStreaming)return!1;i.debug("removed local audio stream");const e=await this.removeAudioStream(this.localAudioStream);return this.localAudioStream=null,this.audioStreaming=!1,e}onCameraPermissionChange(){window.dispatchEvent(new CustomEvent("gm-cameraPermissionChange"))}onMicrophonePermissionChange(){window.dispatchEvent(new CustomEvent("gm-microphopnePermissionChange"))}setTransceiverDirection(e,t){this.instance.peerConnection.getTransceivers().forEach(n=>{n.sender===e&&(n.direction=t)})}async addAudioStream(e){if(!this.instance.peerConnection)return i.error("Could not add audio stream: connection is not ready"),!1;try{this.instance.options.microphone&&e.getAudioTracks().length>0&&(this.microphoneSender?(i.debug("Replacing audio track on sender"),await this.microphoneSender.replaceTrack(e.getAudioTracks()[0]),this.setTransceiverDirection(this.microphoneSender,"sendrecv")):this.microphoneSender=this.instance.peerConnection.addTrack(e.getAudioTracks()[0],e))}catch(e){return i.error(e),!1}return this.instance.renegotiateWebRTCConnection()}async addVideoStream(e){return this.instance.peerConnection?(e.getVideoTracks().length>0&&(this.cameraSender?(i.debug("Replacing video track on sender"),this.cameraSender.replaceTrack(e.getVideoTracks()[0]),this.setTransceiverDirection(this.cameraSender,"sendrecv")):this.cameraSender=this.instance.peerConnection.addTrack(e.getVideoTracks()[0],e)),this.videoWithMicrophone&&e.getAudioTracks().length>0&&(this.microphoneSender?(i.debug("Replacing audio track on sender"),this.microphoneSender.replaceTrack(e.getAudioTracks()[0]),this.setTransceiverDirection(this.microphoneSender,"sendrecv")):this.microphoneSender=this.instance.peerConnection.addTrack(e.getAudioTracks()[0],e)),this.instance.renegotiateWebRTCConnection()):(i.error("Could not add video stream: connection is not ready"),!1)}async removeAudioStream(e){return this.instance.peerConnection?e instanceof MediaStream&&(e.getTracks().forEach(e=>{e.stop()}),this.microphoneSender&&this.instance.peerConnection.removeTrack(this.microphoneSender),this.instance.renegotiateWebRTCConnection()):(i.error("Could not remove audio stream: connection is not ready"),!1)}async removeVideoStream(e){return this.instance.peerConnection?e instanceof MediaStream&&(e.getTracks().forEach(e=>{e.stop()}),this.cameraSender&&this.instance.peerConnection.removeTrack(this.cameraSender),this.microphoneSender&&this.videoWithMicrophone&&this.instance.peerConnection.removeTrack(this.microphoneSender),this.instance.renegotiateWebRTCConnection()):(i.error("Could not remove video stream: connection is not ready"),!1)}disconnect(){this.audioStreaming&&this.stopAudioStreaming(),this.videoStreaming&&this.stopVideoStreaming(),this.cameraSender=null,this.microphoneSender=null}}},{loglevel:99}],138:[function(e,t,n){t.exports=class MouseEvents{static get name(){return"MouseEvents"}constructor(e){this.instance=e,this.instance.mouseEvents=this,this.instance.mouseEventsEnabled=!0,this.leftButtonPressed=!1,this.boundEventListener=this.releaseAtPreviousPositionEvent.bind(this),this.removeMouseUpListener=()=>{},this.instance.store.subscribe(e=>{let{isMouseEventsEnabled:t}=e;t?this.addMouseCallbacks():this.removeMouseCallbacks()},["isMouseEventsEnabled"]),this.mouseCallbacks=[],this.instance.store.dispatch({type:"MOUSE_EVENTS_ENABLED",payload:!0})}onMousePressEvent(e){if(this.instance.video.muted=!this.instance.mediaManager.isMuted&&this.instance.video.muted,0!==e.button)return;e.preventDefault(),e.stopPropagation(),this.leftButtonPressed=!0,this.instance.x=this.instance.coordinateUtils.getXCoordinate(e),this.instance.y=this.instance.coordinateUtils.getYCoordinate(e);let t="";t=e.ctrlKey||e.metaKey?{type:"FAKE_MULTI_TOUCH_PRESS",mode:e.shiftKey?2:1,x:this.instance.x,y:this.instance.y}:{type:"MOUSE_PRESS",x:this.instance.x,y:this.instance.y},this.instance.sendEvent(t),this.removeMouseUpListener=this.instance.addListener(document,"mouseup",this.boundEventListener,!1)}onMouseReleaseEvent(e){if(0!==e.button)return;e.preventDefault(),e.stopPropagation(),this.leftButtonPressed=!1,this.instance.x=this.instance.coordinateUtils.getXCoordinate(e),this.instance.y=this.instance.coordinateUtils.getYCoordinate(e);let t="";t=e.ctrlKey||e.metaKey?{type:"FAKE_MULTI_TOUCH_RELEASE",mode:e.shiftKey?2:1,x:this.instance.x,y:this.instance.y}:{type:"MOUSE_RELEASE",x:this.instance.x,y:this.instance.y},this.instance.sendEvent(t),this.removeMouseUpListener()}releaseAtPreviousPositionEvent(e){if(0!==e.button)return;e.preventDefault(),e.stopPropagation(),this.leftButtonPressed=!1;const t={type:e.ctrlKey||e.metaKey?"FAKE_MULTI_TOUCH_RELEASE":"MOUSE_RELEASE",x:this.instance.x,y:this.instance.y};this.instance.sendEvent(t),this.removeMouseUpListener()}onMouseMoveEvent(e){if(!this.leftButtonPressed)return;e.preventDefault(),e.stopPropagation(),this.instance.x=this.instance.coordinateUtils.getXCoordinate(e),this.instance.y=this.instance.coordinateUtils.getYCoordinate(e);const t={type:"MOUSE_MOVE",x:this.instance.x,y:this.instance.y};this.instance.sendEvent(t)}onMouseWheelEvent(e){e.preventDefault(),e.stopPropagation(),this.instance.x=this.instance.coordinateUtils.getXCoordinate(e),this.instance.y=this.instance.coordinateUtils.getYCoordinate(e);const t=this.getWheelDeltaPixels(e.deltaY,e.deltaMode),n={type:"WHEEL",x:this.instance.x,y:this.instance.y,delta:t};this.instance.sendEvent(n)}cancelContextMenu(e){e.preventDefault(),e.stopPropagation(),e.returnValue=!1}addMouseCallbacks(){this.mouseCallbacks.length||(this.mouseCallbacks=[{event:"mousedown",handler:this.onMousePressEvent.bind(this),removeListener:null},{event:"mouseup",handler:this.onMouseReleaseEvent.bind(this),removeListener:null},{event:"mousemove",handler:this.onMouseMoveEvent.bind(this),removeListener:null},{event:"wheel",handler:this.onMouseWheelEvent.bind(this),removeListener:null,options:{passive:!1}},{event:"contextmenu",handler:this.onMouseWheelEvent.bind(this),removeListener:null}],this.mouseCallbacks.forEach((e,t,n)=>{n[t].removeListener=this.instance.addListener(this.instance.videoWrapper,e.event,e.handler,e.options)}))}removeMouseCallbacks(){this.mouseCallbacks.length&&(this.mouseCallbacks.forEach(e=>{e.removeListener()}),this.mouseCallbacks.length=0)}getWheelDeltaPixels(e,t){let n=1*e;return n&&t&&(n*=1===t?40:800),n}}},{}],139:[function(e,t,n){t.exports=class MultiTouchEvents{static get name(){return"MultiTouchEvents"}constructor(e){this.instance=e,this.instance.touchEvents=this,this.instance.touchEventsEnabled=!0}onScreenTouchStart(e){e.preventDefault(),e.stopPropagation();const t={type:"MULTI_TOUCH",nb:e.targetTouches.length,mode:0,points:[]};for(let n=0;n<e.targetTouches.length;n++){const i=e.targetTouches[n];this.instance.x=this.instance.coordinateUtils.getXCoordinate(i),this.instance.y=this.instance.coordinateUtils.getYCoordinate(i),t.points.push({x:this.instance.x,y:this.instance.y})}this.instance.sendEvent(t)}onScreenTouchMove(e){e.preventDefault(),e.stopPropagation();const t={type:"MULTI_TOUCH",nb:e.targetTouches.length,mode:2,points:[]};for(let n=0;n<e.targetTouches.length;n++){const i=e.targetTouches[n];this.instance.x=this.instance.coordinateUtils.getXCoordinate(i),this.instance.y=this.instance.coordinateUtils.getYCoordinate(i),t.points.push({x:this.instance.x,y:this.instance.y})}this.instance.sendEvent(t)}onScreenTouchEnd(e){e.preventDefault(),e.stopPropagation();const t={type:"MULTI_TOUCH",nb:e.targetTouches.length,mode:1,points:[]};for(let n=0;n<e.targetTouches.length;n++){const i=e.targetTouches[n];this.instance.x=this.instance.coordinateUtils.getXCoordinate(i),this.instance.y=this.instance.coordinateUtils.getYCoordinate(i),t.points.push({x:this.instance.x,y:this.instance.y})}this.instance.sendEvent(t)}addTouchCallbacks(){this.instance.addListener(this.instance.videoWrapper,"touchstart",this.onScreenTouchStart.bind(this),!1),this.instance.addListener(this.instance.videoWrapper,"touchend",this.onScreenTouchEnd.bind(this),!1),this.instance.addListener(this.instance.videoWrapper,"touchmove",this.onScreenTouchMove.bind(this),!1)}}},{}],140:[function(e,t,n){const i=e("loglevel");i.setDefaultLevel("error");const s=e("./util/OverlayPlugin"),a=e("./util/network-profiles"),c=e("./util/network-mobile-profiles"),d=e("./util/mobile-signal-strength");t.exports=class Network extends s{static get name(){return"Network"}constructor(e,t){super(e),this.instance=e,this.instance.network=this,this.i18n=t||{},this.mobilethrottling=!1,this.fields={},this.renderToolbarButton(),this.renderWidget(),this.mobileThrottlingConfigured=!1,this.network5GConfigured=!1,this.wifiInputChecked=!0,this.mobileInputChecked=!0,this.instance.registerEventCallback("settings",this.handleSettings.bind(this)),this.instance.registerEventCallback("network_profile",this.handleNetworkProfile.bind(this))}enableMobileThrottling(){if(this.mobileThrottlingConfigured)return;this.mobilethrottling=!0;const e=document.createElement("div");this.wifiInput=document.createElement("input"),this.wifiStatus=document.createElement("div"),e.className="gm-checkbox-group",this.wifiInput.type="checkbox",this.wifiInput.className="gm-checkbox",this.wifiInput.name="wifi-checkbox",this.wifiInput.onchange=this.toggleWifiState.bind(this),this.wifiInput.checked=this.wifiInputChecked,this.wifiStatus.className="gm-checkbox-label",this.wifiStatus.innerHTML="Wifi",e.appendChild(this.wifiInput),e.appendChild(this.wifiStatus),this.wifiGroupSection.className="gm-section",this.wifiGroupSection.appendChild(e);const t=document.createElement("div");this.mobileInput=document.createElement("input"),this.mobileStatus=document.createElement("div"),t.className="gm-checkbox-group",this.mobileInput.type="checkbox",this.mobileInput.className="gm-checkbox",this.mobileInput.name="mobile-checkbox",this.mobileInput.onchange=this.toggleMobileState.bind(this),this.mobileInput.checked=this.mobileInputChecked,this.mobileStatus.className="gm-checkbox-label",this.mobileStatus.innerHTML="Mobile data",t.appendChild(this.mobileInput),t.appendChild(this.mobileStatus),this.mobileGroupSection.appendChild(t);const n=document.createElement("div");n.className="input_label",n.innerHTML="Network type:",this.profileInputs.appendChild(n),this.selectMobileProfile=document.createElement("select"),this.selectMobileProfile.name="select-mobile-profile",this.selectMobileProfile.onchange=this.changeMobileProfile.bind(this),c.slice().reverse().forEach(e=>{if("5g"===e.name)return;const t=new Option(e.label,e.name);this.selectMobileProfile.add(t)}),this.profileInputs.appendChild(this.selectMobileProfile);const i=document.createElement("div");i.className="input_label",i.innerHTML="Signal strength:",this.inputMobileSignalStrength.appendChild(i),this.selectMobileSignalStrength=document.createElement("select"),this.selectMobileSignalStrength.name="select-mobile-signal-strength",this.selectMobileSignalStrength.onchange=this.changeMobileSignalStrength.bind(this),this.inputMobileSignalStrength.appendChild(this.selectMobileSignalStrength),d.slice().reverse().forEach(e=>{const t=new Option(e.label,e.name);this.selectMobileSignalStrength.add(t)}),this.updateMobileSectionStatus(),this.mobileThrottlingConfigured=!0}disableMobileThrottling(){if(this.mobileThrottlingConfigured)return;this.mobilethrottling=!1,this.selectProfile=document.createElement("select"),this.selectProfile.name="select-profile";const e=new Option(this.i18n.NETWORK_DELECT_PROFILE||"Select a profile");this.selectProfile.add(e),this.selectProfile.onchange=this.changeProfile.bind(this),a.slice().reverse().forEach(e=>{const t=new Option(e.label,e.name);this.selectProfile.add(t)}),this.profileInputs.appendChild(this.selectProfile),this.mobileThrottlingConfigured=!0}enable5G(){if(this.network5GConfigured)return;const e=c.at(0),t=new Option(e.label,e.name);this.selectMobileProfile.add(t),this.network5GConfigured=!0}disable5G(){this.network5GConfigured||(this.network5GConfigured=!0)}handleSettings(e){const t=e.split(" ");if("if"===t[0]){if(this.wifiInput&&(this.wifiInput.disabled=!1),this.mobileInput&&(this.mobileInput.disabled=!1),3!==t.length)return;const e=t[1].match(/(wifi:)(\w+)/);e&&(this.wifiInputChecked="on"===e[2]);const n=t[2].match(/(mobile:)(\w+)/);n&&(this.mobileInputChecked="on"===n[2]),this.wifiInput&&(this.wifiInput.checked=this.wifiInputChecked),this.mobileInput&&(this.mobileInput.checked=this.mobileInputChecked),this.updateMobileSectionStatus()}}handleNetworkProfile(e){const t=e.split(" ");if(!this.mobilethrottling&&(t.length<9||"phone"===t[1]))return;if(this.mobilethrottling&&(t.length<11||"wifi"===t[1]))return;const n=t[2].split(":"),i=t[3].split(":"),s=t[4].split(":"),c=t[5].split(":"),d=t[6].split(":"),l=t[7].split(":"),h=t[8].split(":");if(this.mobilethrottling){const e=t[9].split(":"),a=t[10].split(":");this.setActiveMobileProfile(e[1]),this.setActiveSignalStrength(a[1]),this.updateDetail("downSpeed",i[2]+" b/s","disabled"===i[1]||!this.mobileInput.checked),this.updateDetail("upSpeed",n[2]+"b/s","disabled"===n[1]||!this.mobileInput.checked),this.updateDetail("downDelay",c[2]+" s","disabled"===c[1]||!this.mobileInput.checked),this.updateDetail("upDelay",s[2]+" s","disabled"===s[1]||!this.mobileInput.checked),this.updateDetail("downPacketLoss",l[2]+" %","disabled"===l[1]||!this.mobileInput.checked),this.updateDetail("upPacketLoss",d[2]+" %","disabled"===d[1]||!this.mobileInput.checked),this.updateDetail("dnsDelay",h[2]+" s","disabled"===h[1]||!this.mobileInput.checked)}else{const e="enabled"===n[1]&&"enabled"===i[1]&&"enabled"===s[1]&&"enabled"===c[1]&&"enabled"===d[1]&&"enabled"===l[1]&&"enabled"===h[1],t=a.find(e=>e.downSpeed.value===parseFloat(i[2])&&e.downDelay.value===parseFloat(c[2])&&e.downPacketLoss.value===parseFloat(l[2])&&e.upSpeed.value===parseFloat(n[2])&&e.upDelay.value===parseFloat(s[2])&&e.upPacketLoss.value===parseFloat(d[2])&&e.dnsDelay.value===parseFloat(h[2]));this.selectProfile.value=t&&e?t.name:this.i18n.NETWORK_DELECT_PROFILE||"Select a profile"}}renderToolbarButton(){const e=this.instance.getChildByClass(this.instance.root,"gm-toolbar");if(!e)return;const t=e.children[0];this.toolbarBtn=document.createElement("li"),this.toolbarBtnImage=document.createElement("div"),this.toolbarBtnImage.className="gm-icon-button gm-network-button",this.toolbarBtnImage.title=this.i18n.NETWORK_TITLE||"Network",this.toolbarBtn.appendChild(this.toolbarBtnImage),this.toolbarBtn.onclick=this.toggleWidget.bind(this),t.appendChild(this.toolbarBtn)}renderWidget(){this.widget=document.createElement("div"),this.form=document.createElement("form");const e=document.createElement("div");e.className="gm-title",e.innerHTML=this.i18n.NETWORK_TITLE||"Network",this.form.appendChild(e),this.wifiGroupSection=document.createElement("div"),this.form.appendChild(this.wifiGroupSection),this.mobileGroupSection=document.createElement("div"),this.form.appendChild(this.mobileGroupSection),this.profileInputs=document.createElement("div"),this.profileInputs.className="gm-inputs",this.form.appendChild(this.profileInputs),this.inputMobileSignalStrength=document.createElement("div"),this.inputMobileSignalStrength.className="gm-inputs",this.form.appendChild(this.inputMobileSignalStrength),this.profileDetails=document.createElement("div"),this.profileDetails.className="gm-profile-details gm-hidden",this.profileDetails.appendChild(this.createDetailsSection("Download speed","downSpeed")),this.profileDetails.appendChild(this.createDetailsSection("Upload speed","upSpeed")),this.profileDetails.appendChild(this.createDetailsSection("Download delay","downDelay")),this.profileDetails.appendChild(this.createDetailsSection("Upload delay","upDelay")),this.profileDetails.appendChild(this.createDetailsSection("Download packet loss","downPacketLoss")),this.profileDetails.appendChild(this.createDetailsSection("Upload packet loss","upPacketLoss")),this.profileDetails.appendChild(this.createDetailsSection("DNS Delay","dnsDelay")),this.form.appendChild(this.profileDetails),this.widget.className="gm-overlay gm-network-plugin gm-hidden";const t=document.createElement("div");t.className="gm-close-btn",t.onclick=this.toggleWidget.bind(this),this.widget.appendChild(t),this.widget.appendChild(this.form),this.instance.root.appendChild(this.widget)}changeProfile(){const e=a.find(e=>e.name===this.selectProfile.value);e?(this.loadDetails(e),this.profileDetails.classList.remove("gm-hidden"),this.sendDataToInstance()):this.profileDetails.classList.add("gm-hidden")}sendDataToInstance(){const e=a.find(e=>e.name===this.selectProfile.value);if(e){const t=[];0===e.id?t.push("disable wifi all"):(t.push("enable wifi all"),t.push("set wifi up_rate "+e.upSpeed.value),t.push("set wifi down_rate "+e.downSpeed.value),t.push("set wifi up_delay "+e.upDelay.value),t.push("set wifi down_delay "+e.downDelay.value),t.push("set wifi up_pkt_loss "+e.upPacketLoss.value),t.push("set wifi down_pkt_loss "+e.downPacketLoss.value),t.push("set wifi dns_delay "+e.dnsDelay.value));const n={channel:"network_profile",messages:t};this.instance.sendEvent(n)}}changeMobileProfile(){const e=c.find(e=>e.name===this.selectMobileProfile.value);if(e){const t=[];t.push("setprofile mobile "+e.name);const n={channel:"network_profile",messages:t};this.instance.sendEvent(n)}else i.error("Selected profile not found")}changeMobileSignalStrength(){const e=d.find(e=>e.name===this.selectMobileSignalStrength.value);if(e){const t=[];t.push("setsignalstrength mobile "+e.name);const n={channel:"network_profile",messages:t};this.instance.sendEvent(n)}else i.error("Selected signalStrength not found")}toggleWifiState(){this.wifiInput.disabled=!0;const e=[];this.wifiInput.checked?e.push("enableif wifi"):e.push("disableif wifi");const t={channel:"settings",messages:e};this.instance.sendEvent(t)}toggleMobileState(){this.mobileInput.disabled=!0,this.updateMobileSectionStatus();const e=[];this.mobileInput.checked?e.push("enableif mobile"):e.push("disableif mobile");const t={channel:"settings",messages:e};this.instance.sendEvent(t);this.instance.sendEvent({channel:"network_profile",messages:["notify phone"]})}updateMobileSectionStatus(){this.selectMobileProfile&&(this.selectMobileProfile.disabled=!this.mobileInput.checked),this.selectMobileSignalStrength&&(this.selectMobileSignalStrength.disabled=!this.mobileInput.checked)}createDetailsSection(e,t){const n=document.createElement("section");return this.fields[t]=document.createElement("span"),n.innerHTML=e+": ",n.appendChild(this.fields[t]),n}loadDetails(e){Object.entries(e).forEach(e=>{let[t,n]=e;"label"!==t&&"name"!==t&&"id"!==t&&(this.fields[t].innerHTML=n.label)})}setActiveProfile(e){const t=a.find(t=>t.id===Number(e));if(!t||!String(e).length)return;const n=this.selectProfile.getElementsByTagName("option");for(let e=0;e<n.length;e++){const i=n[e];i.value===t.name&&(i.selected="selected")}this.loadDetails(t)}setActiveMobileProfile(e){if(!e)return void i.error("setActiveMobileProfile: Error : provided profile is empty");const t=c.find(t=>t.name===e);if(!t)return void i.error("setActiveMobileProfile: Error : unknown provided profile");const n=this.selectMobileProfile.getElementsByTagName("option");for(let e=0;e<n.length;e++){const i=n[e];if(i.value===t.name){i.selected="selected";break}}}setActiveSignalStrength(e){if(!e)return void i.error("setActiveSignalStrength: Error : provided strength is empty");const t=d.find(t=>t.name===e);if(!t)return void i.error("setActiveSignalStrength: Error : unknown provided strength");const n=this.selectMobileSignalStrength.getElementsByTagName("option");for(let e=0;e<n.length;e++){const i=n[e];if(i.value===t.name){i.selected="selected";break}}}updateDetail(e,t,n){this.fields[e].innerHTML=n?"":t}}},{"./util/OverlayPlugin":146,"./util/mobile-signal-strength":149,"./util/network-mobile-profiles":150,"./util/network-profiles":151,loglevel:99}],141:[function(e,t,n){t.exports=class PeerConnectionStats{constructor(e,t,n){this.instance=e,this.instance.peerConnectionStats=this,this.connection=t,this.timeoutID=setTimeout(()=>{this.connection.getStats(null).then(e=>{e.forEach(t=>{if("video"===t.kind){if("inbound-rtp"===t.type){const n=e.get(t.codecId);n&&this.logAndBroadcast("codec",n.mimeType)}"track"===t.type&&(this.logAndBroadcast("width",t.frameWidth),this.logAndBroadcast("height",t.frameHeight),this.logAndBroadcast("jitter",Math.round(t.jitterBufferDelay/t.jitterBufferEmittedCount*1e3)))}if("candidate-pair"===t.type&&"succeeded"===t.state){this.logAndBroadcast("rtt",1e3*t.currentRoundTripTime);const n=e.get(t.localCandidateId);this.hideDefaultTurnWarning(),n&&"relay"===n.candidateType?(this.logAndBroadcast("turn",!0),this.instance.options.turn.default?(this.logAndBroadcast("default",!0),this.displayDefaultTurnWarning()):this.logAndBroadcast("default",!1)):this.logAndBroadcast("turn",!1)}})})},n)}logAndBroadcast(e,t){this.instance.dispatchEvent(e,{msg:t})}displayDefaultTurnWarning(){let e="<h1><span>&#9888;</span> Using a default TURN</h1>Performance is not optimal.";const t=document.createElement("a");t.classList.add("gm-default-turn-button"),t.classList.add("gm-icon-button");const n=document.createElement("div");n.className="gm-default-turn-used gm-hidden",this.instance.options.connectionFailedURL&&(e+="<br>Click on the icon to learn more.",t.href=this.instance.options.connectionFailedURL,t.target="_blank"),n.innerHTML=e,t.appendChild(n),t.onmouseenter=()=>{n.classList.remove("gm-hidden")},t.onmouseleave=()=>{n.classList.add("gm-hidden")};this.instance.getChildByClass(this.instance.root,"gm-toolbar").appendChild(t)}hideDefaultTurnWarning(){const e=this.instance.getChildByClass(this.instance.root,"gm-default-turn-button");e&&e.remove()}destroy(){clearTimeout(this.timeoutID),delete this.connection,delete this.instance}}},{}],142:[function(e,t,n){const i=e("./util/OverlayPlugin");t.exports=class Phone extends i{static get name(){return"Phone"}constructor(e,t){super(e),this.instance=e,this.i18n=t||{},this.instance.phone=this,this.renderToolbarButton(),this.renderWidget()}renderToolbarButton(){const e=this.instance.getChildByClass(this.instance.root,"gm-toolbar");if(!e)return;const t=e.children[0];this.toolbarBtn=document.createElement("li"),this.toolbarBtnImage=document.createElement("div"),this.toolbarBtnImage.className="gm-icon-button gm-phone-button",this.toolbarBtnImage.title=this.i18n.PHONE_TITLE||"Phone",this.toolbarBtn.appendChild(this.toolbarBtnImage),this.toolbarBtn.onclick=this.toggleWidget.bind(this),t.appendChild(this.toolbarBtn)}renderWidget(){this.widget=document.createElement("div"),this.container=document.createElement("div");const e=document.createElement("div");e.className="gm-title",e.innerHTML=this.i18n.PHONE_TITLE||"Phone",this.container.appendChild(e);const t=document.createElement("div");t.className="gm-inputs";const n=document.createElement("div");this.phoneInput=document.createElement("input"),this.phoneBtn=document.createElement("button"),this.phoneInput.type="text",this.phoneInput.className="gm-phone-number",this.phoneInput.placeholder=this.i18n.PHONE_CALL_PLACEHOLDER||"Please enter the phone number",this.instance.addListener(this.phoneInput,"keyup",this.validate.bind(this)),this.phoneBtn.className="gm-phone-call",this.phoneBtn.innerHTML=this.i18n.PHONE_CALL||"Call",this.phoneBtn.onclick=this.sendPhoneCallToInstance.bind(this),this.phoneBtn.disabled=!0;const i=this.i18n.PHONE_INCOMING||"Incoming phone number";n.innerHTML="<label>"+i+"</label>",n.className="gm-phone-group",n.appendChild(this.phoneInput),n.appendChild(this.phoneBtn),t.appendChild(n);const s=document.createElement("div");this.textInput=document.createElement("textarea"),this.textBtn=document.createElement("button"),this.textInput.className="gm-phone-message",this.textInput.placeholder=this.i18n.PHONE_MESSAGE_PLACEHOLDER||"Please enter the incoming message",this.textInput.rows=5,this.instance.addListener(this.textInput,"keyup",this.validate.bind(this)),this.textBtn.className="gm-phone-send",this.textBtn.innerHTML=this.i18n.PHONE_MESSAGE||"Send message",this.textBtn.onclick=this.sendSMSToInstance.bind(this),this.textBtn.disabled=!0;const a=this.i18n.PHONE_MESSAGE_VALUE||"Message";s.innerHTML="<label>"+a+"</label>",s.className="gm-phone-group",s.appendChild(this.textInput),s.appendChild(this.textBtn),t.appendChild(s),this.container.appendChild(t),this.widget.className="gm-overlay gm-phone-plugin gm-hidden";const c=document.createElement("div");c.className="gm-close-btn",c.onclick=this.toggleWidget.bind(this),this.widget.appendChild(c),this.widget.appendChild(this.container),this.instance.root.appendChild(this.widget)}validatePhoneNumber(){return this.phoneInput.value.match(/^(\+[0-9]{1,14}|[0-9]{1,16})$/g)}sendPhoneCallToInstance(e){if(e&&e.preventDefault(),!this.validatePhoneNumber())return;const t={channel:"baseband",messages:["gsm call "+this.phoneInput.value]};this.instance.sendEvent(t),this.toggleWidget()}validateSMSText(){return this.textInput.value.length>0}sendSMSToInstance(e){if(e&&e.preventDefault(),!this.validatePhoneNumber()||!this.validateSMSText())return;const t={channel:"baseband",messages:["sms send "+this.phoneInput.value+" "+this.textInput.value]};this.instance.sendEvent(t),this.toggleWidget()}validate(){const e=this.validatePhoneNumber(),t=this.validateSMSText()&&e;return this.phoneBtn.disabled=!e,this.textBtn.disabled=!t,t}}},{"./util/OverlayPlugin":146}],143:[function(e,t,n){const i=e("./util/OverlayPlugin"),s=e("loglevel");s.setDefaultLevel("error");t.exports=class Screencast extends i{static get name(){return"Screencast"}constructor(e,t){super(e),this.instance=e,this.i18n=t||{},this.instance.screencast=this,this.renderToolbarButton(),this.renderWidget(),this.recordedBlobs=[],this.mediaRecorder=null,this.isRecording=!1,this.startTime=0,this.displayInterval=null}handleDataAvailable(e){e.data&&e.data.size>0&&this.recordedBlobs.push(e.data)}getExtensionFromMimeType(e){let t={"video/x-msvideo":".avi","video/mpeg":".mpeg","video/ogg":".ogv","video/webm":".webm","video/3gpp":".3gp","video/3gpp2":".3g2","video/mp4":".mp4","video/x-matroska":".mkv","video/x-flv":".f4v"}[e.toLowerCase()];return t||(s.warn("Unknown MIME type: ",e),t=".webm"),t}downloadScreencast(){const e=new Blob(this.recordedBlobs,{type:this.mediaRecorder.mimeType}),t=window.URL.createObjectURL(e),n=document.createElement("a");n.style.display="none",n.href=t,n.download="device"+this.getExtensionFromMimeType(this.mediaRecorder.mimeType),document.body.appendChild(n),n.click(),setTimeout(()=>{document.body.removeChild(n),window.URL.revokeObjectURL(t)},100),this.isRecording=!1}checkForMediarecorder(){"undefined"==typeof MediaRecorder&&(this.screencast.classList.add("disabled"),this.screencastBtn.title=this.i18n.SCREENCAST_NOMEDIARECORDER_TOOLTIP||"Screencast not supported")}displayTimer(){this.timer.classList.contains("gm-timer-hidden")&&(this.timer.classList.remove("gm-timer-hidden"),this.displayInterval=setInterval(this.displayTimer.bind(this),1e3));let e=new Date-this.startTime;e/=1e3;const t=Math.round(e%60);e=Math.floor(e/60);const n=Math.round(e%60);this.timer.innerHTML=("0"+n).slice(-2)+":"+("0"+t).slice(-2),3===n&&this.stopRecording()}hideTimer(){clearInterval(this.displayInterval),this.timer.classList.add("gm-timer-hidden"),this.timer.innerHTML=""}findBestMimeType(){const e=[];return["video/webm","video/x-matroska","video/mpeg","video/ogg","video/3gpp","video/3gpp2","video/mp4","video/x-flv"].forEach(t=>{MediaRecorder.isTypeSupported(t)&&e.push(t)}),e[0]}startRecording(){try{this.mediaRecorder=new MediaRecorder(this.instance.stream,{mimeType:this.findBestMimeType()})}catch(e){return s.error("Error while creating MediaRecorder: "+e),this.hideTimer(),void this.toolbarBtnImage.classList.remove("gm-screencast-button-recording")}this.recordedBlobs=[],this.isRecording=!0,this.startTime=new Date,this.displayTimer(),this.mediaRecorder.ondataavailable=this.handleDataAvailable.bind(this),this.mediaRecorder.start(50),s.debug("MediaRecorder started",this.mediaRecorder)}stopRecording(){this.mediaRecorder.stop(),this.hideTimer(),this.toolbarBtnImage.classList.remove("gm-screencast-button-recording"),this.downloadScreencast(),s.debug("MediaRecorder stopped",this.mediaRecorder)}renderToolbarButton(){const e=this.instance.getChildByClass(this.instance.root,"gm-toolbar");if(!e)return;const t=e.children[0];this.toolbarBtn=document.createElement("li"),this.toolbarBtnImage=document.createElement("div"),this.toolbarBtnImage.className="gm-icon-button gm-screencast-button",this.toolbarBtnImage.title=this.i18n.SCREENCAST_TITLE||"Screencast",this.timer=document.createElement("div"),this.timer.className="gm-screencast-timer gm-timer-hidden",this.toolbarBtnImage.appendChild(this.timer),this.toolbarBtn.appendChild(this.toolbarBtnImage),this.toolbarBtn.onclick=this.toggleWidget.bind(this),t.appendChild(this.toolbarBtn)}renderWidget(){this.widget=document.createElement("div"),this.form=document.createElement("form");const e=document.createElement("div");e.className="gm-title",e.innerHTML=this.i18n.SCREENCAST_TITLE||"Screencast",this.form.appendChild(e);const t=document.createElement("div");t.className="gm-inputs";const n=document.createElement("div");this.screenshotBtn=document.createElement("div"),this.screenshotBtn.className="gm-action gm-screencast-screenshot",n.onclick=this.onScreenshotClick.bind(this),n.className="gm-horizontal gm-screenshot";const i=this.i18n.SCREENCAST_SCREENSHOT||"Screenshot";n.innerHTML="<label>"+i+"</label>",n.appendChild(this.screenshotBtn),t.appendChild(n),this.screencast=document.createElement("div"),this.screencastBtn=document.createElement("div"),this.screencastBtn.className="gm-action gm-screencast-screencast",this.screencast.onclick=this.onScreencastClick.bind(this),this.screencast.className="gm-horizontal gm-screencast";const s=this.i18n.SCREENCAST_SCREENCAST||"Screencast";this.screencast.innerHTML="<label>"+s+"</label>",this.screencast.appendChild(this.screencastBtn),t.appendChild(this.screencast),this.form.appendChild(t),this.widget.className="gm-overlay gm-screencast-plugin gm-hidden";const a=document.createElement("div");a.className="gm-close-btn",a.onclick=this.toggleWidget.bind(this),this.widget.appendChild(a),this.widget.appendChild(this.form),this.instance.root.appendChild(this.widget)}toggleWidget(e){this.checkForMediarecorder(),this.isRecording?this.stopRecording():(super.toggleWidget(),!0===e&&this.toolbarBtnImage.classList.add("gm-screencast-button-recording"))}onScreenshotClick(e){e.preventDefault(),this.toggleWidget();const t=document.createElement("canvas"),n=t.getContext("2d"),{video:i}=this.instance;if(t.width=i.videoWidth,t.height=i.videoHeight,!(n&&i instanceof HTMLVideoElement))return;n.drawImage(i,0,0,i.videoWidth,i.videoHeight,0,0,i.videoWidth,i.videoHeight);const s=document.createElement("a");s.download="device-screenshot.png",document.body.appendChild(s);let a=t.toDataURL("image/png");a&&(a=a.replace(/^data:image\/[^;]*/,"data:application/octet-stream")),s.href=a,s.click(),setTimeout(()=>{document.body.removeChild(s)},100)}onScreencastClick(){this.isRecording?this.stopRecording():(this.toggleWidget(!0),this.startRecording())}}},{"./util/OverlayPlugin":146,loglevel:99}],144:[function(e,t,n){t.exports=class StreamBitrate{static get name(){return"StreamBitrate"}constructor(e,t){this.instance=e,this.instance.StreamBitrate=this,this.i18n=t||{},this.highQuality=!1,this.renderToolbarButton()}renderToolbarButton(){const e=this.instance.getChildByClass(this.instance.root,"gm-toolbar");if(!e)return;const t=e.children[0],n=document.createElement("li");this.chooser=document.createElement("div"),this.chooser.className=".gm-streamrate-chooser gm-icon-button gm-streamrate-button",this.chooser.title=this.i18n.STREAMRATE_TITLE||"High quality",n.appendChild(this.chooser),t.appendChild(n),this.chooser.onclick=()=>{if(this.highQuality=!this.highQuality,this.chooser.classList.toggle("gm-active"),this.highQuality){const e={type:"BITRATE",videoBitrate:5e3,audioBitrate:192e3};this.instance.sendEvent(e),this.instance.renegotiateWebRTCConnection()}else{const e={type:"BITRATE",videoBitrate:0,audioBitrate:0};this.instance.sendEvent(e),this.instance.renegotiateWebRTCConnection()}}}}},{}],145:[function(e,t,n){const i=[{text:"-",value:"0"},{text:"240p",value:"240"},{text:"360p",value:"360"},{text:"480p",value:"480"},{text:"720p",value:"720"},{text:"1080p",value:"1080"}];t.exports=class StreamResolution{static get name(){return"StreamResolution"}constructor(e,t){this.instance=e,this.instance.StreamResolution=this,this.i18n=t||{},this.renderToolbarButton()}renderToolbarButton(){const e=this.instance.getChildByClass(this.instance.root,"gm-toolbar");if(!e)return;const t=e.children[0];this.select=document.createElement("select"),this.select.className="gm-icon-button gm-streamres-button",this.select.title=this.i18n.STREAMRES_TITLE||"Quality",i.forEach(e=>{this.select.add(new Option(e.text,e.value))}),this.select.onchange=this.onStreamResolutionChange.bind(this),t.appendChild(this.select)}onStreamResolutionChange(){const e={type:"SIZE",width:Number(this.select.value)};this.instance.sendEvent(e),this.select.blur()}}},{}],146:[function(e,t,n){const{generateUID:i}=e("../../utils/helpers");class OverlayPlugin{constructor(e){this.widget=null,this.overlayID=i(),this.toolbarBtnImage=null,this.savedState=null,this.instance=e,this.instance.store.subscribe(e=>{let{overlay:t}=e;t.widgetOpened.includes(this.overlayID)?this.openOverlay():this.closeOverlay()},["overlay.widgetOpened"]),OverlayPlugin.hasBeenCalled||(this.instance.addListener(document,"click",this.clickHandlerCloseOverlay.bind(this)),OverlayPlugin.hasBeenCalled=!0)}closeOverlay(){this.widget&&!this.widget.classList.contains("gm-hidden")&&(this.widget.classList.add("gm-hidden"),this.widget.onclose&&this.widget.onclose()),this.toolbarBtnImage&&this.toolbarBtnImage.classList.remove("gm-active")}openOverlay(){this.widget&&this.widget.classList.contains("gm-hidden")&&this.widget.classList.remove("gm-hidden"),this.toolbarBtnImage&&this.toolbarBtnImage.classList.add("gm-active"),this.instance.store.dispatch({type:"ADD_TRACKED_EVENT",payload:{category:"widget",action:"open",name:this.constructor.name}})}saveState(){this.savedState||(this.savedState={toolbarBtn:{className:this.toolbarBtn.className,onclick:this.toolbarBtn.onclick},toolbarBtnImage:{className:this.toolbarBtnImage.className}})}restoreState(){this.savedState&&(this.toolbarBtn.className=this.savedState.toolbarBtn.className,this.toolbarBtnImage.className=this.savedState.toolbarBtnImage.className,this.toolbarBtn.onclick=this.savedState.toolbarBtn.onclick,this.savedState=null)}disable(){this.toolbarBtn&&this.toolbarBtnImage&&(this.saveState(),this.toolbarBtn.className+=" gm-disabled-widget-pop-up",this.toolbarBtnImage.className+=" gm-disabled-widget-icon",this.toolbarBtn.onclick=null)}enable(){this.toolbarBtn&&this.toolbarBtnImage&&this.restoreState()}toggleWidget(){this.instance.store.dispatch({type:"OVERLAY_OPEN",payload:{overlayID:this.overlayID,toOpen:this.widget.classList.contains("gm-hidden")}})}clickHandlerCloseOverlay(e){null!==e.target.closest(".gm-overlay")||e.target.classList.contains("gm-icon-button")||e.target.classList.contains("gm-dont-close")||!this.instance.store.state.overlay.isOpen||this.instance.store.dispatch({type:"OVERLAY_OPEN",payload:{toOpen:!1}})}}OverlayPlugin.hasBeenCalled=!1,t.exports=OverlayPlugin},{"../../utils/helpers":153}],147:[function(e,t,n){const i={createSwitch:e=>{let{onChange:t}=e;const n=document.createElement("div");n.style.position="relative",n.style.display="inline-block",n.style.width="50px",n.style.height="20px";const i=document.createElement("input");i.type="checkbox",i.style.opacity="0",i.style.width="0",i.style.height="0";const s=document.createElement("span");s.style.position="absolute",s.style.cursor="pointer",s.style.top="0",s.style.left="0",s.style.right="0",s.style.bottom="0",s.style.backgroundColor="#ccc",s.style.transition=".4s",s.style.borderRadius="15px";const a=document.createElement("span");a.style.position="absolute",a.style.content="",a.style.height="30px",a.style.width="30px",a.style.left="-3px",a.style.bottom="-5px",a.style.backgroundColor="white",a.style.transition=".4s",a.style.borderRadius="50%",s.appendChild(a),n.appendChild(i),n.appendChild(s);const setState=e=>{i.checked!==e&&(i.checked=e,i.checked?(s.style.backgroundColor="#E6195E",a.style.transform="translateX(26px)"):(s.style.backgroundColor="#ccc",a.style.transform="translateX(0)"),t&&"function"==typeof t&&t(i.checked))};return s.addEventListener("click",()=>{setState(!i.checked)}),n.setState=setState,n}};t.exports={switchButton:i}},{}],148:[function(e,t,n){t.exports=[{name:"High-end device",label:"High-end device",readByteRate:200},{name:"Mid-range device",label:"Mid-range device",readByteRate:100},{name:"Low-end device",label:"Low-end device",readByteRate:50},{name:"Custom",label:"Custom device"}]},{}],149:[function(e,t,n){t.exports=[{id:4,name:"great",label:"Great"},{id:3,name:"good",label:"Good"},{id:2,name:"moderate",label:"Moderate"},{id:1,name:"poor",label:"Poor"},{id:0,name:"none",label:"None"}]},{}],150:[function(e,t,n){t.exports=[{id:7,name:"5g",label:"5G"},{id:6,name:"lte",label:"4G LTE"},{id:5,name:"hsdpa",label:"3G HSDPA"},{id:4,name:"umts",label:"3G UMTS"},{id:3,name:"edge",label:"2G EDGE"},{id:2,name:"gprs",label:"2G GPRS"},{id:1,name:"gsm",label:"2G GSM"},{id:0,name:"none",label:"Unlimited"}]},{}],151:[function(e,t,n){t.exports=[{id:8,name:"wifi",label:"Wifi",downSpeed:{label:"40.0Mb/s",value:4e4},downDelay:{label:"0ms",value:0},downPacketLoss:{label:"0%",value:0},upSpeed:{label:"33.0Mb/s",value:33e3},upDelay:{label:"0ms",value:0},upPacketLoss:{label:"0%",value:0},dnsDelay:{label:"0ms",value:0}},{id:7,name:"4g_with_loss",label:"4G (High packet losses)",downSpeed:{label:"17.9Mb/s",value:17900},downDelay:{label:"50ms",value:50},downPacketLoss:{label:"10%",value:10},upSpeed:{label:"5.5Mb/s",value:5500},upDelay:{label:"50ms",value:50},upPacketLoss:{label:"10%",value:10},dnsDelay:{label:"100ms",value:100}},{id:6,name:"4g_with_delay",label:"4G (High DNS delay)",downSpeed:{label:"17.9Mb/s",value:17900},downDelay:{label:"50ms",value:50},downPacketLoss:{label:"0.01%",value:.01},upSpeed:{label:"5.5Mb/s",value:5500},upDelay:{label:"50ms",value:50},upPacketLoss:{label:"0.01%",value:.01},dnsDelay:{label:"3000ms",value:3e3}},{id:5,name:"4g",label:"4G",downSpeed:{label:"17.9Mb/s",value:17900},downDelay:{label:"50ms",value:50},downPacketLoss:{label:"0.01%",value:.01},upSpeed:{label:"5.5Mb/s",value:5500},upDelay:{label:"50ms",value:50},upPacketLoss:{label:"0.01%",value:.01},dnsDelay:{label:"100ms",value:100}},{id:4,name:"3g",label:"3G",downSpeed:{label:"7.2Mb/s",value:7200},downDelay:{label:"100ms",value:100},downPacketLoss:{label:"0.01%",value:.01},upSpeed:{label:"1.5Mb/s",value:1500},upDelay:{label:"100ms",value:100},upPacketLoss:{label:"0.01%",value:.01},dnsDelay:{label:"200ms",value:200}},{id:3,name:"edge",label:"EDGE",downSpeed:{label:"240Kb/s",value:240},downDelay:{label:"400ms",value:400},downPacketLoss:{label:"0.01%",value:.01},upSpeed:{label:"200Kb/s",value:200},upDelay:{label:"400ms",value:400},upPacketLoss:{label:"0.01%",value:.01},dnsDelay:{label:"800ms",value:800}},{id:2,name:"gprs",label:"GPRS",downSpeed:{label:"40Kb/s",value:40},downDelay:{label:"500ms",value:500},downPacketLoss:{label:"0.01%",value:.01},upSpeed:{label:"40Kb/s",value:40},upDelay:{label:"500ms",value:500},upPacketLoss:{label:"0.01%",value:.01},dnsDelay:{label:"1000ms",value:1e3}},{id:1,name:"no_data",label:"No data",downSpeed:{label:"0Kb/s",value:0},downDelay:{label:"0ms",value:0},downPacketLoss:{label:"0%",value:0},upSpeed:{label:"0Kb/s",value:0},upDelay:{label:"0ms",value:0},upPacketLoss:{label:"0%",value:0},dnsDelay:{label:"0ms",value:0}},{id:0,name:"native",label:"Native",downSpeed:{label:"N/A",value:1/0},downDelay:{label:"N/A",value:0},downPacketLoss:{label:"N/A",value:0},upSpeed:{label:"N/A",value:1/0},upDelay:{label:"N/A",value:0},upPacketLoss:{label:"N/A",value:0},dnsDelay:{label:"N/A",value:0}}]},{}],152:[function(e,t,n){const{generateUID:i}=e("../utils/helpers"),s=e("loglevel");s.setDefaultLevel("error");const a={isWebRTCConnectionReady:!1,overlay:{isOpen:!1,widgetOpened:[]},isKeyboardEventsEnabled:!1,isMouseEventsEnabled:!1,trackedEvents:{isActive:!1,events:[]}},createStore=(e,t)=>{const n=[],s={isWidgetOpened:t=>e.store.state.overlay.isOpen&&e.store.state.overlay.widgetOpened.includes(t)},findChangedKeys=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=[];const isObject=e=>e&&"object"==typeof e;for(const s in e){const a=[...n,s].join(".");if(Object.prototype.hasOwnProperty.call(t,s))if(isObject(e[s])&&isObject(t[s]))if(Array.isArray(e[s])&&Array.isArray(t[s]))if(e[s].length!==t[s].length)i.push(a);else{let n=!1;for(let i=0;i<e[s].length;i++)e[s][i]!==t[s][i]&&(n=!0);n&&i.push(a)}else i=i.concat(findChangedKeys(e[s],t[s],[...n,s]));else e[s]!==t[s]&&i.push(a);else i.push(a)}return i};e.store={state:a,dispatch:i=>{const s=JSON.parse(JSON.stringify(e.store.state));e.store.state=t({...e.store.state},i);(t=>{n.forEach(n=>{let{keys:i,cb:s}=n;(0===i.length||i.some(e=>((e,t)=>{const n=t.split(".");return e.some(e=>{const t=e.split(".");return n.every((e,n)=>e===t[n])})})(t,e)))&&s({...e.store.state})})})(findChangedKeys(e.store.state,s))},subscribe:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const s=i();n.push({uid:s,keys:t,cb:e});const unsubscribe=()=>{const e=n.findIndex(e=>{let{uid:t}=e;return t===s});e>=0&&n.splice(e,1)};return unsubscribe},getters:s}},reducer=(e,t)=>{switch(t.type){case"WEBRTC_CONNECTION_READY":e.isWebRTCConnectionReady=t.payload;break;case"KEYBOARD_EVENTS_ENABLED":e.isKeyboardEventsEnabled=t.payload;break;case"MOUSE_EVENTS_ENABLED":e.isMouseEventsEnabled=t.payload;break;case"OVERLAY_OPEN":const{overlayID:n,toOpen:i}=t.payload;i?(e.overlay.isOpen=!0,e.overlay.widgetOpened=[n],e.isKeyboardEventsEnabled=!1,e.isMouseEventsEnabled=!1):(e.overlay.isOpen=!1,e.overlay.widgetOpened=[],e.isKeyboardEventsEnabled=!0,e.isMouseEventsEnabled=!0);break;case"ENABLE_TRACKED_EVENTS":e.trackedEvents.isActive=t.payload;break;case"ADD_TRACKED_EVENT":if(!e.trackedEvents.isActive)return e;e.trackedEvents.events.push(t.payload);break;case"FLUSH_TRACKED_EVENTS":e.trackedEvents.events.length=0;break;default:s.debug("Store not updated, action type :",t.type," unknown")}return s.debug("Store updated below type - payload - result",t.type,t.payload,e),e};t.exports=e=>{createStore(e,reducer)}},{"../utils/helpers":153,loglevel:99}],153:[function(e,t,n){t.exports={generateUID:function generateUID(){const e=Date.now().toString(36);return e.substring(e.length-5)+Math.random().toString(36).substring(2,7)}}},{}],154:[function(e,t,n){t.exports=function(){const e=this;this.socket=null,this.token=null,this.hasError=!1,this.isUploading=!1,this.uploadedSize=0,this.file=null,this.address=null,this.MEGABYTE=1e6,e.getChunkSize=function(t){const n=5*e.MEGABYTE,i=75*e.MEGABYTE;return Math.max(n,Math.min(.1*t,i))},e.onOpen=function(){const t={type:"token",token:e.token};e.socket.send(JSON.stringify(t))},e.onClose=function(){setTimeout((function(){e.connect(e.address)}),1e3)},e.connect=function(t){e.socket=new WebSocket(t),e.socket.binaryType="arraybuffer",e.socket.onopen=e.onOpen,e.socket.onerror=e.onFailure,e.socket.onmessage=e.onSocketMsg,e.socket.onclose=e.onClose},e.onFailure=function(){e.isUploading=!1,postMessage({type:"FILE_UPLOAD",code:"FAIL"})},e.uploadData=function(t){!1===e.hasError&&e.socket.send(t.target.result,{binary:!0})},e.onSocketMsg=function(t){const n=JSON.parse(t.data);if("FILE_UPLOAD"===n.type)switch(n.code){case"NEXT":if(e.uploadedSize<e.file.size){const t=e.getChunkSize(e.file.size);let n;const i=new FileReader;i.onload=e.uploadData,i.onabort=e.onFailure,i.onerror=e.onFailure,e.file.size-e.uploadedSize>t?(n=e.file.slice(e.uploadedSize,e.uploadedSize+t),e.uploadedSize+=t):(n=e.file.slice(e.uploadedSize),e.uploadedSize=e.file.size),i.readAsArrayBuffer(n)}else{const t={type:"FILE_UPLOAD",done:!0};e.socket.send(JSON.stringify(t)),e.isUploading=!1}break;case"PROGRESS":case"SUCCESS":postMessage(n);break;case"FAIL":e.hasError=!0,postMessage(n)}},e.onmessage=function(t){const n=t.data;switch(n.type){case"address":e.token=n.token,e.address=n.fileUploadAddress,e.connect(e.address);break;case"close":e.isUploading=!1,e.socket&&(e.socket.onclose=null,e.socket.close());break;case"upload":if(!e.isUploading){e.file=n.file,e.isUploading=!0,e.hasError=!1,e.uploadedSize=0;const t={type:"FILE_UPLOAD",name:e.file.name,size:e.file.size};e.socket.send(JSON.stringify(t))}}}}},{}]},{},[120])(120)}));